!function(e){function t(t){for(var r,o,i=t[0],c=t[1],l=t[2],d=0,p=[];d<i.length;d++)o=i[d],a[o]&&p.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(u&&u(t);p.length;)p.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,i=1;i<n.length;i++){var c=n[i];0!==a[c]&&(r=!1)}r&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={5:0},s=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;s.push([559,0]),n()}([,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(74),s=n(12),o=n(83),i=n(157),c=n(70),l=n(0),u=n(34),d=n(69),p=n(81),m=n(68),h=n(67),f=n(68);t.getUserInfo=f.getUserInfo;var g=n(68);t.getUserInfoByName=g.getUserInfo;var v=n(67);t.getUsersInfo=v.getUsersInfo;var y=n(67);function E(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s,o;return r.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,7,,8]),[4,p.formAuthorizeHeader()];case 1:return t=i.sent(),[4,p.cc98Fetch("/Topic/"+e+"/post?from=0&size=1",{headers:t})];case 2:return[4,i.sent().json()];case 3:return n=i.sent(),a=null,1==n[0].isAnonymous?[3,5]:[4,m.getUserInfo(n[0].userId)];case 4:return o=i.sent(),a=r.__assign({},n[0],{userInfo:o,postId:n[0].id}),[3,6];case 5:s="匿名"+n[0].userName.toUpperCase(),o={name:s,portraitUrl:"/static/images/心灵头像.gif",id:null,privilege:"匿名用户",popularity:0,signatureCode:"",postCount:0},a=r.__assign({},n[0],{userInfo:o,postId:n[0].id}),i.label=6;case 6:return[2,a];case 7:return i.sent(),[3,8];case 8:return[2]}})})}function b(e,t){for(var n in t)if(t[n]&&t[n].id===e)return t[n];return{id:e,name:"ID不存在",portraitUrl:"/static/images/default_avatar_boy.png",birthday:"1993-03-25T00:00:00",fanCount:0,followCount:0,gender:0,lastLogOnTime:"2007-12-26T02:26:00",popularity:0,prestige:0,signatureCode:"此ID已不存在，qmd无法显示"}}t.getUsersInfobyNames=y.getUsersInfo,r.__exportStar(n(69),t),r.__exportStar(n(81),t),t.getBoardTopicAsync=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,s,o,i,c,l,u,d,m;return r.__generator(this,function(h){switch(h.label){case 0:return h.trys.push([0,4,,5]),a=20*(e-1),[4,p.formAuthorizeHeader()];case 1:return s=h.sent(),o=void 0,i=[],c="/Board/"+t+"/topic?from="+a+"&size="+(o=20*e<=n?20:1===e&&n<19?n:n-20*(e-1)),[4,p.cc98Fetch(c,{headers:s})];case 2:switch((l=h.sent()).status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"]}return[4,l.json()];case 3:for(u=h.sent(),d=0;d<u.length;d++)i[d]=r.__assign({},u[d],{replyCount:u[d].replyCount||0});return[2,i];case 4:return m=h.sent(),console.error(m),[3,5];case 5:return[2]}})})},t.getTopic=E,t.getThisUserInfo=b,t.getThisUserInfobyName=function(e,t){for(var n in t)if(t[n].name===e)return t[n];return{id:null,name:"ID不存在",portraitUrl:"/static/images/default_avatar_boy.png",birthday:"1993-03-25T00:00:00",fanCount:0,followCount:0,gender:0,lastLogOnTime:"2007-12-26T02:26:00",popularity:0,prestige:0,signatureCode:"此ID已不存在，qmd无法显示"}},t.getTopicContent=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,s,o,i,c,l,u,d,m,f,g,v;return r.__generator(this,function(y){switch(y.label){case 0:return y.trys.push([0,6,,7]),n=10*(t-1),[4,p.formAuthorizeHeader()];case 1:return a=y.sent(),[4,p.cc98Fetch("/Topic/"+e+"/post?from="+n+"&size=10",{headers:a})];case 2:return[4,y.sent().json()];case 3:if(s=y.sent(),o=[],i=s.length,c=[],l=[],0===s.length)return[2,[]];if(0!=s[0].isAnonymous)return[3,5];for(u in s)c[u]=s[u].userId;return[4,h.getUsersInfo(c)];case 4:l=y.sent(),y.label=5;case 5:for(u=0;u<i;u++)1!=s[u].isAnonymous&&1!=s[u].isDeleted?(d=b(s[u].userId,l),o[u]=r.__assign({},s[u],{userInfo:d,postId:s[u].id})):s[u].isAnonymous&&!s[u].isDeleted?(m="/static/images/心灵头像.gif",f="匿名"+s[u].userName.toUpperCase(),g={name:f,portraitUrl:m,id:null,privilege:"匿名用户",popularity:0,signatureCode:null,postCount:0},o[u]=r.__assign({},s[u],{userInfo:g,postId:s[u].id,isAnonymous:!0})):(g={name:"98Deleter",portraitUrl:"/static/images/deleter2.png",id:null,privilege:"匿名用户",popularity:0,signatureCode:null,postCount:0},o[u]=r.__assign({},s[u],{userInfo:g,postId:s[u].id,isAnonymous:!1,isDeleted:!0,content:"该贴已被my cc98, my home"}));return[2,o];case 6:return v=y.sent(),console.error(v),[3,7];case 7:return[2]}})})},t.like=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var e,n,s;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,p.formAuthorizeHeader()];case 1:return(e=r.sent()).append("Content-Type","application/json"),n="1",[4,p.cc98Fetch("/post/"+t+"/like",{method:"PUT",headers:e,body:n})];case 2:return 401===(s=r.sent()).status&&a.default.dispatch(o.throwError("UnauthorizedTopic")),403===s.status&&a.default.dispatch(o.throwError("OperationForbidden")),404===s.status&&a.default.dispatch(o.throwError("NotFoundTopic")),500===s.status&&a.default.dispatch(o.throwError("ServerError")),[4,s.json()];case 3:return[2,r.sent()];case 4:return r.sent(),[3,5];case 5:return[2]}})})},t.dislike=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var e,n,s;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,p.formAuthorizeHeader()];case 1:return(e=r.sent()).append("Content-Type","application/json"),n="2",[4,p.cc98Fetch("/post/"+t+"/like",{method:"PUT",headers:e,body:n})];case 2:return 401===(s=r.sent()).status&&a.default.dispatch(o.throwError("UnauthorizedTopic")),403===s.status&&a.default.dispatch(o.throwError("OperationForbidden")),404===s.status&&a.default.dispatch(o.throwError("NotFoundTopic")),500===s.status&&a.default.dispatch(o.throwError("ServerError")),[4,s.json()];case 3:return[2,r.sent()];case 4:return r.sent(),[3,5];case 5:return[2]}})})},t.getLikeStateAndCount=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var e,n;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,p.formAuthorizeHeader()];case 1:return e=r.sent(),[4,p.cc98Fetch("/post/"+t+"/like",{headers:e})];case 2:return 401===(n=r.sent()).status&&a.default.dispatch(o.throwError("UnauthorizedTopic")),403===n.status&&a.default.dispatch(o.throwError("OperationForbidden")),404===n.status&&a.default.dispatch(o.throwError("NotFoundTopic")),500===n.status&&a.default.dispatch(o.throwError("ServerError")),[4,n.json()];case 3:return[2,r.sent()];case 4:return r.sent(),[3,5];case 5:return[2]}})})},t.getHotReplyContent=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s,o,i,c,l;return r.__generator(this,function(u){switch(u.label){case 0:return u.trys.push([0,10,,11]),[4,p.formAuthorizeHeader()];case 1:return t=u.sent(),[4,p.cc98Fetch("/Topic/"+e+"/hot-post",{headers:t})];case 2:return[4,u.sent().json()];case 3:n=u.sent(),a=[],s=n.length,o=0,u.label=4;case 4:return o<s?1==n[o].isAnonymous?[3,7]:[4,p.cc98Fetch("/user/name/"+encodeURIComponent(n[o].userName))]:[3,9];case 5:return[4,u.sent().json()];case 6:return l=u.sent(),a[o]=r.__assign({},n[o],{userInfo:l,postId:n[o].id}),[3,8];case 7:i="/static/images/心灵头像.gif",c="匿名"+n[o].userName.toUpperCase(),n[o].lastUpdateAuthor&&n[o].lastUpdateAuthor.toUpperCase(),l={name:c,portraitUrl:i,id:null,privilege:"匿名用户",popularity:0,signatureCode:null,postCount:0},a[o]=r.__assign({},n[o],{userInfo:l,postId:n[o].id}),u.label=8;case 8:return o++,[3,4];case 9:return[2,a];case 10:return u.sent(),[3,11];case 11:return[2]}})})},t.convertHotTopic=function(e){return l.createElement(i.TopicTitleAndContent,{key:e.id,title:e.title,userName:e.userName,id:e.id,userId:e.userId,lastPostTime:e.lastPostTime,lastPostUser:e.lastPostUser,likeCount:e.likeCount,dislikeCount:e.dislikeCount,replyCount:e.replyCount,highlightInfo:e.highlightInfo,topState:e.topState,state:e.state,hitCount:e.hitCount,bestState:e.bestState})},t.getCurUserTopic=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,s;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,6,,7]),[4,p.formAuthorizeHeader()];case 1:return n=r.sent(),[4,p.cc98Fetch("/post/topic/user?topicid="+e+"&userid="+t+"&from=0&size=1",{headers:n})];case 2:return[4,r.sent().json()];case 3:return a=r.sent(),[4,p.cc98Fetch("/user/name/"+encodeURIComponent(a[0].userName))];case 4:return[4,r.sent().json()];case 5:return s=r.sent(),a[0].userInfo=s,[2,a[0]];case 6:return r.sent(),[3,7];case 7:return[2]}})})},t.getCurUserTopicContent=function(e,t,n,a){return r.__awaiter(this,void 0,void 0,function(){var n,s,o,i,c,l,u,d,h,f,g;return r.__generator(this,function(v){switch(v.label){case 0:return v.trys.push([0,6,,7]),[4,E(e)];case 1:return v.sent(),n=void 0,n=10*(t-1),[4,p.getToken()];case 2:return s=v.sent(),(o=new Headers).append("Authorization",s),[4,p.cc98Fetch("/Post/topic/user?topicid="+e+"&userId="+a+"&from="+n+"&size=10",{headers:o})];case 3:return[4,v.sent().json()];case 4:return i=v.sent(),c=[],l=i.length,i[0].count,[4,m.getUserInfo(i[0].userId)];case 5:for(u=v.sent(),d=0;d<l;d++)1!=i[d].isAnonymous?c[d]=r.__assign({},i[d],{userInfo:u,postId:i[d].id}):(h="/static/images/_心灵之约.png",f="匿名"+i[d].userName.toUpperCase(),g={name:f,portraitUrl:h,id:null,privilege:"匿名用户",popularity:0,signatureCode:null,postCount:0},c[d]=r.__assign({},i[d],{userInfo:g}));return[2,c];case 6:return v.sent(),[3,7];case 7:return[2]}})})},t.getAllNewTopic=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var t,n,s,i,c,l,u,d,m,h,f,g,v,y,E,_,I,N,S;return r.__generator(this,function(r){switch(r.label){case 0:if(!C())return a.default.dispatch(o.throwError("LogOut")),[2,null];r.label=1;case 1:return r.trys.push([1,14,,15]),t=20,e>80&&(t=100-e),[4,p.formAuthorizeHeader()];case 2:return n=r.sent(),[4,p.cc98Fetch("/topic/new?from="+e+"&size="+t,{headers:n})];case 3:switch((s=r.sent()).status){case 401:a.default.dispatch(o.throwError("UnauthorizedTopic"));case 403:a.default.dispatch(o.throwError("OperationForbidden"))}return[4,s.json()];case 4:i=r.sent(),c=[],l=[],u=[],d=0,m=i,r.label=5;case 5:return d<m.length?((h=m[d]).time=T(h.time),h.lastPostTime=T(h.lastPostTime),h.hitCount>1e4&&(h.hitCount>1e5?(f=parseInt(""+h.hitCount/1e4),h.hitCount=f+"万"):(f=parseInt(""+h.hitCount/1e3)/10,h.hitCount=f+"万")),h.floorCount=h.replyCount+1,h.replyCount>1e4&&(h.replyCount>1e5?(f=parseInt(""+h.replyCount/1e4),h.replyCount=f+"万"):(f=parseInt(""+h.replyCount/1e3)/10,h.replyCount=f+"万")),h.tag1?(g=h,[4,j(h.tag1)]):[3,8]):[3,12];case 6:return g.tag1=r.sent(),h.tag2?(v=h,[4,j(h.tag2)]):[3,8];case 7:v.tag2=r.sent(),r.label=8;case 8:return h.userId?(y=h,[4,w(h.boardId)]):[3,10];case 9:return y.boardName=r.sent(),c.push(h),l.push(h.userId),[3,11];case 10:h.portraitUrl="/static/images/_心灵之约.png",h.userName="匿名用户",h.boardName="心灵之约",u.push(h),r.label=11;case 11:return d++,[3,5];case 12:return[4,F(l)];case 13:for(I in E=r.sent(),c)_=b(c[I].userId,E),c[I].portraitUrl=_.portraitUrl;for(I=0,N=0,S=0;I<i.length;I++)N===c.length?(i[I]=u[S],S++):i[I].id===c[N].id?(i[I]=c[N],N++):(i[I]=u[S],S++);return[2,i];case 14:return r.sent(),[3,15];case 15:return[2]}})})},t.getFocusTopic=function(e,t,n,s){return r.__awaiter(this,void 0,void 0,function(){var t,s,i,c,l,u,d,m,h,f,g,v,y,E,_,I,N,S,x,k;return r.__generator(this,function(r){switch(r.label){case 0:if(!C())return a.default.dispatch(o.throwError("LogOut")),[2,null];r.label=1;case 1:return r.trys.push([1,19,,20]),t=20,n>80&&(t=100-n),[4,p.formAuthorizeHeader()];case 2:return s=r.sent(),i=void 0,-1!==e?[3,4]:[4,p.cc98Fetch("/me/followee/topic?from="+n+"&size="+t,{headers:s})];case 3:return i=r.sent(),[3,8];case 4:return 0!==e?[3,6]:[4,p.cc98Fetch("/me/custom-board/topic?from="+n+"&size="+t,{headers:s})];case 5:return i=r.sent(),[3,8];case 6:return[4,p.cc98Fetch("/board/"+e+"/topic?from="+n+"&size="+t,{headers:s})];case 7:i=r.sent(),r.label=8;case 8:switch(i.status){case 401:a.default.dispatch(o.throwError("UnauthorizedTopic"));case 403:a.default.dispatch(o.throwError("OperationForbidden"))}return[4,i.json()];case 9:c=r.sent(),l=[],u=[],d=[],m=0,h=c,r.label=10;case 10:return m<h.length?((f=h[m]).time=T(f.time),f.lastPostTime=T(f.lastPostTime),f.hitCount>1e4&&(f.hitCount>1e5?(g=parseInt(""+f.hitCount/1e4),f.hitCount=g+"万"):(g=parseInt(""+f.hitCount/1e3)/10,f.hitCount=g+"万")),f.floorCount=f.replyCount+1,f.replyCount>1e4&&(f.replyCount>1e5?(g=parseInt(""+f.replyCount/1e4),f.replyCount=g+"万"):(g=parseInt(""+f.replyCount/1e3)/10,f.replyCount=g+"万")),f.tag1?(v=f,[4,j(f.tag1)]):[3,13]):[3,17];case 11:return v.tag1=r.sent(),f.tag2?(y=f,[4,j(f.tag2)]):[3,13];case 12:y.tag2=r.sent(),r.label=13;case 13:return f.userId?(E=f,[4,w(f.boardId)]):[3,15];case 14:return E.boardName=r.sent(),l.push(f),u.push(f.userId),[3,16];case 15:f.portraitUrl="/static/images/_心灵之约.png",f.userName="匿名用户",f.boardName="心灵之约",d.push(f),r.label=16;case 16:return m++,[3,10];case 17:return[4,F(u)];case 18:for(I in _=r.sent(),l)N=b(l[I].userId,_),l[I].portraitUrl=N.portraitUrl;for(S=0,x=0,k=0;S<c.length;S++)x===l.length?(c[S]=d[k],k++):c[S].id===l[x].id?(c[S]=l[x],x++):(c[S]=d[k],k++);return[2,c];case 19:return r.sent(),[3,20];case 20:return[2]}})})};var _=n(289);function w(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s,o,i,c;return r.__generator(this,function(r){switch(r.label){case 0:for(t=0,n=_.boardInfo;t<n.length;t++)if(a=n[t],e===a.id)return[2,a.name];return[4,p.getToken()];case 1:s=r.sent(),(o=new Headers).append("Authorization",s),i="/board/"+e,r.label=2;case 2:return r.trys.push([2,5,,6]),[4,p.cc98Fetch(i,{headers:o})];case 3:return[4,r.sent().json()];case 4:return c=r.sent(),[2,c.name];case 5:return r.sent(),[2,"未知版面"];case 6:return[2]}})})}function C(){return!!d.getLocalStorage("refresh_token")}function I(e,t,n,s){return r.__awaiter(this,void 0,void 0,function(){var s,i,c;return r.__generator(this,function(r){switch(r.label){case 0:if(!C())return a.default.dispatch(o.throwError("LogOut")),[2,null];r.label=1;case 1:return r.trys.push([1,5,,6]),[4,p.formAuthorizeHeader()];case 2:return s=r.sent(),[4,p.cc98Fetch("/message/user/"+e+"?from="+t+"&size="+n,{headers:s})];case 3:return 401===(i=r.sent()).status&&a.default.dispatch(o.throwError("UnauthorizedTopic")),403===i.status&&a.default.dispatch(o.throwError("OperationForbidden")),404===i.status&&a.default.dispatch(o.throwError("NotFoundTopic")),i.status,[4,i.json()];case 4:return c=r.sent(),[2,N(c)];case 5:return r.sent(),[3,6];case 6:return[2]}})})}function N(e){if(e!=[]&&e){for(var t=0;t<e.length;t++)t+1==e.length?e[t].showTime=!0:S(e[t].time)-S(e[t+1].time)<6e4?e[t].showTime=!1:e[t].showTime=!0;return e}return e}function S(e){var t=moment(e).format("YYYY-MM-DD HH:mm:ss");return new Date(t.replace(/-/g,"/")).getTime()}function T(e){var t=moment(e).format("YYYY/MM/DD HH:mm:ss"),n=new Date(t),r=n.getTime(),a=(new Date,(new Date).getTime()),s=(new Date((new Date).setHours(0,0,0,0)).getTime()+864e5-r)/1e3,o=n.getMonth()+1;o<10&&(o="0"+o);var i=n.getDate();i<10&&(i="0"+i);var c=n.getHours();c<10&&(c="0"+c);var l=n.getMinutes();l<10&&(l="0"+l);var u=n.getSeconds();return u<10&&(u="0"+u),s>259200?n.getFullYear()+"-"+o+"-"+i+" "+c+":"+l+":"+u:s>172800?"前天 "+(c+":"+l+":"+u):s>86400?"昨天 "+(c+":"+l+":"+u):a-r>36e5?"今天 "+(c+":"+l+":"+u):a-r>0?(l=parseInt((a-r)/6e4))+"分钟前":n.getFullYear()+"-"+o+"-"+i+" "+c+":"+l+":"+u}function x(){var e=0,t=0;return document.body&&(e=document.body.scrollTop),document.documentElement&&(t=document.documentElement.scrollTop),e-t>0?e:t}function k(){var e=0,t=0;return document.body&&(e=document.body.scrollHeight),document.documentElement&&(t=document.documentElement.scrollHeight),e-t>0?e:t}function P(){return"CSS1Compat"==document.compatMode?document.documentElement.clientHeight:document.body.clientHeight}function U(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s,o;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),t="/file",[4,p.formAuthorizeHeader()];case 1:return n=r.sent(),(a=new FormData).append("files",e,e.name),a.append("contentType","multipart/form-data"),[4,p.cc98Fetch(t,{method:"POST",headers:n,body:a})];case 2:return[4,(s=r.sent()).json()];case 3:if(o=r.sent(),200===s.status&&0!==o.length)return[2,{isSuccess:!0,content:o[0]}];throw{};case 4:return[2,{isSuccess:!1,content:r.sent().message}];case 5:return[2]}})})}function M(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return d.getLocalStorage("refresh_token")?[4,p.formAuthorizeHeader()]:[3,4];case 1:return e=n.sent(),[4,p.cc98Fetch("/me",{headers:e})];case 2:return[4,n.sent().json()];case 3:t=n.sent(),a.default.dispatch(s.changeUserInfo(t)),d.setLocalStorage("userInfo",t,2592e3),n.label=4;case 4:return[2]}})})}function R(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,s;return r.__generator(this,function(r){switch(r.label){case 0:return e={totalCount:0,replyCount:0,atCount:0,systemCount:0,messageCount:0},C()?(t=d.getLocalStorage("noticeSetting"))&&"否"===t.response&&"否"===t.system&&"否"===t.message&&"否"===t.attme?(d.setStorage("unreadCount",e),[2,e]):[4,p.formAuthorizeHeader()]:(d.setStorage("unreadCount",e),[2,e]);case 1:return n=r.sent(),a="/me/unread-count",[4,p.cc98Fetch(a,{headers:n})];case 2:return 200!==(s=r.sent()).status?[3,4]:[4,s.json()];case 3:e=r.sent(),r.label=4;case 4:return t&&("否"===t.response&&(e.replyCount=0),"否"===t.system&&(e.systemCount=0),"否"===t.message&&(e.messageCount=0),"否"===t.attme&&(e.atCount=0)),e.totalCount=e.systemCount+e.atCount+e.replyCount+e.messageCount,e.totalCount>0?(u("#unreadCount-totalCount").removeClass("displaynone"),u("#unreadCount-totalCount").text(e.totalCount),e.replyCount>0?(u("#unreadCount-replyCount").removeClass("displaynone"),u("#unreadCount-replyCount").text(e.replyCount),u("#unreadCount-replyCount1").removeClass("displaynone"),u("#unreadCount-replyCount1").text(e.replyCount)):(u("#unreadCount-replyCount").addClass("displaynone"),u("#unreadCount-replyCount1").addClass("displaynone")),e.atCount>0?(u("#unreadCount-atCount").removeClass("displaynone"),u("#unreadCount-atCount").text(e.atCount),u("#unreadCount-atCount1").removeClass("displaynone"),u("#unreadCount-atCount1").text(e.atCount)):(u("#unreadCount-atCount").addClass("displaynone"),u("#unreadCount-atCount1").addClass("displaynone")),e.systemCount>0?(u("#unreadCount-systemCount").removeClass("displaynone"),u("#unreadCount-systemCount").text(e.systemCount),u("#unreadCount-systemCount1").removeClass("displaynone"),u("#unreadCount-systemCount1").text(e.systemCount)):(u("#unreadCount-systemCount").addClass("displaynone"),u("#unreadCount-systemCount1").addClass("displaynone")),e.messageCount>0?(u("#unreadCount-messageCount").removeClass("displaynone"),u("#unreadCount-messageCount").text(e.messageCount),u("#unreadCount-messageCount1").removeClass("displaynone"),u("#unreadCount-messageCount1").text(e.messageCount)):(u("#unreadCount-messageCount").addClass("displaynone"),u("#unreadCount-messageCount1").addClass("displaynone")),d.setStorage("unreadCount",e),[2,e]):(u("#unreadCount-totalCount").addClass("displaynone"),u("#unreadCount-replyCount").addClass("displaynone"),u("#unreadCount-replyCount1").addClass("displaynone"),u("#unreadCount-atCount").addClass("displaynone"),u("#unreadCount-atCount1").addClass("displaynone"),u("#unreadCount-systemCount").addClass("displaynone"),u("#unreadCount-systemCount1").addClass("displaynone"),u("#unreadCount-messageCount").addClass("displaynone"),u("#unreadCount-messageCount1").addClass("displaynone"),d.setStorage("unreadCount",e),[2,e])}})})}function L(){return c.Constants.config.apiUrl}function O(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n;return r.__generator(this,function(r){switch(r.label){case 0:return d.getLocalStorage("tagInfo")?[2,d.getLocalStorage("tagInfo")]:[3,1];case 1:return e="/config/global/alltag",[4,p.formAuthorizeHeader()];case 2:return t=r.sent(),[4,p.cc98Fetch(e,{headers:t})];case 3:return[4,r.sent().json()];case 4:return n=r.sent(),d.setLocalStorage("tagInfo",n),[2,n]}})})}function j(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s;return r.__generator(this,function(r){switch(r.label){case 0:return[4,O()];case 1:for(t=r.sent(),n=0,a=t;n<a.length;n++)if((s=a[n]).id===e)return[2,s.name];return[2,!1]}})})}function F(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s,o,i,c,l;return r.__generator(this,function(r){switch(r.label){case 0:for(t=[],n=[],l=0;l<e.length;l++)(a=d.getLocalStorage("userId_"+e[l]))?n.push(a):t.push(e[l]);return 0!==t.length?[3,1]:[2,n];case 1:for(s="/user/basic",l=0;l<t.length;l++)s=0===l?s+"?id="+t[l]:s+"&id="+t[l];r.label=2;case 2:return r.trys.push([2,5,,6]),[4,p.cc98Fetch(s)];case 3:return[4,r.sent().json()];case 4:for(o=r.sent(),i=0,c=o;i<c.length;i++)l=c[i],n.push(l);return[2,n];case 5:return r.sent(),[2,[]];case 6:return[2]}})})}function A(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return e&&0!==e.length?[4,p.formAuthorizeHeader()]:[2,[]];case 1:for(t=r.sent(),n="/post/basic",a=0;a<e.length;a++)n=0===a?n+"?id="+e[a]:n+"&id="+e[a];r.label=2;case 2:return r.trys.push([2,5,,6]),[4,p.cc98Fetch(n,{headers:t})];case 3:return[4,r.sent().json()];case 4:return[2,r.sent()];case 5:return r.sent(),[2,[]];case 6:return[2]}})})}function H(e,t){for(var n in t)if(t[n].id===e)return t[n];return{id:e,floor:1,userId:-1,userName:"有人"}}function B(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return e&&0!==e.length?[4,p.formAuthorizeHeader()]:[2,[]];case 1:for(t=r.sent(),n="/topic/basic",a=0;a<e.length;a++)n=0===a?n+"?id="+e[a]:n+"&id="+e[a];r.label=2;case 2:return r.trys.push([2,5,,6]),[4,p.cc98Fetch(n,{headers:t})];case 3:return[4,r.sent().json()];case 4:return[2,r.sent()];case 5:return r.sent(),[2,[]];case 6:return[2]}})})}function D(e,t){for(var n in t)if(t[n].id===e)return t[n];return{id:e,title:"未知主题（该主题已被删除或者无权限获取）",boardId:0}}t.getBoardName=w,t.isLogOn=C,t.getRecentContact=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var n,s,i,c,l,u,d;return r.__generator(this,function(r){switch(r.label){case 0:if(!C())return a.default.dispatch(o.throwError("LogOut")),[2,null];r.label=1;case 1:return r.trys.push([1,6,,7]),[4,p.formAuthorizeHeader()];case 2:return n=r.sent(),[4,p.cc98Fetch("/message/recent-contact-users?from="+e+"&size="+t,{headers:n})];case 3:return 401===(s=r.sent()).status&&a.default.dispatch(o.throwError("UnauthorizedTopic")),403===s.status&&a.default.dispatch(o.throwError("OperationForbidden")),404===s.status&&a.default.dispatch(o.throwError("NotFoundTopic")),500===s.status&&a.default.dispatch(o.throwError("ServerError")),[4,s.json()];case 4:for(d in i=r.sent(),c=[],i)c[d]=i[d].userId;return[4,F(c)];case 5:for(d in l=r.sent(),u=[],i)u.push(b(i[d].userId,l));for(d in i)u[d].message=[],u[d].lastContent=i[d].lastContent,u[d].isRead=i[d].isRead;return[2,u];case 6:return r.sent(),[3,7];case 7:return[2]}})})},t.getRecentMessage=I,t.sortRecentMessage=N,t.transerTime=S,t.transerRecentTime=T,t.sortContactList=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var t,n,s,i,c,l,u,d,m,h,f,g,v,y,E;return r.__generator(this,function(r){switch(r.label){case 0:if(!(t=location.href.match(/id=(\d+)/)))return[3,18];if(n=parseInt(t[1]),e&&0!==e.length)return[3,8];i=void 0,y=void 0,v=1,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,p.cc98Fetch("/user/basic/"+n)];case 2:return 404===(i=r.sent()).status&&a.default.dispatch(o.throwError("NotFoundUser")),500===i.status&&a.default.dispatch(o.throwError("ServerError")),[4,i.json()];case 3:return y=r.sent(),[3,5];case 4:return r.sent(),a.default.dispatch(o.throwError("Disconnected")),v=0,[3,5];case 5:return 1!==v?[3,7]:(s=y,[4,I(y.id,0,10)]);case 6:s.message=r.sent(),y.message&&(y.lastContent=y.message[0]),y.isRead=!0,e=[y],r.label=7;case 7:return[3,17];case 8:for(m=0;m<e.length&&e[m].id!=n;m++);return 0!=m?[3,9]:(e[0].isRead=!0,[3,17]);case 9:return m<e.length?((h=e[m]).isRead=!0,e.splice(m,1),e.unshift(h),[3,17]):[3,10];case 10:i=void 0,y=void 0,v=1,r.label=11;case 11:return r.trys.push([11,14,,15]),[4,p.cc98Fetch("/user/basic/"+n)];case 12:return 401===(i=r.sent()).status&&a.default.dispatch(o.throwError("UnauthorizedTopic")),403===i.status&&a.default.dispatch(o.throwError("OperationForbidden")),404===i.status&&a.default.dispatch(o.throwError("NotFoundTopic")),500===i.status&&a.default.dispatch(o.throwError("ServerError")),[4,i.json()];case 13:return y=r.sent(),[3,15];case 14:return r.sent(),a.default.dispatch(o.throwError("Disconnected")),v=0,[3,15];case 15:return 1!==v?[3,17]:(c=y,[4,I(y.id,0,10)]);case 16:c.message=r.sent(),y.message&&(y.lastContent=y.message[0]),y.isRead=!0,e=[y].concat(e),r.label=17;case 17:return[3,35];case 18:if(!(l=location.href.match(/name=(\S+)/)))return[3,35];if(l[1],u=l[1],e&&0!==e.length)return[3,26];f=void 0,g=void 0,v=1,r.label=19;case 19:return r.trys.push([19,22,,23]),[4,p.cc98Fetch("/user/name/"+encodeURIComponent(u))];case 20:switch((f=r.sent()).status){case 401:a.default.dispatch(o.throwError("LogOut"));case 403:a.default.dispatch(o.throwError("OperationForbidden"));case 404:a.default.dispatch(o.throwError("NotFoundTopic"));case 500:a.default.dispatch(o.throwError("ServerError"))}return[4,f.json()];case 21:return g=r.sent(),[3,23];case 22:return r.sent(),a.default.dispatch(o.throwError("Disconnected")),v=0,[3,23];case 23:return 1!=v?[3,25]:(y={id:g.id,name:g.name,portraitUrl:g.portraitUrl,message:[],lastContent:"",isRead:!0},d=y,[4,I(y.id,0,10)]);case 24:d.message=r.sent(),y.message&&(y.lastContent=y.message[0]),e=[y],r.label=25;case 25:return[3,35];case 26:for(m=0;m<e.length&&e[m].name!=u;m++);return 0!=m?[3,27]:[3,35];case 27:return m<e.length?(h=e[m],e.splice(m,1),e.unshift(h),[3,35]):[3,28];case 28:f=void 0,g=void 0,v=1,r.label=29;case 29:return r.trys.push([29,32,,33]),[4,p.cc98Fetch("/user/name/"+encodeURIComponent(u))];case 30:switch((f=r.sent()).status){case 401:a.default.dispatch(o.throwError("UnauthorizedTopic"));case 403:a.default.dispatch(o.throwError("OperationForbidden"));case 404:a.default.dispatch(o.throwError("NotFoundTopic"));case 500:a.default.dispatch(o.throwError("ServerError"))}return[4,f.json()];case 31:return g=r.sent(),[3,33];case 32:return r.sent(),a.default.dispatch(o.throwError("Disconnected")),v=0,[3,33];case 33:return 1!=v?[3,35]:(y={id:g.id,name:g.name,portraitUrl:g.portraitUrl,message:[],lastContent:"",isRead:!0},E=y,[4,I(y.id,0,10)]);case 34:E.message=r.sent(),y.message&&(y.lastContent=y.message[0]),e=[y].concat(e),r.label=35;case 35:return[2,e]}})})},t.getUserDetails=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,m.getUserInfo(e)];case 1:return[2,{portraitUrl:(t=n.sent()).portraitUrl,userName:t.name,fanCount:t.fanCount,displayTitle:t.displayTitle,birthday:t.birthday,prestige:t.prestige,gender:t.gender,levelTitle:t.levelTitle,isFollowing:t.isFollowing}];case 2:return n.sent(),[3,3];case 3:return[2]}})})},t.getLikeState=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var t,n,s,i;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),[4,E(e)];case 2:return n=r.sent(),s=n.postId,[4,p.cc98Fetch("/post/"+s+"/like",{headers:t})];case 3:switch((i=r.sent()).status){case 401:a.default.dispatch(o.throwError("UnauthorizedTopic"));case 403:a.default.dispatch(o.throwError("OperationForbidden"));case 404:a.default.dispatch(o.throwError("NotFoundTopic"));case 500:a.default.dispatch(o.throwError("ServerError"))}return[4,i.json()];case 4:return[2,r.sent()];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.refreshLikeState=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var e,n;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,p.formAuthorizeHeader()];case 1:return e=r.sent(),[4,p.cc98Fetch("/post/"+t+"/like",{headers:e})];case 2:switch((n=r.sent()).status){case 401:a.default.dispatch(o.throwError("UnauthorizedTopic"));case 403:a.default.dispatch(o.throwError("OperationForbidden"));case 404:a.default.dispatch(o.throwError("NotFoundTopic"));case 500:a.default.dispatch(o.throwError("ServerError"))}return[4,n.json()];case 3:return[2,r.sent()];case 4:return r.sent(),[3,5];case 5:return[2]}})})},t.sendTopic=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var t,n,s,i,l,u;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),t="/post/topic/"+e,n=c.Constants.testEditor.getMarkdown(),s={content:n,contentType:1,title:""},i=JSON.stringify(s),[4,p.getToken()];case 1:return l=r.sent(),(u=new Headers).append("Authorization",l),u.append("Content-Type","application/json"),[4,p.cc98Fetch(t,{method:"POST",headers:u,body:i})];case 2:switch(r.sent().status){case 401:a.default.dispatch(o.throwError("LogOut"));case 402:a.default.dispatch(o.throwError("ContentNeeded"));case 403:a.default.dispatch(o.throwError("OperationForbidden"));case 404:a.default.dispatch(o.throwError("NotFoundTopic"));case 500:a.default.dispatch(o.throwError("ServerError"))}return[3,4];case 3:return r.sent(),[3,4];case 4:return[2]}})})},t.getListTotalPage=function(e){return(e-e%20)/20+1},t.getCurUserTotalReplyPage=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,s;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,p.formAuthorizeHeader()];case 1:return n=r.sent(),[4,p.cc98Fetch("/post/topic/user?topicid="+e+"&userid="+t+"&from=0&size=1",{headers:n})];case 2:return[4,r.sent().json()];case 3:return a=r.sent(),[2,(s=a[0].count)%10==0?s/10:(s-s%10)/10+1];case 4:return r.sent(),[3,5];case 5:return[2]}})})},t.getAnonymousTraceTopicsCount=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,p.formAuthorizeHeader()];case 1:return n=r.sent(),[4,p.cc98Fetch("/post/topic/anonymous/user?topicid="+e+"&postid="+t+"&from=0&size=1",{headers:n})];case 2:return[4,r.sent().json()];case 3:return[2,(a=r.sent())[0].count%10==0?a[0].count/10:(a[0].count-a[0].count%10)/10+1];case 4:return r.sent(),[3,5];case 5:return[2]}})})},t.getAnonymousTraceTopics=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,s,o,i,c,l,u;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),a=10*(n-1),[4,p.formAuthorizeHeader()];case 1:return s=r.sent(),[4,p.cc98Fetch("/post/topic/anonymous/user?topicid="+e+"&postid="+t+"&from="+a+"&size=10",{headers:s})];case 2:return[4,r.sent().json()];case 3:for(u in o=r.sent(),i="/static/images/心灵头像.gif",c="匿名"+o[0].userName.toUpperCase(),l={name:c,portraitUrl:i,id:null,privilege:"匿名用户",popularity:0,signatureCode:null,postCount:0,fanCount:0},o)o[u].userInfo=l;return[2,o];case 4:return r.sent(),[3,5];case 5:return[2]}})})},t.sendMessage=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(t=r.sent()).append("content-type","application/json"),[4,p.cc98Fetch("/message",{method:"POST",headers:t,body:e})];case 2:return 401===(n=r.sent()).status&&a.default.dispatch(o.throwError("LogOut")),500===n.status&&a.default.dispatch(o.throwError("ServerError")),[2,n]}})})},t.getScrollTop=x,t.getScrollHeight=k,t.getWindowHeight=P,t.isBottom=function(){return x()+P()+300>k()},t.uploadFile=U,t.clickUploadIcon=function(){u("#upload-files").click()},t.uploadEvent=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return[4,U(e.target.files[0])];case 1:return t=r.sent(),n=t.content,L(),a="![]("+n+")",c.Constants.testEditor.appendMarkdown(a),[2]}})})},t.followUser=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,6,,7]),[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),n="/me/followee/"+e,[4,p.cc98Fetch(n,{method:"PUT",headers:t})];case 2:return 200!==(a=r.sent()).status?[3,3]:[2,!0];case 3:return s=Error.bind,[4,a.text()];case 4:throw new(s.apply(Error,[void 0,r.sent()]));case 5:return[3,7];case 6:return[2,r.sent().message];case 7:return[2]}})})},t.unfollowUser=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),n="/me/followee/"+e,[4,p.cc98Fetch(n,{method:"DELETE",headers:t})];case 2:if(200===(a=r.sent()).status)return[2,!0];throw new Error(a.statusText);case 3:return r.sent(),[2,!1];case 4:return[2]}})})},t.GetTopTopics=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s,o,i,c;return r.__generator(this,function(l){switch(l.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return t=l.sent(),n="/topic/toptopics?boardid="+e,[4,p.cc98Fetch(n,{headers:t})];case 2:return[4,l.sent().json()];case 3:for(a=l.sent(),s=[],o=0;o<a.length;o++)s[o]=r.__assign({},a[o],{replyCount:a[o].replyCount||0});for(o=0;o<s.length-1;o++)for(i=0;i<s.length-1-o;i++)s[i].topState<=s[i+1].topState&&(c=s[i],s[i]=s[i+1],s[i+1]=c);return[2,s]}})})},t.getBestTopics=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,s,o,i,c;return r.__generator(this,function(l){switch(l.label){case 0:return n="/topic/best/board/"+t+"?from="+20*(e-1)+"&size=20",[4,p.formAuthorizeHeader()];case 1:return a=l.sent(),[4,p.cc98Fetch(n,{headers:a})];case 2:return[4,l.sent().json()];case 3:for(s=l.sent(),o=[],i=0;i<s.topics.length;i++)o[i]=r.__assign({},s.topics[i],{replyCount:s.topics[i].replyCount||0});return c=s.count%20==0?s.count/20:(s.count-s.count%20)/20+1,[2,{boardtopics:o,totalPage:c}]}})})},t.getSaveTopics=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,s,o,i,c,l;return r.__generator(this,function(u){switch(u.label){case 0:return n="/topic/save/board/"+t+"?from="+20*(e-1)+"&size=20",[4,p.getToken()];case 1:return a=u.sent(),(s=new Headers).append("Authorization",a),[4,p.cc98Fetch(n,{headers:s})];case 2:return[4,u.sent().json()];case 3:for(o=u.sent(),i=[],c=0;c<o.topics.length;c++)i[c]=r.__assign({},o.topics[c],{replyCount:o.topics[c].replyCount||0});return l=o.count%20==0?o.count/20:(o.count-o.count%20)/20+1,[2,{boardtopics:i,totalPage:l}]}})})},t.getSearchTopic=function(e,t,n,s){return r.__awaiter(this,void 0,void 0,function(){var s,i,c,l,u,d,m,h,f,g,v,y,E,_,I,N,S,x,k,P,U,M;return r.__generator(this,function(r){switch(r.label){case 0:return C()?t?[4,p.formAuthorizeHeader()]:[3,22]:(a.default.dispatch(o.throwError("LogOut")),[2,null]);case 1:for(c in s=r.sent(),i=t[0],t)"0"!=c&&(i=i+" "+t[c]);if(l=20,u=void 0,0!==e)return[3,7];r.label=2;case 2:return r.trys.push([2,5,,6]),[4,p.cc98Fetch("/topic/search?keyword="+encodeURIComponent(i)+"&size="+l+"&from="+n,{headers:s})];case 3:switch((d=r.sent()).status){case 401:a.default.dispatch(o.throwError("UnauthorizedTopic"));case 403:a.default.dispatch(o.throwError("OperationForbidden"))}return[4,d.json()];case 4:return u=r.sent(),[3,6];case 5:return r.sent(),[2,-1];case 6:return[3,11];case 7:return r.trys.push([7,10,,11]),[4,p.cc98Fetch("/topic/search/board/"+e+"?keyword="+encodeURIComponent(i)+"&size="+l+"&from="+n,{headers:s})];case 8:return 401===(d=r.sent()).status&&a.default.dispatch(o.throwError("LogOut")),403===d.status&&a.default.dispatch(o.throwError("OperationForbidden")),404===d.status&&a.default.dispatch(o.throwError("NotFoundTopic")),500===d.status&&a.default.dispatch(o.throwError("ServerError")),[4,d.json()];case 9:return u=r.sent(),[3,11];case 10:return r.sent(),[2,-1];case 11:if(!u||0==u.length)return[3,21];m=[],h=[],f=[],g=0,v=u,r.label=12;case 12:return g<v.length?((y=v[g]).time=T(y.time),y.lastPostTime=T(y.lastPostTime),y.hitCount>1e4&&(y.hitCount>1e5?(E=parseInt(""+y.hitCount/1e4),y.hitCount=E+"万"):(E=parseInt(""+y.hitCount/1e3)/10,y.hitCount=E+"万")),y.floorCount=y.replyCount+1,y.replyCount>1e4&&(y.replyCount>1e5?(E=parseInt(""+y.replyCount/1e4),y.replyCount=E+"万"):(E=parseInt(""+y.replyCount/1e3)/10,y.replyCount=E+"万")),y.tag1?(_=y,[4,j(y.tag1)]):[3,15]):[3,19];case 13:return _.tag1=r.sent(),y.tag2?(I=y,[4,j(y.tag2)]):[3,15];case 14:I.tag2=r.sent(),r.label=15;case 15:return y.userId?(N=y,[4,w(y.boardId)]):[3,17];case 16:return N.boardName=r.sent(),m.push(y),h.push(y.userId),[3,18];case 17:y.portraitUrl="/static/images/_心灵之约.png",y.userName="匿名用户",y.boardName="心灵之约",f.push(y),r.label=18;case 18:return g++,[3,12];case 19:return[4,F(h)];case 20:for(x in S=r.sent(),m)k=b(m[x].userId,S),m[x].portraitUrl=k.portraitUrl;for(P=0,U=0,M=0;P<u.length;P++)U===m.length?(u[P]=f[M],M++):u[P].id===m[U].id?(u[P]=m[U],U++):(u[P]=f[M],M++);return[2,u];case 21:return[2,0];case 22:return[2]}})})},t.getSearchBoard=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return e?(t="/board/search?keyword="+e,[4,p.cc98Fetch(t)]):[3,3];case 1:return[4,n.sent().json()];case 2:return[2,n.sent()];case 3:return[2]}})})},t.awardWealth=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,s,o,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(a=r.sent()).append("Content-Type","application/json"),s={operationType:0,reason:e,wealth:t},o=JSON.stringify(s),i="/post/"+n+"/operation",t?[4,p.cc98Fetch(i,{method:"POST",headers:a,body:o})]:[3,8];case 2:switch((c=r.sent()).status){case 400:return[3,3];case 401:return[3,5];case 404:return[3,6];case 500:return[3,7]}return[3,8];case 3:return[4,c.text()];case 4:return"reward_wealth_limited"===r.sent()?[2,"limited"]:[2,"wrong input"];case 5:return[2,"unauthorized"];case 6:return[2,"not found"];case 7:return[2,"server error"];case 8:return[2,"ok"]}})})},t.deductWealth=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,s,o,i;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(a=r.sent()).append("Content-Type","application/json"),s={operationType:1,reason:e,wealth:t},o=JSON.stringify(s),i="/post/"+n+"/operation",0==t?[3,3]:[4,p.cc98Fetch(i,{method:"POST",headers:a,body:o})];case 2:switch(r.sent().status){case 400:return[2,"wrong input"];case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}r.label=3;case 3:return[2,"ok"]}})})},t.getAwardInfo=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),n="/post/"+e+"/awards",[4,p.cc98Fetch(n,{headers:t})];case 2:return[4,r.sent().json()];case 3:return[2,r.sent()]}})})},t.getPortraitUrl=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return t="/user/name/"+encodeURIComponent(e),[4,p.cc98Fetch(t)];case 1:return[4,n.sent().json()];case 2:return[2,n.sent().portraitUrl]}})})},t.getBoardId=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s;return r.__generator(this,function(r){switch(r.label){case 0:return(n=d.getStorage("boardInfo"))?[3,2]:[4,fetch("/static/boardinfo.json").then(function(e){return e.json()})];case 1:n=r.sent(),r.label=2;case 2:for(s in t=n,d.setStorage("boardInfo",t),a=[],t)t[s].name.indexOf(e)>-1&&a.push({id:t[s].id,name:t[s].name});return[2,a]}})})},t.isFollowThisBoard=function(e){if(!d.getLocalStorage("userInfo"))return!1;var t=d.getLocalStorage("userInfo").customBoards;if(t)for(var n=0,r=t;n<r.length;n++)if(r[n]==e)return!0;return!1},t.followBoard=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),n="/me/custom-board/"+e,[4,p.cc98Fetch(n,{method:"PUT",headers:t})];case 2:return r.sent(),[4,M()];case 3:return r.sent(),d.removeStorage("focusBoardList"),[2]}})})},t.refreshUserInfo=M,t.unfollowBoard=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),n="/me/custom-board/"+e,[4,p.cc98Fetch(n,{method:"DELETE",headers:t})];case 2:return r.sent(),[4,M()];case 3:return r.sent(),d.removeStorage("focusBoardList"),[2]}})})},t.getMessageSystem=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var n,s,i,c,l,u,d,m,h,f;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:n=r.sent(),r.label=2;case 2:return r.trys.push([2,5,,6]),[4,p.cc98Fetch("/notification/system?from="+e+"&size="+t,{headers:n})];case 3:switch((s=r.sent()).status){case 401:return C()?(a.default.dispatch(o.throwError("UnauthorizedTopic")),[2,null]):(a.default.dispatch(o.throwError("LogOut")),[2,null]);case 403:return a.default.dispatch(o.throwError("OperationForbidden")),[2,null];case 404:return a.default.dispatch(o.throwError("NotFoundTopic")),[2,null];case 500:return a.default.dispatch(o.throwError("ServerError")),[2,null]}return[4,s.json()];case 4:return i=r.sent(),[3,6];case 5:return r.sent(),[2,[]];case 6:for(c=[],l=0,u=i;l<u.length;l++)(d=u[l]).postId&&c.push(d.postId);return[4,A(c)];case 7:for(h in m=r.sent(),i)i[h].postId?(f=H(i[h].postId,m),i[h].floor=f.floor):i[h].floor=0;return[2,i]}})})},t.getMessageResponse=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var n,s,i,c,l,u,d,m,h,f,g,v,y,E,b,_,I,N;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,11,,12]),n=[],[4,p.formAuthorizeHeader()];case 1:return s=r.sent(),[4,p.cc98Fetch("/notification/reply?from="+e+"&size="+t,{headers:s})];case 2:switch((i=r.sent()).status){case 401:return C()?(a.default.dispatch(o.throwError("UnauthorizedTopic")),[2,[]]):(a.default.dispatch(o.throwError("LogOut")),[2,[]]);case 403:return a.default.dispatch(o.throwError("OperationForbidden")),[2,[]];case 404:return a.default.dispatch(o.throwError("NotFoundTopic")),[2,[]];case 500:return a.default.dispatch(o.throwError("ServerError")),[2,[]]}return[4,i.json()];case 3:for(c=r.sent(),l=[],u=[],d=0,m=c;d<m.length;d++)(h=m[d]).postId&&l.push(h.postId),h.topicId&&u.push(h.topicId);return[4,A(l)];case 4:return f=r.sent(),[4,B(u)];case 5:if(g=r.sent(),!c)return[3,10];for(y in v=[],c)v.push(y);E=0,r.label=6;case 6:return E<v.length?(b=v[E],c[b].topicId?(_=D(c[b].topicId,g),c[b].topicTitle=_.title,c[b].boardId=_.boardId,I=c[b],[4,w(c[b].boardId)]):[3,8]):[3,10];case 7:I.boardName=r.sent(),r.label=8;case 8:c[b].postId?(N=H(c[b].postId,f),c[b].floor=N.floor,c[b].userId=N.userId,c[b].userName=N.userName):(c[b].floor=1,c[b].userId=-1,c[b].userName="有人"),n.push(c[b]),r.label=9;case 9:return E++,[3,6];case 10:return[2,n];case 11:return r.sent(),[3,12];case 12:return[2]}})})},t.getMessageAttme=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var n,s,i,c,l,u,d,m,h,f,g,v,y,E,b,_,I,N,S;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,11,,12]),n=[],[4,p.getToken()];case 1:return s=r.sent(),(i=new Headers).append("Authorization",s),[4,p.cc98Fetch("/notification/at?from="+e+"&size="+t,{headers:i})];case 2:switch((c=r.sent()).status){case 401:return C()?(a.default.dispatch(o.throwError("UnauthorizedTopic")),[2,[]]):(a.default.dispatch(o.throwError("LogOut")),[2,[]]);case 403:return a.default.dispatch(o.throwError("OperationForbidden")),[2,[]];case 404:return a.default.dispatch(o.throwError("NotFoundTopic")),[2,[]];case 500:return a.default.dispatch(o.throwError("ServerError")),[2,[]]}return[4,c.json()];case 3:for(l=r.sent(),u=[],d=[],m=0,h=l;m<h.length;m++)(f=h[m]).postId&&u.push(f.postId),f.topicId&&d.push(f.topicId);return[4,A(u)];case 4:return g=r.sent(),[4,B(d)];case 5:if(v=r.sent(),!l)return[3,10];for(E in y=[],l)y.push(E);b=0,r.label=6;case 6:return b<y.length?(_=y[b],l[_].topicId?(I=D(l[_].topicId,v),l[_].topicTitle=I.title,l[_].boardId=I.boardId,N=l[_],[4,w(l[_].boardId)]):[3,8]):[3,10];case 7:N.boardName=r.sent(),r.label=8;case 8:l[_].postId?(S=H(l[_].postId,g),l[_].floor=S.floor,l[_].userId=S.userId,l[_].userName=S.userName):(l[_].floor=1,l[_].userId=-1,l[_].userName="有人"),n.push(l[_]),r.label=9;case 9:return b++,[3,6];case 10:return[2,n];case 11:return r.sent(),[3,12];case 12:return[2]}})})},t.plus1=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var e,a,s,o,i;return r.__generator(this,function(r){switch(r.label){case 0:return e="/post/"+t+"/rating",[4,p.formAuthorizeHeader()];case 1:return(a=r.sent()).append("Content-Type","application/json"),s={value:1,reason:n},o=JSON.stringify(s),[4,p.cc98Fetch(e,{method:"PUT",headers:a,body:o})];case 2:switch((i=r.sent()).status){case 400:return[3,3];case 401:return[3,4];case 403:return[3,5];case 500:return[3,7]}return[3,8];case 3:return[2,"rateself"];case 4:return[2,"not allowed"];case 5:return[4,i.text()];case 6:return"you_cannot_rate"===r.sent()?[2,"not allowed"]:[2,"already"];case 7:return[2,"server error"];case 8:return[2,"ok"]}})})},t.minus1=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var e,a,s,o;return r.__generator(this,function(r){switch(r.label){case 0:return e="/post/"+t+"/rating",[4,p.formAuthorizeHeader()];case 1:return(a=r.sent()).append("Content-Type","application/json"),s={value:-1,reason:n},o=JSON.stringify(s),[4,p.cc98Fetch(e,{method:"PUT",headers:a,body:o})];case 2:switch(r.sent().status){case 400:return[2,"rateself"];case 401:return[2,"not allowed"];case 403:return[2,"already"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.addPrestige=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,s,o,i;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(a=r.sent()).append("Content-Type","application/json"),s={operationType:0,prestige:t,reason:n},o="/post/"+e+"/operation",i=JSON.stringify(s),t?[4,p.cc98Fetch(o,{method:"POST",headers:a,body:i})]:[3,3];case 2:switch(r.sent().status){case 400:return[2,"wrong input"];case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}r.label=3;case 3:return[2,"ok"]}})})},t.deductPrestige=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,s,o,i;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(a=r.sent()).append("Content-Type","application/json"),s={operationType:1,prestige:t,reason:n},o="/post/"+e+"/operation",i=JSON.stringify(s),t?[4,p.cc98Fetch(o,{method:"POST",headers:a,body:i})]:[3,3];case 2:switch(r.sent().status){case 400:return[2,"wrong input"];case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}r.label=3;case 3:return[2,"ok"]}})})},t.deletePost=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var e,a,s;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(e=r.sent()).append("Content-Type","application/json"),a={reason:n},s="/post/"+t,[4,p.cc98Fetch(s,{method:"DELETE",headers:e,body:JSON.stringify(a)})];case 2:switch(r.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.stopBoardPost=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,s,o;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(a=r.sent()).append("Content-Type","application/json"),s={operationType:1,reason:t,stopPostDays:n},o="/post/"+e+"/operation",[4,p.cc98Fetch(o,{method:"POST",headers:a,body:JSON.stringify(s)})];case 2:switch(r.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.cancelStopBoardPost=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(n=r.sent()).append("Content-Type","application/json"),a="/board/"+t+"/stop-post-user/"+e,[4,p.cc98Fetch(a,{method:"DELETE",headers:n})];case 2:switch(r.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.addBoardTopTopic=function(e,t,n,a,s){return r.__awaiter(this,void 0,void 0,function(){var t,o;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(t=r.sent()).append("Content-Type","application/json"),o={topState:n,duration:a,reason:s},[4,p.cc98Fetch("/topic/"+e+"/top",{method:"PUT",headers:t,body:JSON.stringify(o)})];case 2:switch(r.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.removeBoardTopTopic=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var t,a;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(t=r.sent()).append("Content-Type","application/json"),a=n,[4,p.cc98Fetch("/topic/"+e+"/top",{method:"DELETE",headers:t,body:JSON.stringify(a)})];case 2:switch(r.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.getTotalPage=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),[4,p.cc98Fetch("/me/all-message-count",{headers:t})];case 2:return[4,r.sent().json()];case 3:switch(n=r.sent(),e){case 1:return[2,n.replyCount];case 2:return[2,n.atCount];case 3:return[2,n.systemCount]}return[2]}})})},t.deleteTopic=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,s,o;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(n=r.sent()).append("Content-Type","application/json"),a="/topic/"+e,s=t,o=JSON.stringify(s),[4,p.cc98Fetch(a,{method:"DELETE",headers:n,body:o})];case 2:switch(r.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.lockTopic=function(e,t,n,a){return r.__awaiter(this,void 0,void 0,function(){var t,s,o,i;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(t=r.sent()).append("Content-Type","application/json"),s="/topic/"+e+"/lock",o={reason:n,value:a},i=JSON.stringify(o),[4,p.cc98Fetch(s,{method:"PUT",headers:t,body:i})];case 2:switch(r.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.upTopic=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var t,a,s,o;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(t=r.sent()).append("Content-Type","application/json"),a="/topic/"+e+"/up",s={reason:n},o=JSON.stringify(s),[4,p.cc98Fetch(a,{method:"PUT",headers:t,body:o})];case 2:switch(r.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.unLockTopic=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var t,a,s,o;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(t=r.sent()).append("Content-Type","application/json"),a="/topic/"+e+"/lock",s={reason:n},o=JSON.stringify(s),[4,p.cc98Fetch(a,{method:"DELETE",headers:t,body:o})];case 2:switch(r.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.setBestTopic=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,s,o;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(n=r.sent()).append("Content-Type","application/json"),a="/topic/"+e+"/best",s={reason:t},o=JSON.stringify(s),[4,p.cc98Fetch(a,{method:"PUT",headers:n,body:o})];case 2:switch(r.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.cancelBestTopic=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,s,o;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(n=r.sent()).append("Content-Type","application/json"),a="/topic/"+e+"/best",s={reason:t},o=JSON.stringify(s),[4,p.cc98Fetch(a,{method:"DELETE",headers:n,body:o})];case 2:switch(r.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.setDisableHot=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,s,o;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(n=r.sent()).append("Content-Type","application/json"),a="/topic/"+e+"/not-hot",s={reason:t},o=JSON.stringify(s),[4,p.cc98Fetch(a,{method:"PUT",headers:n,body:o})];case 2:switch(r.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.cancelDisableHot=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,s,o;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(n=r.sent()).append("Content-Type","application/json"),a="/topic/"+e+"/not-hot",s={reason:t},o=JSON.stringify(s),[4,p.cc98Fetch(a,{method:"DELETE",headers:n,body:o})];case 2:switch(r.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.signin=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(t=r.sent()).append("Content-Type","application/json"),n="/me/signin",[4,p.cc98Fetch(n,{method:"POST",headers:t,body:e})];case 2:return r.sent(),[2]}})})},t.getSigninInfo=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return e=n.sent(),t="/me/signin",[4,p.cc98Fetch(t,{headers:e})];case 2:return[4,n.sent().json()];case 3:return[2,n.sent()]}})})},t.getGlobalConfig=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return e=n.sent(),t="/config/global",[4,p.cc98Fetch(t,{headers:e})];case 2:return[4,n.sent().json()];case 3:return[2,n.sent()]}})})},t.getTopicInfo=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,s;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),n="/topic/"+e,[4,p.cc98Fetch(n,{headers:t})];case 2:switch((s=r.sent()).status){case 401:return C()?(a.default.dispatch(o.throwError("UnauthorizedTopic")),[2,null]):(a.default.dispatch(o.throwError("LogOut")),[2,null]);case 403:return a.default.dispatch(o.throwError("OperationForbidden")),[2,null];case 404:return a.default.dispatch(o.throwError("NotFoundTopic")),[2,null];case 500:return a.default.dispatch(o.throwError("ServerError")),[2,null]}return[4,s.json()];case 3:return[2,r.sent()]}})})},t.getBoardInfo=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),n="/board/"+e,[4,p.cc98Fetch(n,{headers:t})];case 2:switch((a=r.sent()).status){case 404:return[2,"not found"];case 500:return[2,"server error"]}return[4,a.json()];case 3:return!1===(s=r.sent()).canEntry?[2,"unauthorized"]:[2,s]}})})},t.getPostInfo=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),n="/post/basic?id="+e,[4,p.cc98Fetch(n,{headers:t})];case 2:switch((a=r.sent()).status){case 404:return[2,"not found"];case 500:return[2,"server error"]}return[4,a.json()];case 3:return!1===(s=r.sent()).canEntry?[2,"unauthorized"]:[2,s[0]]}})})},t.getTotalPageof10=function(e){var t=e+1;return t%10==0?t/10:(t-t%10)/10+1},t.isMaster=function(e){if(d.getLocalStorage("userInfo")){var t=d.getLocalStorage("userInfo").privilege,n=d.getLocalStorage("userInfo").name;if(d.getLocalStorage("userInfo").id,"管理员"===t||"超级版主"===t)return!0;if(!e)return!1;for(var r=0;r<e.length;r++)if(n===e[r])return!0}return!1},t.getBoardTag=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),n="/board/"+e+"/tag",[4,p.cc98Fetch(n,{headers:t})];case 2:return[4,r.sent().json()];case 3:return[2,r.sent()]}})})},t.setHighlight=function(e,t,n,a,s,o){return r.__awaiter(this,void 0,void 0,function(){var i,c,l,u;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return(i=r.sent()).append("Content-Type","application/json"),c="/topic/"+e+"/highlight",l={isBold:t,isItalic:n,color:a,duration:s,reason:o},u=JSON.stringify(l),[4,p.cc98Fetch(c,{method:"PUT",headers:i,body:u})];case 2:switch(r.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})},t.setFavoriteTopic=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),n="/me/favorite/"+e,[4,p.cc98Fetch(n,{method:"PUT",headers:t})];case 2:return r.sent(),[2,"ok"]}})})},t.deleteFavoriteTopic=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),n="/me/favorite/"+e,[4,p.cc98Fetch(n,{method:"DELETE",headers:t})];case 2:return r.sent(),[2,"ok"]}})})},t.getFavState=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),n="/topic/"+e+"/isfavorite",[4,p.cc98Fetch(n,{headers:t})];case 2:return[4,r.sent().json()];case 3:return[2,r.sent()]}})})},t.refreshUnReadCount=R,t.refreshHoverUnReadCount=function(){var e={totalCount:0,replyCount:0,atCount:0,systemCount:0,messageCount:0},t=d.getLocalStorage("noticeSetting");return t&&"否"===t.response&&"否"===t.system&&"否"===t.message&&"否"===t.attme?(d.setStorage("unreadCount",e),e):(d.getStorage("unreadCount")&&(e=d.getStorage("unreadCount")),t&&("否"===t.response&&(e.replyCount=0),"否"===t.system&&(e.systemCount=0),"否"===t.message&&(e.messageCount=0),"否"===t.attme&&(e.atCount=0)),e.totalCount=e.systemCount+e.atCount+e.replyCount+e.messageCount,e.totalCount>0?(u("#unreadCount-totalCount").removeClass("displaynone"),u("#unreadCount-totalCount").text(e.totalCount),e.replyCount>0?(u("#unreadCount-replyCount").removeClass("displaynone"),u("#unreadCount-replyCount").text(e.replyCount),u("#unreadCount-replyCount1").removeClass("displaynone"),u("#unreadCount-replyCount1").text(e.replyCount)):(u("#unreadCount-replyCount").addClass("displaynone"),u("#unreadCount-replyCount1").addClass("displaynone")),e.atCount>0?(u("#unreadCount-atCount").removeClass("displaynone"),u("#unreadCount-atCount").text(e.atCount),u("#unreadCount-atCount1").removeClass("displaynone"),u("#unreadCount-atCount1").text(e.atCount)):(u("#unreadCount-atCount").addClass("displaynone"),u("#unreadCount-atCount1").addClass("displaynone")),e.systemCount>0?(u("#unreadCount-systemCount").removeClass("displaynone"),u("#unreadCount-systemCount").text(e.systemCount),u("#unreadCount-systemCount1").removeClass("displaynone"),u("#unreadCount-systemCount1").text(e.systemCount)):(u("#unreadCount-systemCount").addClass("displaynone"),u("#unreadCount-systemCount1").addClass("displaynone")),e.messageCount>0?(u("#unreadCount-messageCount").removeClass("displaynone"),u("#unreadCount-messageCount").text(e.messageCount),u("#unreadCount-messageCount1").removeClass("displaynone"),u("#unreadCount-messageCount1").text(e.messageCount)):(u("#unreadCount-messageCount").addClass("displaynone"),u("#unreadCount-messageCount1").addClass("displaynone")),d.setStorage("unreadCount",e),e):(u("#unreadCount-totalCount").addClass("displaynone"),u("#unreadCount-replyCount").addClass("displaynone"),u("#unreadCount-replyCount1").addClass("displaynone"),u("#unreadCount-atCount").addClass("displaynone"),u("#unreadCount-atCount1").addClass("displaynone"),u("#unreadCount-systemCount").addClass("displaynone"),u("#unreadCount-systemCount1").addClass("displaynone"),u("#unreadCount-messageCount").addClass("displaynone"),u("#unreadCount-messageCount1").addClass("displaynone"),d.setStorage("unreadCount",e),e))},t.editPost=function(e,t,n,a){return r.__awaiter(this,void 0,void 0,function(){var s,o,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return s=r.sent(),o="/post/"+e,i={content:a,title:n,contentType:t},c=JSON.stringify(i),[4,p.cc98Fetch(o,{method:"PUT",headers:s,body:c})];case 2:return r.sent(),[2,"ok"]}})})},t.getApiUrl=L,t.getTagInfo=O,t.getTagIdbyName=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s;return r.__generator(this,function(r){switch(r.label){case 0:return[4,O()];case 1:for(t=r.sent(),n=0,a=t;n<a.length;n++)if((s=a[n]).name===e)return[2,s.id];return[2,!1]}})})},t.getTagNamebyId=j,t.getTopicByOneTag=function(e,t,n,a){return r.__awaiter(this,void 0,void 0,function(){var s,o;return r.__generator(this,function(r){switch(r.label){case 0:return s="/topic/search/board/"+t+"/tag?tag"+n+"="+e+"&from="+10*(a-1)+"&size=20",[4,p.formAuthorizeHeader()];case 1:return o=r.sent(),[4,p.cc98Fetch(s,{headers:o})];case 2:return[4,r.sent().json()];case 3:return[2,r.sent()]}})})},t.getTopicByTwoTags=function(e,t,n,a){return r.__awaiter(this,void 0,void 0,function(){var s,o;return r.__generator(this,function(r){switch(r.label){case 0:return s="/topic/search/board/"+n+"/tag?tag1="+e+"&tag2="+t+"&from="+10*(a-1)+"&size=20",[4,p.formAuthorizeHeader()];case 1:return o=r.sent(),[4,p.cc98Fetch(s,{headers:o})];case 2:return[4,r.sent().json()];case 3:return[2,r.sent()]}})})},t.updateUserInfo=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s;return r.__generator(this,function(r){switch(r.label){case 0:return t="userId_"+e,[4,m.getUserInfo(e)];case 1:return n=r.sent(),a=n.name,s="userName_"+a,d.removeLocalStorage(t),d.removeLocalStorage(s),[4,m.getUserInfo(e)];case 2:return r.sent(),[2]}})})},t.getTagLayer=function(e,t){for(var n=0,r=t;n<r.length;n++)for(var a=r[n],s=0,o=a.tags;s<o.length;s++)if(o[s].id==e)return a.layer;return!1},t.findIP=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return t="/topic/"+e+"/look-ip",[4,p.formAuthorizeHeader()];case 1:return n=r.sent(),[4,p.cc98Fetch(t,{headers:n})];case 2:return 200!==(a=r.sent()).status?[3,4]:[4,a.json()];case 3:return[2,r.sent()];case 4:return[2,[]]}})})},t.moveTopic=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,s;return r.__generator(this,function(r){switch(r.label){case 0:return a="/topic/"+e+"/moveto/"+t,[4,p.formAuthorizeHeader()];case 1:return(s=r.sent()).append("Content-Type","application/json"),[4,p.cc98Fetch(a,{method:"PUT",headers:s,body:JSON.stringify({reason:n})})];case 2:return 200===r.sent().status?[2,"ok"]:[2,"error"]}})})},t.getBasicUsersInfo=F,t.getBasicPostsInfo=A,t.getThisPostInfo=H,t.getBasicTopicsInfo=B,t.getThisTopicInfo=D,t.atHanderler=function(e){try{var t=/([\s\S]*)\[quotex?\][\s\S]*?\[\/quotex?\]([\s\S]*)/,n=/@[^ \n]{1,10}?[ ]+/g,r=/[^@ ]+/,a=void 0;do{(a=e.match(t))&&(e=""+e.match(t)[1]+e.match(t)[2])}while(a);if(""===e)return!1;if(e.match(n)){var s=e.match(n).length;s>10&&(s=10);for(var o=new Array,i=0;i<s;i++){var c=e.match(n)[i],l=r.exec(c)[0];o[i]=l}return o}return!1}catch(t){return e}},t.atUserUbbUrl=function(e){try{var t=/@[^ \n]{1,10}?[ ]+/g,n=/[^@ ]+/;if(""===e)return e;if(e.match(t)){var r=e.match(t).length;r>10&&(r=10);for(var a=new Array,s=0;s<r;s++){var o=e.match(t)[s],i=n.exec(o)[0];a[s]=i}for(s=0;s<r;s++){var c=new RegExp("@"+a[s]+"[ ]","g");e=e.replace(c,'[url="/user/name/'+a[s]+'"]@'+a[s]+" [/url]")}return e}return e}catch(t){return e}},t.atUserMdUrl=function(e){try{var t=/@[^ \n]{1,10}?[ ]+/g,n=/[^@ ]+/;if(""===e)return e;if(e.match(t)){var r=e.match(t).length;r>10&&(r=10);for(var a=new Array,s=0;s<r;s++){var o=e.match(t)[s],i=n.exec(o)[0];a[s]=i}for(s=0;s<r;s++){var c=new RegExp("@"+a[s]+" ","g");e=e.replace(c,"[@"+a[s]+" ](/user/name/"+a[s]+")")}return e}return e}catch(t){return e}},t.quoteJudger=function(e){var t=new RegExp("[(quotex?)].*[/(quotex?)]");return!(!e.match(t)||e.match(t)[1]!==e.match(t)[2])},t.readAll=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return e=location.pathname,t=null,n=d.getStorage("unreadCount"),[4,p.formAuthorizeHeader()];case 1:if(a=r.sent(),"/message/response"===e){if(0===n.replyCount)return[2,null];t="/notification/read-all-reply"}else if("/message/attme"===e){if(0===n.atCount)return[2,null];t="/notification/read-all-at"}else if("/message/system"===e){if(0===n.systemCount)return[2,null];t="/notification/read-all-system"}else{if("/message"!==e)return[2,null];if(0===n.replyCount)return[2,null];t="/notification/read-all-reply"}return[4,p.cc98Fetch(t,{method:"PUT",headers:a,body:""})];case 2:return r.sent(),R(),[2,null]}})})},t.noticeMessageShow=function(e){u("#"+e).removeClass("displaynone"),u("#"+e).removeClass("noticeDisplaynone"),setTimeout(function(){u("#"+e).addClass("noticeDisplaynone")},1500)},t.changeTheme=function(e){u("#mainStylesheet").remove(),document.getElementsByTagName("head")[0].innerHTML+='<link id="mainStylesheet" type="text/css" rel="stylesheet" href="/static/content/'+themeNames[e]+'">'},t.queryWealth=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return t=r.sent(),n="/manage/reward-daily-record?boardId="+e,[4,p.cc98Fetch(n,{headers:t})];case 2:return[4,r.sent().json()];case 3:return[2,r.sent()]}})})},t.getBoardRecord=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,s;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return a=r.sent(),s="/board/"+e+"/events?from="+t+"&size="+n,[4,p.cc98Fetch(s,{headers:a})];case 2:return[4,r.sent().json()];case 3:return[2,r.sent()]}})})},t.getMonthlyHotTopic=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,s,i,c,l,u,d,m,h,f,g,v,y,E,_,C;return r.__generator(this,function(r){switch(r.label){case 0:return[4,p.formAuthorizeHeader()];case 1:return r.sent(),[4,p.cc98Fetch("/topic/hot-"+e)];case 2:switch((t=r.sent()).status){case 401:a.default.dispatch(o.throwError("UnauthorizedTopic"));case 403:a.default.dispatch(o.throwError("OperationForbidden"))}return[4,t.json()];case 3:n=r.sent(),s=[],i=[],c=[],l=0,u=n,r.label=4;case 4:return l<u.length?((d=u[l]).time=T(d.time),d.lastPostTime=T(d.lastPostTime),d.hitCount>1e4&&(d.hitCount>1e5?(m=parseInt(""+d.hitCount/1e4),d.hitCount=m+"万"):(m=parseInt(""+d.hitCount/1e3)/10,d.hitCount=m+"万")),d.floorCount=d.replyCount+1,d.replyCount>1e4&&(d.replyCount>1e5?(m=parseInt(""+d.replyCount/1e4),d.replyCount=m+"万"):(m=parseInt(""+d.replyCount/1e3)/10,d.replyCount=m+"万")),d.tag1?(h=d,[4,j(d.tag1)]):[3,7]):[3,11];case 5:return h.tag1=r.sent(),d.tag2?(f=d,[4,j(d.tag2)]):[3,7];case 6:f.tag2=r.sent(),r.label=7;case 7:return d.userId?(g=d,[4,w(d.boardId)]):[3,9];case 8:return g.boardName=r.sent(),s.push(d),i.push(d.userId),[3,10];case 9:d.portraitUrl="/static/images/_心灵之约.png",d.userName="匿名用户",d.boardName="心灵之约",c.push(d),r.label=10;case 10:return l++,[3,4];case 11:return[4,F(i)];case 12:for(E in v=r.sent(),s)y=b(s[E].userId,v),s[E].portraitUrl=y.portraitUrl;for(E=0,_=0,C=0;E<n.length;E++)_===s.length?(n[E]=c[C],C++):n[E].id===s[_].id?(n[E]=s[_],_++):(n[E]=c[C],C++);return[2,n]}})})}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=function(){return function(){this.isInQuote=!1,this.islastQuote=!1}}();t.UbbCodeContextData=a;var s=function(){function e(e,t){this._engine=e,this._options=t}return Object.defineProperty(e.prototype,"engine",{get:function(){return this._engine},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._engine.data},enumerable:!0,configurable:!0}),e}();t.UbbCodeContext=s;var o,i,c=function(){return function(){this.autoDetectUrl=!0,this.allowExternalUrl=!0,this.allowImage=!0,this.allowExternalImage=!0,this.allowMediaContent=!0,this.allowAutoPlay=!0,this.allowEmotion=!0,this.compatibility=o.Recommended}}();t.UbbCodeOptions=c,function(e){e[e.Transitional=0]="Transitional",e[e.Recommended=1]="Recommended",e[e.EnforceMorden=2]="EnforceMorden"}(o=t.UbbCompatiblityMode||(t.UbbCompatiblityMode={})),function(e){e[e.String=0]="String",e[e.ItemSeperator=1]="ItemSeperator",e[e.NameValueSeperator=2]="NameValueSeperator"}(i||(i={}));var l,u=function(){function e(e,t){this.type=e,this.value=t}return e.stringValue=function(t){return new e(i.String,t)},e.itemSeperator=new e(i.ItemSeperator,null),e.nameValueSeperator=new e(i.NameValueSeperator,null),e}();!function(e){e[e.Text=0]="Text",e[e.Tag=1]="Tag"}(l=t.UbbSegmentType||(t.UbbSegmentType={}));var d=function(){function e(e){this._parent=e}return Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),e}();t.UbbSegment=d;var p=function(e){function t(t,n){var r=e.call(this,n)||this;return r._text=t,r}return r.__extends(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return l.Text},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},enumerable:!0,configurable:!0}),t.prototype.clone=function(e){return new t(this._text,e)},t}(d);t.UbbTextSegment=p;var m=function(e){function t(t,n){var r=e.call(this,n)||this;return r._isClosed=!1,r._subSegments=[],r._tagData=t,r}return r.__extends(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return l.Tag},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isClosed",{get:function(){return this._isClosed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tagData",{get:function(){return this._tagData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subSegments",{get:function(){return this._subSegments},enumerable:!0,configurable:!0}),t.forceClose=function(e,n){if(e.type===l.Text)n._subSegments.push(e.clone(n));else{var r=e;if(r.isClosed)n._subSegments.push(e.clone(n));else{console.warn("标签 %s 没有正确关闭，已经被转换为纯文字。",r.tagData.tagName),n._subSegments.push(new p(r.tagData.startTagString,e.parent));for(var a=0,s=r._subSegments;a<s.length;a++){var o=s[a];t.forceClose(o,n)}}}},t.prototype.close=function(){var e=this._subSegments;this._subSegments=[];for(var n=0,r=e;n<r.length;n++){var a=r[n];t.forceClose(a,this)}this._isClosed=!0},t.prototype.clone=function(e){var n=new t(this._tagData,e);n._content=this._content,n._isClosed=this._isClosed;for(var r=0,a=this._subSegments;r<a.length;r++){var s=a[r];n._subSegments.push(s.clone(n))}return n},t.prototype.getContentText=function(){for(var e=[],t=0,n=this._subSegments;t<n.length;t++){var r=n[t];r.type===l.Text?e.push(r.text):e.push(r.getFullText())}return e.join("")},t.prototype.getFullText=function(){return this.tagData.startTagString+this.getContentText()+this.tagData.endTagString},t}(d);t.UbbTagSegment=m;var h=function(){function e(e,t){if(!t)throw new Error("参数不能为空。");this._originalString=e,this._parameters=t,this._namedParameters={};for(var n=0,r=t;n<r.length;n++){var a=r[n];a.name&&(this._namedParameters[a.name]=a.value)}}return Object.defineProperty(e.prototype,"orignalString",{get:function(){return this._originalString},enumerable:!0,configurable:!0}),e.parse=function(t){if(!t)return null;var n=function(e){var t=0;function n(n){function r(n){var r=e[t],a=e.indexOf(n,t+1);a<0&&(console.error("UBB: 解析标签字符串 %s 时无法找到位置 %d 处 %s 对应的结束字符串。",e,t,r),a=e.length);var s=t+1;return t=a+1,e.substring(s,a)}for(;;){if(t>=e.length)return null;var a=e[t];if(!/\s/i.test(a)){if(","===a)return t++,u.itemSeperator;if("="===a)return t++,u.nameValueSeperator;if('"'===a||"'"===a)return u.stringValue(r(a));var s=t,o=n===i.ItemSeperator?/[=,]/i:/,/i,c=e.substring(t+1).match(o);if(c){var l=c.index+t+1;return t=l,u.stringValue(e.substring(s,l))}return t=e.length,u.stringValue(e.substring(s))}t++}}var r=[],a=i.ItemSeperator;for(;;){var s=n(a);if(!s)break;r.push(s),a=s.type}return r}(t);if(0===n.length)return null;var r=function(e){var n=[];if(!e||0===e.length)return console.error("UBB: 无法将标签字符串 %s 解析为参数的集合。",t),n;for(var r=null,a=null,s=i.ItemSeperator,o=0,c=e;o<c.length;o++){var l=c[o];switch(l.type){case i.ItemSeperator:n.push(new g(r,a)),r=null,a=null,s=i.ItemSeperator;break;case i.NameValueSeperator:if(s!==i.String)throw new Error("名称值分隔符只能出现在值之后。");r=a,a=null,s=i.NameValueSeperator;break;default:if(s===i.String)throw new Error("不能连续出现多个值。");a=l.value,s=i.String}}n.push(new g(r,a)),n[0].name||(n[0]=new g(n[0].value,null));return n}(n);return new e(t,r)},Object.defineProperty(e.prototype,"tagName",{get:function(){return this._parameters[0].name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startTagString",{get:function(){return"["+this.orignalString+"]"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endTagString",{get:function(){return"[/"+this.tagName+"]"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainValue",{get:function(){return this._parameters[0].value},enumerable:!0,configurable:!0}),e.prototype.value=function(e){if("number"==typeof e)return this._parameters[e].value;if("string"==typeof e)return this._namedParameters[e];throw new Error("参数必须是字符串或者数字。")},e.prototype.name=function(e){return this._parameters[e].name},Object.defineProperty(e.prototype,"parameterCount",{get:function(){return this._parameters.length},enumerable:!0,configurable:!0}),e.prototype.parameter=function(e){return this._parameters[e]},e}();t.UbbTagData=h;var f,g=function(){function e(e,t){this._name=e,this._value=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();!function(e){e[e.Recursive=0]="Recursive",e[e.Text=1]="Text",e[e.Empty=2]="Empty"}(f=t.UbbTagMode||(t.UbbTagMode={}));var v=function(){return function(){}}();t.UbbTextHandler=v;var y=function(){function e(){}return e.prototype.getTagMode=function(e){return f.Recursive},e.renderTagAsString=function(e,t){return[e.startTagString,t,e.endTagString]},e}();t.UbbTagHandler=y;var E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.exec=function(e,t){return this.execCore(e.getContentText(),e.tagData,t)},t}(y);t.TextTagHandler=E;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.exec=function(e,t){for(var n=[],r=0,a=e.subSegments;r<a.length;r++){var s=a[r];n.push(t.engine.execSegment(s,t))}return this.execCore(n,e.tagData,t)},t}(y);t.RecursiveTagHandler=b;var _=function(){function e(){this._namedTagHandlerList={},this._unnamedTagHanlderList=[],this._textHandlers=[]}return Object.defineProperty(e.prototype,"textHandlers",{get:function(){return this._textHandlers},enumerable:!0,configurable:!0}),e.prototype.getHandler=function(e){var t=this._namedTagHandlerList[e];if(t)return t;for(var n=0,r=this._unnamedTagHanlderList;n<r.length;n++){var a=r[n];if(a.supportedTagNames.test(e))return a}return null},e.prototype.register=function(e){this.registerInstance(new e)},e.prototype.registerInstance=function(e){if(!e||!e.supportedTagNames)throw new Error("参数 tagHandler 无效，或者未提供正确的标签名称。");"string"==typeof e.supportedTagNames?this.registerNamedCore([e.supportedTagNames],e):e.supportedTagNames instanceof Array?this.registerNamedCore(e.supportedTagNames,e):this.registerUnnamedCore(e)},e.prototype.registerText=function(e){this.registerTextInstance(new e)},e.prototype.registerTextInstance=function(e){if(!e)throw new Error("参数 textHandler 无效。");this._textHandlers.push(e)},e.prototype.registerNamedCore=function(e,t){for(var n=0,r=e;n<r.length;n++){var a=r[n];a in this._namedTagHandlerList?console.error("标签 %s 的处理程序已经被注册。",a):this._namedTagHandlerList[a]=t}},e.prototype.registerUnnamedCore=function(e){this._unnamedTagHanlderList.push(e)},e}(),w=function(){function e(){this._handlers=new _,this._data=new a}return Object.defineProperty(e.prototype,"handlers",{get:function(){return this._handlers},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.getHandler=function(e){return this._handlers.getHandler(e)},e.prototype.exec=function(e,t){var n=new s(this,t);return this.execCore(e,n)},e.tryHandleEndTag=function(e,t){for(var n=t;n&&n.tagData;){if(n.tagData.tagName===e)return n.close(),n.parent;n=n.parent}return console.warn("UBB: 找不到结束标签 %s 的开始标签，该标签将被作为一般文字处理。",e),t.subSegments.push(new p("[/"+e+"]",t)),t},e.prototype.buildSegmentsCore=function(t,n){for(var r=/([\s\S]*?)\[(.+?)]/gi;;){var a=r.lastIndex,s=r.exec(t);if(!s){var o=t.substring(a);return void(o&&n.subSegments.push(new p(o,n)))}var i=s[1],c=s[2];i&&n.subSegments.push(new p(i,n));var l=c.match(/^\/(.+)$/i);if(l){var u=l[1];n=e.tryHandleEndTag(u,n)}else try{var d=h.parse(c),g=this._handlers.getHandler(d.tagName);if(!g){console.warn("UBB: 标签字符串 %s 中给定的标签名 %s 没有有效的处理程序，将被视为一般文字",c,d.tagName),n.subSegments.push(new p(d.startTagString,n));continue}switch(g.getTagMode(d)){case f.Recursive:var v=new m(d,n);n.subSegments.push(v),n=v;break;case f.Text:var y=t.indexOf(d.endTagString,r.lastIndex);if(-1===y)console.warn("UBB: 找不到标签字符串 %s 对应的结束标签，该内容将被视为一般文字。",d.startTagString),n.subSegments.push(new p(d.startTagString,n));else{var E=t.substring(r.lastIndex,y),b=new m(d,n);n.subSegments.push(b),n=b;var _=new p(E,b);b.subSegments.push(_),b.close(),r.lastIndex=y+d.endTagString.length}break;case f.Empty:var w=new m(d,n);n.subSegments.push(w),w.close(),t.startsWith(d.endTagString,r.lastIndex)&&(r.lastIndex+=d.endTagString.length);break;default:throw new Error("UBB: 标签 "+d.tagName+" 的处理程序发生错误")}}catch(e){console.warn("UBB: 标签字符串 %s 解析失败，将被视为普通文字。",c),n.subSegments.push(new p("["+c+"]",n))}}},e.prototype.execCore=function(e,t){var n=new m(null,null);this.buildSegmentsCore(e,n),n.close();for(var r=[],a=0,s=n.subSegments;a<s.length;a++){var o=s[a];r.push(this.execSegment(o,t))}return r},e.prototype.execTextCore=function(e,t){for(var n=0,r=this.handlers.textHandlers;n<r.length;n++){var a=r[n],s=e.match(a.supportedContent);if(s){var o=e.substr(0,s.index),i=e.substr(s.index+s[0].length),c=[];return o&&c.push(this.execTextCore(o,t)),c.push(a.exec(s,t)),i&&c.push(this.execTextCore(i,t)),c}}return e},e.prototype.execText=function(e,t){return this.execTextCore(e,t)},e.prototype.execSegment=function(e,t){if(e.type===l.Text){var n=e.text;return this.execText(n,t)}var r=e,a=this.getHandler(r.tagData.tagName);return a?a.exec(r,t):(console.warn("没有找到标签 %s 的处理程序，将被视为一般文字。",r.tagData.tagName),r.getFullText())},e}();t.UbbCodeEngine=w},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(73),a=n(158);t.userLogIn=a.createAction(r.USER_LOG_ON),t.userLogOff=a.createAction(r.USER_LOG_OFF),t.usercenterPageLoadUnfinish=a.createAction(r.USER_CENTER_PAGE_LOAD_UNFINISH),t.userNotFound=a.createAction(r.USER_NOT_FOUND),t.userCenterLoading=a.createAction(r.USER_CENTER_LOADING),t.userCenterLoaded=a.createAction(r.USER_CENTER_LOADED),t.userCenterSolveError=a.createAction(r.USER_CENTER_SOLVE_ERROR),t.usercenterPageLoadFinish=a.createAction(r.USER_CENTER_PAGE_LOAD_FINISH,function(e){return{type:r.USER_CENTER_PAGE_LOAD_FINISH,payload:{totalPage:e}}}),t.changeUserInfo=a.createAction(r.CHANGE_USERINFO,function(e){return{type:r.CHANGE_USERINFO,payload:{newInfo:e}}}),t.changeCurrentVisitingUserPage=a.createAction(r.CHANGE_VISITING_USER,function(e,t){return void 0===e&&(e="exact"),{type:r.CHANGE_VISITING_USER,payload:{page:e,id:t}}}),t.userCenterError=a.createAction(r.USER_CENTER_FETCH_ERROR,function(e){return{type:r.USER_CENTER_FETCH_ERROR,payload:{message:e}}}),t.changeUserFavoriteBoards=a.createAction(r.CHANGE_USER_FAVORITE_BOARDS,function(e){return{type:r.CHANGE_USER_FAVORITE_BOARDS,payload:{boardsInfo:e}}}),t.changeUserRecentPosts=a.createAction(r.CHANGE_USER_RECENT_POSTS,function(e){return{type:r.CHANGE_USER_RECENT_POSTS,payload:{posts:e}}}),t.changeUserFavoritePosts=a.createAction(r.CHANGE_USER_FAVORITE_POSTS,function(e){return{type:r.CHANGE_USER_FAVORITE_POSTS,payload:{posts:e}}}),t.changeUserFansInfo=a.createAction(r.CHANGE_USER_FANS_INFO,function(e){return{type:r.CHANGE_USER_FANS_INFO,payload:{fansInfo:e}}}),t.changeUserFollowingsInfo=a.createAction(r.CHANGE_USER_FOLLOWINGS_INFO,function(e){return{type:r.CHANGE_USER_FOLLOWINGS_INFO,payload:{followingsInfo:e}}}),t.changeUserCenterPage=a.createAction(r.CHNAGE_USER_CENTER_PAGE,function(e){return{type:r.CHNAGE_USER_CENTER_PAGE,payload:{page:e}}}),t.followUser=a.createAction(r.USER_CENTER_FOLLOW_USER,function(e){return{type:r.USER_CENTER_FOLLOW_USER,payload:{userId:e}}}),t.unfollowUser=a.createAction(r.USER_CENTER_UNFOLLOW_USER,function(e){return{type:r.USER_CENTER_UNFOLLOW_USER,payload:{userId:e}}}),t.userCenterTransferWealthSuccess=a.createAction(r.USER_CENTER_TRANSFER_WEALTH_SUCCESS,function(e){return{type:r.USER_CENTER_TRANSFER_WEALTH_SUCCESS,payload:{userNames:e}}})},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this.props.title||"CC98论坛";document.title=e},t.prototype.componentWillReceiveProps=function(e){if(e.title!==this.props.title){var t=e.title||"CC98论坛";document.title=t}},t.prototype.render=function(){return this.props.children?a.Children.only(this.props.children):null},t}(a.Component);t.default=s},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(72),o=function(){return function(){}}();t.UbbContainerProps=o;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.engine||s.createEngine(),t=this.props.options||new s.UbbCodeOptions,n=this.props.code,r=e.exec(n||"",t),o={whiteSpace:"pre-wrap",width:"100%"};return t.compatibility===s.UbbCompatiblityMode.Transitional?a.createElement("blockquote",{style:o},r):a.createElement("article",{style:o},r)},t}(a.Component);t.UbbContainer=i},,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);r.__exportStar(n(262),t),r.__exportStar(n(261),t),r.__exportStar(n(260),t),r.__exportStar(n(259),t),r.__exportStar(n(258),t),r.__exportStar(n(257),t);var a=n(256);t.sendWealthTo=a.sendWealth},,,,function(e,t){e.exports=$},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=n(291),i=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.handleInput=function(e){var t=parseInt(e.target.value,10);isNaN(t)||t<1||t>r.props.totalPage||r.setState({nextPage:t})},r.state={nextPage:r.props.page},r}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.page,n=e.url,r=e.totalPage,i=[],c=Math.max(1,t-3),l=Math.min(r,t+3);if(l-c!=6){var u=6-(l-t),d=6-(t-c);c=Math.max(1,t-u),l=Math.min(r,t+d)}for(var p=c;p<=l;p++)i.push(p);var m=1!==i[0],h=i[i.length-1]!==r,f=1!==c,g=l!==r,v=r>20;return a.createElement("div",{className:"pagination"},a.createElement("ul",{className:"page-nav"},m&&a.createElement(o.PageModel,{text:"1",url:n+"1#1"}),f&&a.createElement(o.PageModel,{text:"‹",url:""+n+(t-1)+"#1"}),i.map(function(e){return a.createElement(o.PageModel,{text:""+e,url:""+n+e+"#1",active:t===e})}),g&&a.createElement(o.PageModel,{text:"›",url:""+n+(t+1)+"#1"}),h&&a.createElement(o.PageModel,{text:""+r,url:""+n+r+"#1"})),v&&a.createElement("div",{className:"page-goto"},a.createElement("div",null,a.createElement("input",{onChange:this.handleInput,placeholder:"跳转到"})),a.createElement("div",null,a.createElement(s.Link,{to:""+n+this.state.nextPage+"#1"}," Go "))))},t}(a.Component);t.Pager=i},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.userId||($("#user_"+this.props.id).removeAttr("href"),$("#user_"+this.props.id).removeAttr("target"),$("#lastpost_"+this.props.id).removeAttr("href"),$("#lastpost_"+this.props.id).removeAttr("target"))},t.prototype.render=function(){var e="/topic/"+this.props.id+"/1",t="/user/id/"+this.props.userId,n="/list/"+this.props.boardId,r=this.props.floorCount/10+1,s=parseInt(r),o=this.props.floorCount+10-10*s,i=s+"#"+o;0===o&&(i=s-1+"#10");var c="/topic/"+this.props.id+"/"+i,l="/user/name/"+encodeURI(this.props.lastPostUser),u="",d=this.props.userName;return this.props.tag1?(u=this.props.tag2?"标签："+this.props.tag1+" / "+this.props.tag2:"标签："+this.props.tag1,a.createElement("div",{className:"focus-topic"},a.createElement("a",{className:"focus-topic-left",href:t,target:"_blank",id:"user_"+this.props.id},a.createElement("img",{className:"focus-topic-portraitUrl",src:this.props.portraitUrl}),a.createElement("div",{className:"focus-topic-userName"},d)),a.createElement("div",{className:"focus-topic-middle"},a.createElement("a",{className:"focus-topic-title",href:e,target:"_blank"},this.props.title),a.createElement("div",{className:"focus-topic-info"},a.createElement("div",null,u),a.createElement("div",null,a.createElement("i",{className:"fa fa-clock-o fa-lg"}),this.props.time),a.createElement("div",null,a.createElement("i",{className:"fa fa-eye fa-lg"})," ",this.props.hitCount),a.createElement("div",null,"最后回复：",a.createElement("a",{href:l,target:"_blank",id:"lastpost_"+this.props.id},this.props.lastPostUser)),a.createElement("div",null,a.createElement("a",{href:c,target:"_blank"},this.props.lastPostTime)))),a.createElement("div",{className:"focus-topic-rightBar"}),a.createElement("a",{className:"focus-topic-right",href:n,target:"_blank"},a.createElement("div",{className:"focus-topic-board"},this.props.boardName)))):a.createElement("div",{className:"focus-topic"},a.createElement("a",{className:"focus-topic-left",href:t,target:"_blank",id:"user_"+this.props.id},a.createElement("img",{className:"focus-topic-portraitUrl",src:this.props.portraitUrl}),a.createElement("div",{className:"focus-topic-userName"},this.props.userName)),a.createElement("div",{className:"focus-topic-middle"},a.createElement("a",{className:"focus-topic-title",href:e,target:"_blank"},this.props.title),a.createElement("div",{className:"focus-topic-info"},a.createElement("div",null,a.createElement("i",{className:"fa fa-clock-o fa-lg"}),this.props.time),a.createElement("div",null,a.createElement("i",{className:"fa fa-eye fa-lg"})," ",this.props.hitCount),a.createElement("div",null,"最后回复：",a.createElement("a",{href:l,target:"_blank",id:"lastpost_"+this.props.id},this.props.lastPostUser)),a.createElement("div",null,a.createElement("a",{href:c,target:"_blank"},this.props.lastPostTime)))),a.createElement("div",{className:"focus-topic-rightBar"}),a.createElement("a",{className:"focus-topic-right",href:n,target:"_blank"},a.createElement("div",{className:"focus-topic-board"},this.props.boardName)))},t}(a.Component);t.FocusTopicSingle=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(154),s=n(69),o=n(81);t.getUsersInfo=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,i,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,8,,9]),t=void 0,window.indexedDB?[4,a.getUsersInfo(e)]:[3,2];case 1:return t=r.sent().map(function(t,n){return t||e[n]}),[3,3];case 2:t=e.map(function(e){return s.getLocalStorage("number"==typeof e?"userId_"+e:"userName_"+e)||e}),r.label=3;case 3:return n=t.filter(function(e){return"number"==typeof e||"string"==typeof e}),i=[],0===n.length?[3,7]:(c="number"==typeof e[0]?"/user?id="+n.join("&id="):"/user/name?name="+n.map(encodeURIComponent).join("&name="),[4,o.formAuthorizeHeader()]);case 4:return l=r.sent(),[4,o.cc98Fetch(c,{headers:l})];case 5:return[4,r.sent().json()];case 6:i=r.sent(),r.label=7;case 7:return[2,t.map(function(e){if("number"!=typeof e&&"string"!=typeof e)return e;var t=i.shift();return t?(window.indexedDB?a.addUserInfo(t):(s.setLocalStorage("userId_"+t.id,t,3600),s.setLocalStorage("userName_"+t.name,t,3600)),t):void 0})];case 8:return r.sent(),[3,9];case 9:return[2]}})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(154),s=n(69),o=n(81);t.getUserInfo=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,i;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,7,,8]),window.indexedDB?[4,a.getUserInfo(e)]:[3,2];case 1:return(t=r.sent())?[2,t]:[3,3];case 2:if(t=s.getLocalStorage("number"==typeof e?"userId_"+e:"userName_"+e))return[2,t];r.label=3;case 3:return n="number"==typeof e?"/user/"+e:"/user/name/"+encodeURIComponent(e),[4,o.formAuthorizeHeader()];case 4:return i=r.sent(),[4,o.cc98Fetch(n,{headers:i})];case 5:return[4,r.sent().json()];case 6:return t=r.sent(),window.indexedDB?a.addUserInfo(t):(s.setLocalStorage("userId_"+t.id,t,3600),s.setLocalStorage("userName_"+t.name,t,3600)),[2,t];case 7:return r.sent(),[3,8];case 8:return[2]}})})}},function(e,t,n){"use strict";function r(e,t,n){void 0===n&&(n=0);try{var a=t;if(a="object"==typeof a?"obj-"+(a=JSON.stringify(a)):"str-"+a,localStorage.setItem(e,a),0!==n){var o=(new Date).getTime()+1e3*n;localStorage.setItem(e+"_expirationTime",o.toString().slice(0,o.toString().length-3))}else localStorage.removeItem(e+"_expirationTime")}catch(a){s(),r(e,t,n)}}function a(e){var t=localStorage.getItem(e),n=localStorage.getItem(e+"_expirationTime");if(n&&(new Date).getTime()>1e3*Number.parseInt(n))return void localStorage.removeItem(e);if(t)return 0===t.indexOf("obj-")?(t=t.slice(4),JSON.parse(t)):0===t.indexOf("str-")?t.slice(4):void 0}function s(){var e=a("refresh_token"),t=localStorage.getItem("refresh_token_expirationTime"),n=a("temporaryContent"),s=a("noticeSetting"),o=localStorage.getItem("userInfo"),i=localStorage.getItem("version");localStorage.clear(),console.info("localStorage cleared"),localStorage.setItem("version",i),e&&(r("refresh_token",e),localStorage.setItem("refresh_token_expirationTime",t),localStorage.setItem("userInfo",o)),n&&r("temporaryContent",n),s&&r("noticeSetting",s)}Object.defineProperty(t,"__esModule",{value:!0}),t.setStorage=function(e,t){var n=t;n="object"==typeof n?"obj-"+(n=JSON.stringify(n)):"str-"+n,sessionStorage.setItem(e,n)},t.getStorage=function(e){var t=sessionStorage.getItem(e);if(t)return 0===t.indexOf("obj-")?(t=t.slice(4),JSON.parse(t)):0===t.indexOf("str-")?t.slice(4):void 0},t.removeStorage=function(e){"all"!=e?sessionStorage.removeItem(e):sessionStorage.clear()},t.setLocalStorage=r,t.getLocalStorage=a,t.removeLocalStorage=function(e){"all"!=e?localStorage.removeItem(e):localStorage.clear()},t.autoClearLocalStorage=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);!function(e){e.loadConfig=function(){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(a){switch(a.label){case 0:return[4,fetch("/static/config.json")];case 1:if(!(t=a.sent()).ok)throw new Error("系统无法读取配置文件，网站无法正常运行");return[4,t.json()];case 2:e.config=a.sent(),a.label=3;case 3:return a.trys.push([3,6,,7]),[4,fetch("/static/config.production.json")];case 4:return[4,a.sent().json()];case 5:return n=a.sent(),e.config=r.__assign({},e.config,n),[3,7];case 6:return a.sent(),[3,7];case 7:return[2]}})})}}(t.Constants||(t.Constants={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(6),s=n(16);t.LogOut=function(){return r.createElement("div",{className:"errorState"},r.createElement(s.default,{title:"您未登录 - CC98论坛"}),r.createElement("div",null,r.createElement("img",{className:"errorIcon",src:"/static/images/401.png"})),r.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),r.createElement("div",{className:"errorText"},"您当前未登录"),r.createElement("div",{className:"row returnIndexBtn"},r.createElement(a.Link,{to:"/logon"},"点我登录")))},t.TopicDeleted=function(){return r.createElement("div",{className:"errorState"},r.createElement(s.default,{title:"帖子被删除了 - CC98论坛"}),r.createElement("div",null,r.createElement("img",{className:"errorIcon",src:"/static/images/404.png"})),r.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),r.createElement("div",{className:"errorText"},"帖子被删除"),r.createElement("div",{className:"row returnIndexBtn"},r.createElement(a.Link,{to:"/"},"返回首页")))},t.Disconnected=function(){return r.createElement("div",null,r.createElement(s.default,{title:"网络中断 - CC98论坛"}),r.createElement("div",null,"网络连接中断"))},t.UnauthorizedBoard=function(){return r.createElement("div",{className:"errorState"},r.createElement(s.default,{title:"您没有权限进入这个版面 - CC98论坛"}),r.createElement("div",null,r.createElement("img",{className:"errorIcon",src:"/static/images/401.png"})),r.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),r.createElement("div",{className:"errorText"},"您没有权限进入这个版面"),r.createElement("div",{className:"row returnIndexBtn"},r.createElement(a.Link,{to:"/"},"返回首页")))},t.UnauthorizedTopic=function(){return r.createElement("div",{className:"errorState"},r.createElement(s.default,{title:"您没有权限进入这个主题 - CC98论坛"}),r.createElement("div",null,r.createElement("img",{className:"errorIcon",src:"/static/images/401.png"})),r.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),r.createElement("div",{className:"errorText"},"您没有权限进入这个主题"),r.createElement("div",{className:"row returnIndexBtn"},r.createElement(a.Link,{to:"/"},"返回首页")))},t.UnauthorizedOperation=function(){return r.createElement("div",{className:"errorState"},r.createElement(s.default,{title:"您没有权限执行这个操作 - CC98论坛"}),r.createElement("div",null,r.createElement("img",{className:"errorIcon",src:"/static/images/401.png"})),r.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),r.createElement("div",{className:"errorText"},"您没有权限进行这个操作"),r.createElement("div",{className:"row returnIndexBtn"},r.createElement(a.Link,{to:"/"},"返回首页")))},t.NotFoundBoard=function(){return r.createElement("div",{className:"errorState"},r.createElement(s.default,{title:"版面不存在 - CC98论坛"}),r.createElement("div",null,r.createElement("img",{className:"errorIcon",src:"/static/images/404.png"})),r.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),r.createElement("div",{className:"errorText"},"版面不存在"),r.createElement("div",{className:"row returnIndexBtn"},r.createElement(a.Link,{to:"/"},"返回首页")))},t.NotFoundTopic=function(){return r.createElement("div",{className:"errorState"},r.createElement(s.default,{title:"帖子不存在 - CC98论坛"}),r.createElement("div",null,r.createElement("img",{className:"errorIcon",src:"/static/images/404.png"})),r.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),r.createElement("div",{className:"errorText"},"帖子不存在"),r.createElement("div",{className:"row returnIndexBtn"},r.createElement(a.Link,{to:"/"},"返回首页")))},t.CannotPost=function(){return r.createElement("div",{className:"errorState"},r.createElement(s.default,{title:"您还不能发帖 - CC98论坛"}),r.createElement("div",null,r.createElement("img",{className:"errorIcon",src:"/static/images/403.png"})),r.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),r.createElement("div",{className:"errorText"},"你无法在本版发帖，可能的原因有：权限不足、未达到发帖门槛、版面已锁定、账号受到处罚等。"),r.createElement("div",{className:"row returnIndexBtn"},r.createElement(a.Link,{to:"/"},"返回首页")))},t.NotFoundUser=function(){return r.createElement("div",{className:"errorState"},r.createElement(s.default,{title:"用户不存在 - CC98论坛"}),r.createElement("div",null,r.createElement("img",{className:"errorIcon",src:"/static/images/404.png"})),r.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),r.createElement("div",{className:"errorText"},"用户不存在"),r.createElement("div",{className:"row returnIndexBtn"},r.createElement(a.Link,{to:"/"},"返回首页")))},t.ServerError=function(){return r.createElement("div",{className:"errorState"},r.createElement(s.default,{title:"服务器发送错误 - CC98论坛"}),r.createElement("div",null,r.createElement("img",{className:"errorIcon",src:"/static/images/500.png"})),r.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),r.createElement("div",{className:"errorText"},"服务器发送错误"),r.createElement("div",{className:"row returnIndexBtn"},r.createElement(a.Link,{to:"/"},"返回首页")))},t.ContentNeeded=function(){return r.createElement("div",null,r.createElement(s.default,{title:"请输入内容 - CC98论坛"}),r.createElement("div",{className:"errorText"},"402需要输入内容"))},t.OperationForbidden=function(){return r.createElement("div",{className:"errorState"},r.createElement(s.default,{title:"操作失败或被拒绝 - CC98论坛"}),r.createElement("div",null,r.createElement("img",{className:"errorIcon",src:"/static/images/403.png"})),r.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),r.createElement("div",{className:"errorText"},"操作失败或被拒绝"),r.createElement("div",{className:"row returnIndexBtn"},r.createElement(a.Link,{to:"/"},"返回首页")))},t.PageNotFound=function(){return r.createElement("div",{className:"errorState"},r.createElement(s.default,{title:"页面不存在 - CC98论坛"}),r.createElement("div",null,r.createElement("img",{className:"errorIcon",src:"/static/images/404.png"})),r.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),r.createElement("div",{className:"errorText"},"页面不存在"),r.createElement("div",{className:"row returnIndexBtn"},r.createElement(a.Link,{to:"/"},"返回首页")))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(7),s=n(339),o=n(338),i=n(156),c=n(329),l=n(328),u=n(327),d=n(326),p=n(325),m=n(324),h=n(323),f=n(322),g=n(319),v=n(317),y=n(316),E=n(315),b=n(314),_=n(313),w=n(312),C=n(311),I=n(310),N=n(309),S=n(308),T=n(307),x=n(306),k=n(305),P=n(304),U=n(303),M=n(302),R=n(301),L=n(300),O=n(299),j=n(298),F=n(297),A=n(296),H=n(295),B=n(294),D=n(293),z=n(292);t.createEngine=function(){var e=new a.UbbCodeEngine;return e.handlers.register(o.BTagHandler),e.handlers.register(i.ImageTagHandler),e.handlers.register(c.ITagHandler),e.handlers.register(l.SizeTagHandler),e.handlers.register(u.QuoteTagHandler),e.handlers.register(d.ColorTagHandler),e.handlers.register(p.UrlTagHandler),e.handlers.register(m.UTagHandler),e.handlers.register(h.DelTagHandler),e.handlers.register(f.AudioTagHandler),e.handlers.register(g.VideoTagHandler),e.handlers.register(v.CursorTagHandler),e.handlers.register(y.EnglishTagHandler),e.handlers.register(E.UserTagHandler),e.handlers.register(b.CodeTagHandler),e.handlers.register(_.FontTagHandler),e.handlers.register(w.AlignTagHandler),e.handlers.register(C.UploadTagHandler),e.handlers.register(I.LeftTagHandler),e.handlers.register(N.CenterTagHandler),e.handlers.register(S.RightTagHandler),e.handlers.register(T.TableTagHandler),e.handlers.register(x.TdTagHandler),e.handlers.register(k.ThTagHandler),e.handlers.register(P.TrTagHandler),e.handlers.register(U.TopicTagHandler),e.handlers.register(M.MdTagHandler),e.handlers.register(O.default),e.handlers.register(j.default),e.handlers.register(R.PmTagHandler),e.handlers.register(s.NoUbbTagHandler),e.handlers.register(L.BiliTagHandler),e.handlers.register(F.default),e.handlers.register(A.default),e.handlers.register(H.default),e.handlers.register(B.default),e.handlers.registerText(D.default),e.handlers.registerText(z.default),e},r.__exportStar(n(7),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.USER_LOG_ON="USER_LOG_ON",t.USER_LOG_OFF="USER_LOG_OFF",t.GET_USER_POSTS="GET_USER_POSTS",t.CHANGE_USERINFO="CHANGE_USERINFO",t.CHANGE_VISITING_USER="CHANGE_VISITING_USER",t.CHANGE_USER_FAVORITE_BOARDS="CHANGE_USER_FAVORITE_BOARDS",t.CHANGE_USER_FAVORITE_POSTS="CHANGE_USER_FAVORITE_POSTS",t.CHANGE_USER_FANS_INFO="CHANGE_USER_FANS_INFO",t.CHANGE_USER_FOLLOWINGS_INFO="CHANGE_USER_FOLLOWINGS_INFO",t.CHANGE_USER_RECENT_POSTS="CHANGE_USER_RECENT_POSTS",t.CHNAGE_USER_CENTER_PAGE="CHNAGE_USER_CENTER_PAGE",t.USER_NOT_FOUND="USER_NOT_FOUND",t.USER_CENTER_LOADING="USER_CENTER_LOADING",t.USER_CENTER_LOADED="USER_CENTER_LOADED",t.USER_CENTER_FETCH_ERROR="USER_CENTER_FETCH_ERROR",t.USER_CENTER_SOLVE_ERROR="USER_CENTER_SOLVE_ERROR",t.USER_CENTER_PAGE_LOAD_UNFINISH="USER_CENTER_PAGE_LOAD_UNFINISH",t.USER_CENTER_PAGE_LOAD_FINISH="USER_CENTER_PAGE_LOAD_FINISH",t.USER_CENTER_FOLLOW_USER="USER_CENTER_FOLLOW_USER",t.USER_CENTER_UNFOLLOW_USER="USER_CENTER_UNFOLLOW_USER",t.USER_CENTER_TRANSFER_WEALTH_SUCCESS="USER_CENTER_TRANSFER_WEALTH_SUCCESS",t.THROW_ERROR="THROW_ERROR",t.SOLVE_ERROR="SOLVE_ERROR",t.ADD_AWARD="ADD_AWARD"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(142),s=n(145),o=n(139),i=n(343),c=n(12),l=n(83),u=n(342),d=n(341),p=n(340);var m,h=r.__assign({},c,l),f=(m=h,Object.keys(m).map(function(e){return m[e]}),o.combineReducers({error:u.default,post:d.default,router:s.routerReducer,userInfo:p.default}));t.history=a.default();var g=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.compose;t.default=o.createStore(f,g(o.applyMiddleware(i.default,s.routerMiddleware(t.history))))},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e,t=this,n=[],r={backgroundColor:"#ccc",cursor:"default"};if(this.props.totalPage<=7){for(e=this.props.totalPage;e--;)n.unshift(e+1);n=n.map(function(e,n){return a.createElement("li",{key:""+t.props.href+e},a.createElement(s.Link,{to:""+t.props.href+e},a.createElement("button",{type:"button",disabled:e==t.props.currentPage,style:e==t.props.currentPage?r:{}},e)))})}else if(this.props.currentPage-1<=3){for(e=7;e--;)n.unshift(e+1);(n=n.map(function(e,n){return a.createElement("li",{key:""+t.props.href+e},a.createElement(s.Link,{to:""+t.props.href+e},a.createElement("button",{type:"button",disabled:e==t.props.currentPage,style:e==t.props.currentPage?r:{}},e)))})).push(a.createElement("li",{key:"after"},a.createElement("button",{disabled:!0},"···"))),n.push(a.createElement("li",{key:""+this.props.href+this.props.totalPage},a.createElement(s.Link,{to:""+this.props.href+this.props.totalPage},a.createElement("button",{type:"button"},this.props.totalPage))))}else if(this.props.totalPage-this.props.currentPage<=3){for(e=7;e--;)n.unshift(e-6+this.props.totalPage);(n=n.map(function(e,n){return a.createElement("li",{key:""+t.props.href+e},a.createElement(s.Link,{to:""+t.props.href+e},a.createElement("button",{type:"button",disabled:e==t.props.currentPage,style:e==t.props.currentPage?r:{}},e)))})).unshift(a.createElement("li",{key:"before"},a.createElement("button",{disabled:!0},"···"))),n.unshift(a.createElement("li",{key:this.props.href+"1"},a.createElement(s.Link,{to:this.props.href+"1"},a.createElement("button",{type:"button"},1))))}else{for(e=7;e--;)n.unshift(e-3+this.props.currentPage);(n=n.map(function(e,n){return a.createElement("li",{key:""+t.props.href+e},a.createElement(s.Link,{to:""+t.props.href+e},a.createElement("button",{type:"button",disabled:e==t.props.currentPage,style:e==t.props.currentPage?r:{}},e)))})).push(a.createElement("li",{key:"after"},a.createElement("button",{disabled:!0},"···"))),n.push(a.createElement("li",{key:""+this.props.href+this.props.totalPage},a.createElement(s.Link,{to:""+this.props.href+this.props.totalPage},a.createElement("button",{type:"button"},this.props.totalPage)))),n.unshift(a.createElement("li",{key:"before"},a.createElement("button",{disabled:!0},"···"))),n.unshift(a.createElement("li",{key:this.props.href+"1"},a.createElement(s.Link,{to:this.props.href+"1"},a.createElement("button",{type:"button"},1))))}return this.props.hasTotal||this.props.currentPage==this.props.totalPage||n.push(a.createElement("li",{key:"after"},a.createElement("button",{disabled:!0},"···"))),a.createElement("div",{id:"userCenterPageCount"},a.createElement("ul",null,n))},t}(a.Component);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"user-post"},a.createElement("div",{className:"user-post-info"},a.createElement(s.Link,{className:"user-post-board",to:"/list/"+this.props.userRecentPost.boardId},this.props.userRecentPost.boardName),a.createElement("a",{className:"user-post-date"},this.props.userRecentPost.time.slice(0,19).replace("T"," "))),a.createElement("div",{className:"user-post-content"},a.createElement("p",null,a.createElement(s.Link,{to:"/topic/"+this.props.userRecentPost.id},this.props.userRecentPost.title))))},t}(a.Component);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=function(e){function t(t,n){return e.call(this,t,n)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"match",{get:function(){return this.props.match},enumerable:!0,configurable:!0}),t}(n(0).Component);t.RouteComponent=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(69),s=n(70),o=n(74),i=n(12);function c(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,s,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return(e=a.getLocalStorage("refresh_token"))?(t=a.getLocalStorage("accessToken"))?[2,t]:(n="https://openid1.cc98.vaynetian.com/connect/token",s={client_id:"9a1fd200-8687-44b1-4c20-08d50a96e5cd",client_secret:"8b53f727-08e2-4509-8857-e34bf92b27f2",grant_type:"refresh_token",refresh_token:e},(c=new Headers).append("Content-Type","application/x-www-form-urlencoded"),[4,fetch(n,{method:"POST",headers:c,body:Object.keys(s).map(function(e){return e+"="+s[e]}).join("&")})]):[2,null];case 1:return[4,r.sent().json()];case 2:return(l=r.sent()).access_token?(t="Bearer "+encodeURIComponent(l.access_token),a.setLocalStorage("accessToken",t,l.expires_in),[2,t]):(a.removeLocalStorage("userInfo"),a.removeLocalStorage("accessToken"),a.removeLocalStorage("refresh_token"),o.default.dispatch(i.userLogOff()),o.history.push("/logon"),[2])}})})}t.getToken=c,t.formAuthorizeHeader=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,c()];case 1:return e=n.sent(),(t=new Headers).append("Authorization",e),[2,t]}})})},t.cc98Fetch=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,o;return r.__generator(this,function(r){switch(r.label){case 0:return n=s.Constants.config.apiUrl,a=""+n+e,t?[4,fetch(a,t)]:[3,2];case 1:return o=r.sent(),[3,4];case 2:return[4,fetch(a)];case 3:o=r.sent(),r.label=4;case 4:return[2,o]}})})}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(73),a=n(158);t.throwError=a.createAction(r.THROW_ERROR,function(e){return{type:r.THROW_ERROR,payload:{message:e}}}),t.solveError=a.createAction(r.SOLVE_ERROR)},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"noticeSuccess displaynone",id:this.props.id,style:{position:"fixed",top:this.props.top,left:this.props.left}},this.props.text)},t}(a.Component);t.NoticeMessage=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(1).__exportStar(n(284),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(){}}();t.AppState=r;var a=function(){return function(){}}();t.TopicVoteState=a;var s=function(){return function(){}}();t.PostTopicState=s;var o=function(){return function(){}}();t.AuthorMessageState=o;var i=function(){return function(){}}();t.TopicTitleState=i;var c=function(){return function(){}}();t.ContentState=c;var l=function(){return function(){}}();t.TopicGoodState=l;var u=function(){return function(){}}();t.ReplierState=u;var d=function(){return function(){}}();t.ListHeadState=d;var p=function(){return function(){}}();t.ListNoticeState=p;var m=function(){return function(){}}();t.ListTagState=m;var h=function(){return function(){}}();t.ListContentState=h;var f=function(){return function(){}}();t.TopicTitleAndContentState=f;var g=function(){return function(){}}();t.ListPagerState=g;var v=function(){return function(e){this.pageNumber=e}}();t.PagerState=v;var y=function(){return function(e,t,n,r,a,s,o,i,c,l,u,d,p,m,h,f){this.userName=e,this.time=r,this.title=t,this.content=n,this.signature=a,this.userImgUrl=s,this.userId=o,this.likeNumber=i,this.dislikeNumber=c,this.postId=l,this.isAnonymous=u,this.contentType=d,this.isFollowing=p,this.fanCount=m,this.likeInfo=h,this.awardInfo=f}}();t.TopicState=y;var E=function(){return function(){}}();t.LoginState=E;var b=function(){return function(){}}();t.AlreadyLoginState=b;var _=function(){return function(e,t,n,r,a){this.name=e,this.todayPostCount=t,this.totalPostCount=n,this.id=r,this.masters=a}}();t.Board=_;var w=function(){return function(){}}();t.BoardState=w;var C=function(){return function(){}}();t.UserInfo=C;var I=function(){return function(){}}();t.UserRecentPost=I;var N=function(){return function(){}}();t.UserFavoritesBoardInfo=N;var S=function(){return function(){}}();t.ChangeUserInfo=S;var T=function(){return function(){}}();t.TransferWealthInfo=T;var x=function(){return function(){}}();t.BoardMasterTitle=x},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(22),i=n(6),c=n(16),l=n(290),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"announcement"},a.createElement("div",{className:"mainPageTitle1"},a.createElement("div",{className:"mainPageTitleRow",style:{width:"100%"}},a.createElement("i",{className:"fa fa-volume-up"}),a.createElement("div",{style:{flexGrow:1},className:"mainPageTitleText"},"全站公告"),a.createElement(l.CountDown,{endDate:new Date("05/26/2018 05:30 PM")}))),a.createElement("div",{className:"announcementContent"},a.createElement(o.UbbContainer,{code:this.props.data})))},t}(a.Component);t.AnnouncementComponent=u;var d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={index:Math.floor(5*Math.random())},n.handleMouseEnter=n.handleMouseEnter.bind(n),n.convertButton=n.convertButton.bind(n),n}return r.__extends(t,e),t.prototype.handleMouseEnter=function(e){this.setState({index:e})},t.prototype.convertButton=function(e,t,n){var r=this,s=e?"recommendedReadingButtonSelected":"recommendedReadingButton";return a.createElement("div",{className:s,onMouseEnter:function(){r.handleMouseEnter(t)}})},t.prototype.render=function(){var e=this.props.data,t=this.state.index,n=new Array(0,0,0,0,0);n[t]=1;var r=n.map(this.convertButton),s="",o="",i="",c="";return e&&(s=e.length?e[t].imageUrl:"",i=e.length?e[t].title:"",o=e.length?e[t].url:"",c=e.length?e[t].content:""),a.createElement("div",{className:"recommendedReading"},a.createElement("div",{className:"mainPageTitle2"},a.createElement("div",{className:"mainPageTitleRow"},a.createElement("i",{className:"fa fa-volume-up"}),a.createElement("div",{className:"mainPageTitleText"},"推荐阅读"))),a.createElement("div",{className:"recommendedReadingContent"},a.createElement("div",{className:"recommendedReadingImage"},a.createElement("img",{src:s})),a.createElement("div",{className:"column",style:{flexGrow:1}},a.createElement("div",{className:"recommendedReadingTitle"},a.createElement("a",{href:o,target:"_blank"},i)),a.createElement("div",{className:"recommendedReadingAbstract"},c),a.createElement("div",{className:"recommendedReadingButtons"},r))))},t}(a.Component);t.RecommendedReadingComponent=d;var p=function(){return function(e,t,n,r){this.title=e,this.id=t,this.boardName=n,this.boardId=r}}();t.HotTopicState=p;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.convertMainPageTopic=function(e){var t="/list/"+e.boardId,n="/topic/"+e.id+"/1";return a.createElement("div",{className:"mainPageListRow"},a.createElement("div",{className:"mainPageListBoardName"}," ",a.createElement("a",{href:t,target:"_blank"},"[",e.boardName,"]")),a.createElement("div",{className:"mainPageListTitle"},a.createElement("a",{href:n,target:"_blank"},e.title)))},t.prototype.render=function(){var e=this.props.data;return e?s.setLocalStorage("mainPageHotTopic",e):e=s.getLocalStorage("mainPageHotTopic"),a.createElement("div",{className:"mainPageList"},a.createElement("div",{className:"mainPageTitle1"},a.createElement("div",{className:"mainPageTitleRow"},a.createElement("i",{className:"fa fa-volume-up"}),a.createElement("div",{className:"mainPageTitleText"},"热门话题")),a.createElement("div",{className:"mainPageTitleRow"},a.createElement("div",{className:"mainPageTitleText"},a.createElement("a",{href:"/topic/hot-weekly",target:"_blank"},"本周")),a.createElement("div",{className:"mainPageTitleText"},a.createElement("a",{href:"/topic/hot-monthly",target:"_blank"},"本月")),a.createElement("div",{className:"mainPageTitleText"},a.createElement("a",{href:"/topic/hot-history",target:"_blank"},"历史上的今天")))),a.createElement("div",{className:"mainPageListContent1"},e.map(this.convertMainPageTopic)))},t}(a.Component);t.HotTopicComponent=m;var h=function(){return function(e,t){this.title=e,this.id=t}}();t.MainPageTopicState=h;var f=function(){return function(e,t){this.name=e,this.url=t}}();t.MainPageTopicMoreProps=f;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.convertMainPageTopic=function(e){var t="/topic/"+e.id+"/1";return a.createElement("div",{className:"mainPageListRow"},a.createElement("div",{className:"mainPageListTitle"},a.createElement("a",{href:t,target:"_blank"},e.title)))},t.prototype.render=function(){var e=this.props.mores.map(function(e){return a.createElement("div",{className:"mainPageTitleText"},a.createElement("a",{href:e.url,target:"_blank"},e.name))}),t=this.props.style;return"black"===t?a.createElement("div",{className:"mainPageList"},a.createElement("div",{className:"mainPageTitle2"},a.createElement("div",{className:"mainPageTitleRow"},a.createElement("i",{className:"fa fa-volume-up"}),a.createElement("div",{className:"mainPageTitleText"},this.props.name)),a.createElement("div",{className:"mainPageTitleRow"},e)),a.createElement("div",{className:"mainPageListContent2"},this.props.data.map(this.convertMainPageTopic))):"blue"===t?a.createElement("div",{className:"mainPageList"},a.createElement("div",{className:"mainPageTitle1"},a.createElement("div",{className:"mainPageTitleRow"},a.createElement("i",{className:"fa fa-volume-up"}),a.createElement("div",{className:"mainPageTitleText"},this.props.name)),a.createElement("div",{className:"mainPageTitleRow"},e)),a.createElement("div",{className:"mainPageListContent1"},this.props.data.map(this.convertMainPageTopic))):void 0},t}(a.Component);t.MainPageTopicComponent=g;var v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={testContent:""},n.handleChange=n.handleChange.bind(n),n.urlTextHanderler=n.urlTextHanderler.bind(n),n}return r.__extends(t,e),t.prototype.handleChange=function(e){this.setState({testContent:e.target.value})},t.prototype.urlTextHanderler=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,s,o,i;return r.__generator(this,function(r){return e=/[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+/gim,t=/cc98\.org/i,n=/zju\.edu\.cn/i,a=/nexushd\.org/i,s=this.state.testContent,(o=s.match(e))&&(i=o[0],t.test(i)||n.test(i)||a.test(i)),[2]})})},t.prototype.postAd=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o;return r.__generator(this,function(r){switch(r.label){case 0:return e="/index/column/24",t={type:4,title:"一个图片不一样的广告",url:"www.cc98.org",imageUrl:"/images/推荐功能.jpg",enable:!0,days:10},n=JSON.stringify(t),a=s.getLocalStorage("accessToken"),(o=new Headers).append("Authorization",a),o.append("Content-Type","application/json"),[4,s.cc98Fetch(e,{method:"PUT",headers:o,body:n})];case 1:return r.sent(),[2]}})})},t.prototype.signIn=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return e="/me/signin",t=s.getLocalStorage("accessToken"),(n=new Headers).append("Authorization",t),n.append("Content-Type","application/json"),n.append("Content-Type","application/json"),a="日常",[4,s.cc98Fetch(e,{method:"POST",headers:n,body:a})];case 1:return r.sent(),[2]}})})},t.prototype.render=function(){return a.createElement("div",{className:"mainPageList"},a.createElement("div",{className:"mainPageTitle2"},a.createElement("div",{className:"mainPageTitleRow"},a.createElement("i",{className:"fa fa-volume-up"}),a.createElement("div",{className:"mainPageTitleText"},"测试区"))),a.createElement("div",{className:"mainPageListContent2"},a.createElement("div",null,"这里是可爱的adddna测试的地方~"),a.createElement("input",{name:"testContent",type:"text",id:"loginName",onChange:this.handleChange,value:this.state.testContent}),a.createElement("div",null,"封印封印")))},t}(a.Component);t.Test=v;var y=function(){return function(e,t,n,r){this.imageUrl=e,this.title=t,this.url=n,this.content=r}}();t.MainPageColumn=y;var E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.convertRecommendedFunction=function(e){return a.createElement("div",{className:"recommendedFunctionRow"},a.createElement("div",{className:"recommendedFunctionImage"},a.createElement("img",{src:e.imageUrl})),a.createElement("div",{className:"recommendedFunctionTitle"},a.createElement("a",{href:e.url,target:"_blank"},e.title)))},t.prototype.render=function(){return a.createElement("div",{className:"recommendedFunction"},a.createElement("div",{className:"mainPageTitle1"},a.createElement("div",{className:"mainPageTitleRow"},a.createElement("i",{className:"fa fa-volume-up"}),a.createElement("div",{className:"mainPageTitleText"},"推荐功能"))),a.createElement("div",{className:"recommendedFunctionContent"},this.props.data.map(this.convertRecommendedFunction)))},t}(a.Component);t.RecommendedFunctionComponent=E;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.convertSchoolNews=function(e){return a.createElement("div",{className:"schoolNewsRow"},a.createElement("div",{className:"schoolNewsTitle"},a.createElement("a",{href:e.url,target:"_blank"},e.title)))},t.prototype.render=function(){return a.createElement("div",{className:"schoolNews"},a.createElement("div",{className:"mainPageTitle2"},a.createElement("div",{className:"mainPageTitleRow"},a.createElement("i",{className:"fa fa-volume-up"}),a.createElement("div",{className:"mainPageTitleText"},"校园新闻"))),a.createElement("div",{className:"schoolNewsContent"},this.props.data.map(this.convertSchoolNews)))},t}(a.Component);t.SchoolNewsComponent=b;var _=function(e){function t(t){var n=e.call(this,t)||this,r=s.getStorage("mainAds");return r||(r=new Array),n.state={ads:r,index:0},n.changeIndex=n.changeIndex.bind(n),n}return r.__extends(t,e),t.prototype.getAds=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n;return r.__generator(this,function(r){switch(r.label){case 0:return(e=s.getStorage("mainAds"))?[2,e]:[3,1];case 1:return e=new Array,[4,s.cc98Fetch("/config/global/advertisement")];case 2:return[4,r.sent().json()];case 3:for(t=r.sent(),n=0;n<t.length;n++)e[n]=new y(t[n].imageUrl,t[n].title,t[n].url,t[n].content);return s.setStorage("mainAds",e),[2,e]}})})},t.prototype.componentWillMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,this.getAds()];case 1:return e=n.sent(),t=e.length,this.setState({ads:e,index:Math.floor(Math.random()*t)}),[2]}})})},t.prototype.componentDidMount=function(){var e=this;this.timer=setInterval(function(){e.changeIndex(e.state.index)},3e4)},t.prototype.componentWillUnmount=function(){clearInterval(this.timer)},t.prototype.changeIndex=function(e){var t=e+1;t>=this.state.ads.length&&(t=0),this.setState({index:t})},t.prototype.render=function(){var e=this.state.ads,t=this.state.index,n=e.length?e[t].url:"",r=e.length?e[t].imageUrl:"";return a.createElement("div",null,a.createElement("a",{href:n,target:"_blank"},a.createElement("img",{src:r,style:{width:"18.75rem",height:"6.25rem"}})))},t}(a.Component);t.AdsComponent=_;var w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.data;return a.createElement("div",{className:"mainPageCount"},a.createElement("div",{className:"mainPageTitle2"},a.createElement("div",{className:"mainPageTitleRow"},a.createElement("i",{className:"fa fa-volume-up"}),a.createElement("div",{className:"mainPageTitleText"},"论坛统计"))),a.createElement("div",{className:"mainPageCountContent",style:{height:"10rem"}},a.createElement("div",{className:"mainPageCountRow"},a.createElement("div",{className:"mainPageCountTitle"},"今日帖数"),a.createElement("div",{className:"mainPageCountTitle"},e.todayCount)),a.createElement("div",{className:"mainPageCountRow"},a.createElement("div",{className:"mainPageCountTitle"},"论坛总主题数"),a.createElement("div",{className:"mainPageCountTitle"},e.topicCount)),a.createElement("div",{className:"mainPageCountRow"},a.createElement("div",{className:"mainPageCountTitle"},"论坛总回复数"),a.createElement("div",{className:"mainPageCountTitle"},e.postCount)),a.createElement("div",{className:"mainPageCountRow"},a.createElement("div",{className:"mainPageCountTitle"},"总用户数"),a.createElement("div",{className:"mainPageCountTitle"},e.userCount)),a.createElement("div",{className:"mainPageCountRow"},a.createElement("div",{className:"mainPageCountTitle"},"欢迎新用户"),a.createElement("div",{className:"mainPageCountTitle"},a.createElement(i.Link,{to:"/user/name/"+encodeURIComponent(e.lastUserName)},e.lastUserName)))))},t}(a.Component);t.MainPageCountComponent=w;var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",null)},t}(a.Component);t.RecommendedBoardComponent=C;var I=function(){return function(e,t,n,r,a){this.todayCount=e,this.topicCount=t,this.postCount=n,this.userCount=r,this.lastUserName=a}}();t.MainPageCountProps=I;var N=function(e){function t(t){var n=e.call(this,t)||this;return n.state={data:{academics:[],announcement:"",emotion:[],fleaMarket:[],fullTimeJob:[],hotTopic:[],lastUserName:"",partTimeJob:[],postCount:0,recommendationFunction:[],recommendationReading:[],schoolEvent:[],schoolNews:[],study:[],todayCount:0,topicCount:0,userCount:0}},n}return r.__extends(t,e),t.prototype.getData=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return s.refreshHoverUnReadCount(),(e=s.getLocalStorage("mainPageData"))?[3,3]:[4,s.cc98Fetch("/config/index")];case 1:return[4,t.sent().json()];case 2:return e=t.sent(),e.hotTopic&&s.setLocalStorage("mainPageData",e,60),[2,e];case 3:return[2,e]}})})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,this.getData()];case 1:return e=t.sent(),this.setState({data:e}),[2]}})})},t.prototype.render=function(){var e=this.state.data,t=new Array({name:"学习",url:"/list/68"},{name:"外语",url:"/list/304"},{name:"考研",url:"/list/263"},{name:"出国",url:"/list/102"}),n=new Array({name:"缘分",url:"/list/152"},{name:"小屋",url:"/list/114"},{name:"感性",url:"/list/81"}),r=new Array({name:"数码",url:"/list/562"},{name:"生活",url:"/list/80"},{name:"服饰",url:"/list/563"}),s=new Array({name:"更多",url:"/list/235"}),o=new Array({name:"更多",url:"/list/459"}),i=new I(e.todayCount,e.topicCount,e.postCount,e.userCount,e.lastUserName);return a.createElement("div",{className:"mainPage"},a.createElement(c.default,{title:"CC98论坛"}),a.createElement("div",{className:"leftPart"},a.createElement(u,{data:e.announcement}),a.createElement(d,{data:e.recommendationReading}),a.createElement("div",{className:"row",style:{justifyContent:"space-between"}},a.createElement(m,{data:e.hotTopic}),a.createElement(g,{data:e.schoolEvent,name:"校园活动",fetchUrl:"/topic/school-event",style:"blue",mores:[]})),a.createElement("div",{className:"row",style:{justifyContent:"space-between"}},a.createElement(g,{data:e.academics,name:"学术信息",fetchUrl:"/topic/academics",style:"black",mores:[]}),a.createElement(g,{data:e.study,name:"学习园地",fetchUrl:"/topic/study",style:"black",mores:t})),a.createElement("div",{className:"row",style:{justifyContent:"space-between"}},a.createElement(g,{data:e.emotion,name:"感性·情感",fetchUrl:"/topic/emotion",style:"blue",mores:n}),a.createElement(g,{data:e.fleaMarket,name:"跳蚤市场",fetchUrl:"/topic/flea-market",style:"blue",mores:r})),a.createElement("div",{className:"row",style:{justifyContent:"space-between"}},a.createElement(g,{data:e.fullTimeJob,name:"求职广场",fetchUrl:"/topic/full-time-job",style:"black",mores:s}),a.createElement(g,{data:e.partTimeJob,name:"实习兼职",fetchUrl:"/topic/part-time-job",style:"black",mores:o}))),a.createElement("div",{className:"rightPart"},a.createElement(E,{data:e.recommendationFunction}),a.createElement(b,{data:e.schoolNews}),a.createElement(_,null),a.createElement(w,{data:i})))},t}(a.Component);t.MainPage=N},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(66),o=n(4),i=function(e){function t(t){var n=e.call(this,t)||this,r=o.getStorage("focusBoard_"+n.props.id);return r||(r=[]),n.state={data:r,from:0,loading:!0,buttonClassName:""},n.handleScroll=n.handleScroll.bind(n),n}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){return this.getData(e),[2]})})},t.prototype.scrollToTop=function(){$("body,html").animate({scrollTop:0},500)},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return this.getData(this.props),[2]})})},t.prototype.getData=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,o.getFocusTopic(e.id,e.name,0,this.context.router)];case 1:return(t=n.sent())&&(this.setState({data:t,from:t.length}),o.setStorage("focusBoard_"+e.id,t)),document.addEventListener("scroll",this.handleScroll),[2]}})})},t.prototype.componentWillUnmount=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return document.removeEventListener("scroll",this.handleScroll),[2]})})},t.prototype.handleScroll=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n;return r.__generator(this,function(r){switch(r.label){case 0:if(window.pageYOffset>234&&this.setState({buttonClassName:"btn-show"}),window.pageYOffset<234&&this.setState(function(e){return{buttonClassName:""===e.buttonClassName?"":"btn-disappare"}}),!o.isBottom()||!this.state.loading)return[3,5];if(this.state.from>99)return $("#focus-topic-loading").addClass("displaynone"),$("#focus-topic-loaddone").removeClass("displaynone"),[2];this.setState({loading:!1}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,o.getFocusTopic(this.props.id,this.props.name,this.state.from,this.context.router)];case 2:return e=r.sent(),[3,4];case 3:return r.sent(),this.setState({loading:!0}),[2];case 4:if(e&&e.length>0){for(t=this.state.data,n=0;n<t.length&&t[n].id!==e[0].id;n++);t=t.slice(0,n).concat(e),this.setState({data:t,from:t.length,loading:!0}),o.setStorage("focusBoard_"+this.props.id,t)}return this.setState({loading:!0}),[2];case 5:return[2]}})})},t.prototype.render=function(){return a.createElement("div",{className:"focus-topic-area"},a.createElement("div",{className:"focus-topic-topicArea"},this.state.data.map(c)),a.createElement("div",{className:"focus-topic-loading",id:"focus-topic-loading"},a.createElement("i",{style:{marginTop:"1rem"},className:"fa fa-spinner fa-pulse fa-5x fa-fw"})),a.createElement("div",{className:"focus-topic-loaddone displaynone",id:"focus-topic-loaddone"},"无法加载更多了，小水怡情，可不要沉迷哦~"),a.createElement("button",{type:"button",id:"scrollToTop",className:this.state.buttonClassName,onClick:this.scrollToTop},"回到顶部"))},t}(a.Component);function c(e){return a.createElement(s.FocusTopicSingle,{title:e.title,hitCount:e.hitCount,id:e.id,boardId:e.boardId,boardName:e.boardName,replyCount:e.replyCount,userId:e.userId,userName:e.userName,portraitUrl:e.portraitUrl,time:e.time,likeCount:e.likeCount,dislikeCount:e.dislikeCount,lastPostUser:e.lastPostUser,lastPostTime:e.lastPostTime,tag1:e.tag1,tag2:e.tag2,floorCount:e.floorCount})}t.FocusTopicArea=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(6),i=n(15),c=n(12),l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={buttonInfo:n.props.userFanInfo.isFollowing?"已关注":"关注",buttonIsDisabled:!1,isFollowing:n.props.userFanInfo.isFollowing},n.unfollow=n.unfollow.bind(n),n.follow=n.follow.bind(n),n}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){e.userFanInfo.id!==this.props.userFanInfo.id&&this.setState({buttonInfo:e.userFanInfo.isFollowing?"已关注":"关注",buttonIsDisabled:!1,isFollowing:e.userFanInfo.isFollowing})},t.prototype.unfollow=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return this.setState({buttonIsDisabled:!0,buttonInfo:"取关中"}),s.unfollowUser(this.props.userFanInfo.id)?(this.setState({buttonIsDisabled:!1,buttonInfo:"重新关注",isFollowing:!1}),this.props.unfollow(this.props.userFanInfo.id)):this.setState({buttonIsDisabled:!1,buttonInfo:"取关失败",isFollowing:!0}),[2]})})},t.prototype.follow=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return this.setState({buttonIsDisabled:!0,buttonInfo:"关注中"}),[4,s.followUser(this.props.userFanInfo.id)];case 1:return!0===(e=t.sent())?(this.setState({buttonIsDisabled:!1,buttonInfo:"已关注",isFollowing:!0}),this.props.follow(this.props.userFanInfo.id)):"follow_count_limited"===e?this.setState({buttonIsDisabled:!1,buttonInfo:"已达上限",isFollowing:!1}):this.setState({buttonIsDisabled:!1,buttonInfo:"关注失败",isFollowing:!1}),[2]}})})},t.prototype.render=function(){var e=this;return a.createElement("div",{className:"user-center-myfollowings-user"},a.createElement("img",{src:this.props.userFanInfo.portraitUrl}),a.createElement("p",null,a.createElement("span",{className:"user-center-myfollowings-user-id"},a.createElement(o.Link,{to:"/user/id/"+this.props.userFanInfo.id},this.props.userFanInfo.name)),"主题",a.createElement("span",{className:"user-center-myfollowings-user-posts"},this.props.userFanInfo.postCount),"粉丝",a.createElement("span",{className:"user-center-myfollowings-user-fans"},this.props.userFanInfo.fanCount)),a.createElement("button",{key:this.props.userFanInfo.id,type:"button",className:this.state.isFollowing?"":"user-follow",onMouseOver:function(){e.state.isFollowing&&!e.state.buttonIsDisabled&&e.setState({buttonInfo:"取消关注"})},onMouseLeave:function(){e.state.isFollowing&&!e.state.buttonIsDisabled&&e.setState({buttonInfo:"已关注"})},onClick:this.state.isFollowing?this.unfollow:this.follow,disabled:this.state.buttonIsDisabled},this.state.buttonInfo),a.createElement(o.Link,{to:"/message/message?id="+this.props.userFanInfo.id},a.createElement("button",{className:"user-message",type:"button"},"私信")))},t}(a.Component);t.default=i.connect(function(e,t){return{userFanInfo:t.userFanInfo}},function(e){return{follow:function(t){e(c.followUser(t))},unfollow:function(t){e(c.unfollowUser(t))}}})(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"user-avatar"},a.createElement("img",{className:"user-avatar-img",src:this.props.userInfo.portraitUrl}),a.createElement("div",{className:"user-badge"},this.props.userInfo.boardMasterTitles.map(function(e){return 10===e.boardMasterLevel?a.createElement("p",{key:e.boardId}," ",a.createElement(s.Link,{to:"/boardList#"+e.boardName},e.boardName),a.createElement("span",{style:{color:"red"}},e.title)):a.createElement("p",{key:e.boardId}," ",a.createElement(s.Link,{to:"/list/"+e.boardId},e.boardName),a.createElement("span",null,e.title))})))},t}(a.Component);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(6),i=n(108),c=function(e){function t(t){var n=e.call(this,t)||this;return n.follow=n.follow.bind(n),n.unFollow=n.unFollow.bind(n),n.state={tag1Name:"",tag2Name:"",isFollow:n.props.isFav},n}return r.__extends(t,e),t.prototype.showAllImg=function(){var e=document.getElementsByClassName("hiddenImage");for(var t in e){e[t].click()}},t.prototype.follow=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,s.setFavoriteTopic(this.props.topicInfo.id)];case 1:return e.sent(),this.setState({isFollow:!0}),[2]}})})},t.prototype.unFollow=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,s.deleteFavoriteTopic(this.props.topicInfo.id)];case 1:return e.sent(),this.setState({isFollow:!1}),[2]}})})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return e="",t="",this.props.tag1?[4,s.getTagNamebyId(this.props.tag1)]:[3,2];case 1:e=n.sent(),n.label=2;case 2:return this.props.tag2?[4,s.getTagNamebyId(this.props.tag2)]:[3,4];case 3:t=n.sent(),n.label=4;case 4:return this.setState({tag1Name:e,tag2Name:t}),[2]}})})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t="",n="",e.tag1?[4,s.getTagNamebyId(e.tag1)]:[3,2];case 1:t=r.sent(),r.label=2;case 2:return e.tag2?[4,s.getTagNamebyId(e.tag2)]:[3,4];case 3:n=r.sent(),r.label=4;case 4:return this.setState({tag1Name:t,tag2Name:n}),[2]}})})},t.prototype.onError=function(e){e.preventDefault(),e.target.src="/static/images/_CC98协会.png"},t.prototype.render=function(){this.props.boardInfo.name;var e="/list/"+this.props.boardInfo.id,t=null;return(this.props.tag1||this.props.tag2)&&(t=a.createElement("div",{id:"tags"},a.createElement("div",{className:"tagProp tagSize"},"标签： ",this.state.tag1Name," ",this.state.tag2Name),a.createElement("div",{className:"tagProp"}))),a.createElement("div",{className:"topicInfo-info"},a.createElement("div",{className:"topicInfo-title"},a.createElement("div",{className:"column",id:"topicTitleProp"},a.createElement("div",{id:"essay1",className:"row"},this.props.topicInfo.title),a.createElement("div",{className:"row",id:"essayProp"},t,a.createElement("div",{id:"time"},a.createElement("div",{className:"viewProp"},a.createElement("i",{className:"fa fa-clock-o fa-lg fa-fw"}))," ",a.createElement("div",{className:"timeProp tagSize"},moment(this.props.topicInfo.time).format("YYYY-MM-DD HH:mm:ss"))),a.createElement("div",{id:"viewtimes"},a.createElement("div",{className:"viewProp"},a.createElement("i",{className:"fa fa-eye fa-lg fa-fw"}),"  ")," ",a.createElement("div",{className:"timeProp tagSize"},this.props.topicInfo.hitCount)),a.createElement("div",{className:"followTopic",onClick:this.state.isFollow?this.unFollow:this.follow},this.state.isFollow?"已收藏":"收藏"),a.createElement("div",{className:"followTopic",style:{width:"5rem"},onClick:this.showAllImg},"显示所有图片"))),a.createElement("div",{className:"topicInfo-boardMessage"},a.createElement(o.Link,{to:e},a.createElement("div",{style:{color:"#6b7178"}},this.props.boardInfo.name)),a.createElement("div",{style:{marginTop:"0.5rem",fontSize:"0.75rem"}},this.props.boardInfo.todayCount," / ",this.props.boardInfo.topicCount))),a.createElement("div",{className:"topicInfo-ads"},a.createElement(i.AdsComponent,null)))},t}(a.Component);t.TopicInfo=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(34),i=n(278),c=n(277),l=n(276),u=n(274),d=n(273),p=n(272),m=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.update=r.update.bind(r),r.quote=r.quote.bind(r),r.state={inWaiting:!0,contents:[],masters:[],boardName:"",m_wealth:2e4,d_wealth:0},r}return r.__extends(t,e),t.prototype.quote=function(e,t,n,r,a){this.props.quote(e,t,n,r,a)},t.prototype.update=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o;return r.__generator(this,function(r){switch(r.label){case 0:return e=this.props.page||1,this.props.isHot?[4,s.getHotReplyContent(this.props.topicId)]:[3,2];case 1:return t=r.sent(),[3,7];case 2:return this.props.isTrace?[4,s.getUserInfo(this.props.postId)]:[3,5];case 3:return n=r.sent(),a=n.name,[4,s.getCurUserTopicContent(this.props.topicId,e,a,this.props.postId)];case 4:return t=r.sent(),[3,7];case 5:return[4,s.getTopicContent(this.props.topicId,e)];case 6:t=r.sent(),r.label=7;case 7:return o={rewardMaxValue:0,rewardTotalValue:0,boardName:this.props.boardInfo.name},s.isMaster(this.props.boardInfo.boardMasters)?[4,s.queryWealth(this.props.boardInfo.id)]:[3,9];case 8:o=r.sent(),r.label=9;case 9:return this.setState({m_wealth:o.rewardMaxValue,d_wealth:o.rewardTotalValue,boardName:o.boardName,contents:t}),[2]}})})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return e=this.props.page||1,this.props.isHot?[4,s.getHotReplyContent(this.props.topicId)]:[3,2];case 1:return(t=r.sent())||this.setState({inWaiting:!1,contents:[]}),[3,10];case 2:return this.props.isTrace?[3,4]:[4,s.getTopicContent(this.props.topicId,e)];case 3:return(t=r.sent())||this.setState({inWaiting:!1,contents:[]}),[3,10];case 4:return[4,s.getPostInfo(this.props.postId)];case 5:return n=r.sent(),(a=n.userId)>0?[4,s.getUserInfo(a)]:[3,8];case 6:return o=r.sent(),i=o.name,[4,s.getCurUserTopicContent(this.props.topicId,e,i,a)];case 7:return t=r.sent(),[3,10];case 8:return[4,s.getAnonymousTraceTopics(this.props.topicId,this.props.postId,e)];case 9:t=r.sent(),r.label=10;case 10:return c=this.props.boardInfo.boardMasters,l={rewardMaxValue:2e4,rewardTotalValue:0,boardName:this.props.boardInfo.name},this.setState({m_wealth:l.rewardMaxValue,d_wealth:l.rewardTotalValue,boardName:l.boardName,inWaiting:!1,contents:t,masters:c}),[2]}})})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,o,i,c,l,u;return r.__generator(this,function(r){switch(r.label){case 0:return e.page===this.props.page&&e.topicInfo.replyCount===this.props.topicInfo.replyCount?[3,14]:(this.setState({inWaiting:!0}),t=e.page||1,n=void 0,e.isHot?[4,s.getHotReplyContent(e.topicId)]:[3,2]);case 1:return(n=r.sent())||this.setState({inWaiting:!1,contents:[]}),[3,11];case 2:return e.isTrace?[4,s.getPostInfo(e.postId)]:[3,9];case 3:return a=r.sent(),(o=a.userId)>0?[4,s.getUserInfo(o)]:[3,6];case 4:return i=r.sent(),c=i.name,[4,s.getCurUserTopicContent(e.topicId,t,c,o)];case 5:return n=r.sent(),[3,8];case 6:return[4,s.getAnonymousTraceTopics(e.topicId,e.postId,t)];case 7:n=r.sent(),r.label=8;case 8:return[3,11];case 9:return[4,s.getTopicContent(e.topicId,t)];case 10:(n=r.sent())||this.setState({inWaiting:!1,contents:[]}),r.label=11;case 11:return l=e.boardInfo.boardMasters,u={rewardMaxValue:0,rewardTotalValue:0,boardName:this.props.boardInfo.name},s.isMaster(l)?[4,s.queryWealth(this.props.boardInfo.id)]:[3,13];case 12:u=r.sent(),r.label=13;case 13:this.setState({m_wealth:u.rewardMaxValue,d_wealth:u.rewardTotalValue,inWaiting:!1,contents:n,masters:l}),r.label=14;case 14:return[2]}})})},t.prototype.generateContents=function(e){var n=null;s.getLocalStorage("userInfo")&&(n=s.getLocalStorage("userInfo").privilege);var r=e.floor%10,o={likeCount:e.likeCount,dislikeCount:e.dislikeCount,likeState:e.likeState},m=null,f=a.createElement(l.Award,{postId:e.postId,updateTime:Date.now(),awardInfo:e.awards});if(e.awards&&0!==e.awards.length||(f=null),1!==e.floor||this.props.isTrace){var g=r.toString();return this.props.isHot&&(g="hot_"+r),a.createElement("div",{className:"reply",id:g},a.createElement(i.Replier,{key:e.postId,topicInfo:this.props.topicInfo,userInfo:e.userInfo,traceMode:!!this.props.isTrace,isHot:!!this.props.isHot}),a.createElement("div",{className:"column",style:{justifyContent:"space-between",width:"55.5rem",position:"relative"}},a.createElement(d.Judge,{userId:e.userId,postId:e.postId,update:this.update,topicId:e.topicId}),a.createElement(u.PostManagement,{m_wealth:this.state.m_wealth,d_wealth:this.state.d_wealth,boardName:this.state.boardName,topicId:e.topicId,postId:e.postId,userId:e.userId,update:this.update,privilege:n,boardId:this.props.boardInfo.id,floor:e.floor}),a.createElement(c.ReplyContent,{key:e.content,postId:e.postId,content:e.content,contentType:e.contentType}),f,a.createElement(p.ReplierSignature,{userInfo:e.userInfo,quote:this.quote,boardInfo:this.props.boardInfo,postInfo:e,likeInfo:o,traceMode:!!this.props.isTrace,topicInfo:this.props.topicInfo})),a.createElement(h,{isHot:this.props.isHot,floor:e.floor}))}return m=a.createElement(t,{topicInfo:this.props.topicInfo,page:this.props.page,boardInfo:this.props.boardInfo,quote:this.quote,isTrace:!1,isHot:!0,postId:null,topicId:this.props.topicId}),a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%"}},a.createElement("div",{className:"reply",id:r.toString()},a.createElement(i.Replier,{key:e.postId,topicInfo:this.props.topicInfo,userInfo:e.userInfo,traceMode:!!this.props.isTrace,isHot:!!this.props.isHot}),a.createElement("div",{className:"column",style:{justifyContent:"space-between",width:"55.5rem",position:"relative"}},a.createElement(d.Judge,{userId:e.userId,postId:e.postId,update:this.update,topicId:e.topicId}),a.createElement(u.PostManagement,{m_wealth:this.state.m_wealth,d_wealth:this.state.d_wealth,boardName:this.state.boardName,topicId:e.topicId,postId:e.postId,userId:e.userId,update:this.update,privilege:n,boardId:this.props.boardInfo.id,floor:e.floor}),a.createElement(c.ReplyContent,{key:e.content,postId:e.postId,content:e.content,contentType:e.contentType}),f,a.createElement(p.ReplierSignature,{userInfo:e.userInfo,quote:this.quote,boardInfo:this.props.boardInfo,postInfo:e,likeInfo:o,traceMode:!!this.props.isTrace,topicInfo:this.props.topicInfo})),a.createElement(h,{isHot:this.props.isHot,floor:e.floor})),m)},t.prototype.componentDidUpdate=function(){if(window.location.hash&&"#"!==window.location.hash){var e=window.location.hash.split("#")[1];if("10"===e&&(e="0"),document.getElementById(e)){var t=document.getElementById(e).offsetTop,n=document.getElementById(e).clientHeight,r=(window.innerHeight-n)/2;o(document).scrollTop(t-r)}}},t.prototype.render=function(){return this.props.isHot&&this.state.inWaiting?null:this.state.inWaiting?a.createElement("i",{style:{marginTop:"1rem"},className:"fa fa-spinner fa-pulse fa-5x fa-fw"}):this.state.contents&&this.state.contents.length?a.createElement("div",{className:"center",style:{width:"71rem",marginRight:"1px"}},this.state.contents.map(this.generateContents.bind(this))):a.createElement("div",null)},t}(a.Component);t.Reply=m;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return this.props.isHot?a.createElement("div",{style:{backgroundColor:"#FF4040"},className:"reply-floor"},a.createElement("img",{style:{width:"20px",height:"30px",paddingTop:"5px"},src:"/static/images/hot.png"})):this.props.floor>9999?a.createElement("div",{className:"reply-floor-small"},this.props.floor):a.createElement("div",{className:"reply-floor"},this.props.floor)},t}(a.Component);t.FloorSize=h;var f=function(){return function(){}}();t.ContentState=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=function(e){function t(t){var n=e.call(this,t)||this;return n.state={boardId:"",topicId:"",boardName:"",title:""},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.setState({boardId:this.props.topicInfo.boardId,topicId:this.props.topicId,boardName:this.props.boardInfo.name,title:this.props.topicInfo.title})},t.prototype.componentWillReceiveProps=function(e){this.setState({boardId:e.topicInfo.boardId,topicId:e.topicId,boardName:e.boardInfo.name,title:e.topicInfo.title})},t.prototype.render=function(){var e="/list/"+this.state.boardId,t="/topic/"+this.state.topicId;return a.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},a.createElement(s.Link,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),a.createElement("i",{className:"fa fa-chevron-right"}),a.createElement(s.Link,{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"},to:"/boardlist"},"版面列表"),a.createElement("i",{className:"fa fa-chevron-right"}),a.createElement(s.Link,{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"},to:e},this.state.boardName),a.createElement("i",{className:"fa fa-chevron-right"}),a.createElement(s.Link,{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"},to:t},a.createElement("div",{style:{overflow:"hidden",textOverflow:"ellipsis",maxWidth:"15rem",whiteSpace:"nowrap"}},this.state.title)," "))},t}(a.Component);t.Category=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(34),i=n(70),c=n(106),l=n(279),u=n(105),d=function(e){function t(t){var n=e.call(this,t)||this;n.sendUbbTopic=n.sendUbbTopic.bind(n),n.changeEditor=n.changeEditor.bind(n),n.showManagement=n.showManagement.bind(n),n.onChange=n.onChange.bind(n),n.close=n.close.bind(n),n.update=n.update.bind(n);var r="";return s.getLocalStorage("temporaryContent-"+n.props.topicInfo.id)&&(r=s.getLocalStorage("temporaryContent"+n.props.topicInfo.id)),n.state={content:r,mode:0,masters:[],buttonDisabled:!1,buttonInfo:"回复"},n}return r.__extends(t,e),t.prototype.update=function(e){this.setState({content:e})},t.prototype.onChange=function(){this.props.onChange()},t.prototype.showManagement=function(){var e="#manage"+this.props.topicInfo.id;o(e).css("display","")},t.prototype.close=function(){var e="#manage"+this.props.topicInfo.id;o(e).css("display","none")},t.prototype.componentWillUnmount=function(){this.state.content&&s.setLocalStorage("temporaryContent"+this.props.topicInfo.id,this.state.content)},t.prototype.componentDidMount=function(){if(1===this.state.mode){var e=s.getApiUrl+"/file";editormd.emoji.path="/static/images/emoji/",i.Constants.testEditor=editormd("test-editormd",{width:"100%",height:400,path:"/static/scripts/lib/editor.md/lib/",saveHTMLToTextarea:!1,imageUpload:!1,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:e,emoji:!0,toc:!0,tocm:!0,toolbarIcons:function(){return["undo","redo","|","emoji","bold","del","italic","quote","|","h1","h2","h3","h4","|","list-ul","list-ol","hr","|","link","image","testIcon","code","table","html-entities"]},toolbarIconsClass:{testIcon:"fa-upload"},toolbarHandlers:{testIcon:function(){o("#upload-files").click()}}})}var t=moment(this.props.content.replyTime).format("YYYY-MM-DD HH:mm:ss"),n="/topic/"+this.props.topicInfo.id+"#"+this.props.content.floor,r=this.props.boardInfo.masters;if(this.props.content)if(1===this.state.mode){var a=">**以下是引用"+this.props.content.floor+"楼：用户"+this.props.content.userName+"在"+t+"的发言：**\n"+this.props.content.content+"\n";i.Constants.testEditor.appendMarkdown(a),this.setState({masters:r})}else{a="\n[quote][b]以下是引用"+this.props.content.floor+"楼：用户"+this.props.content.userName+"在"+t+"的发言：\n[color=blue][url="+n+"]>>查看原帖<<[/url][/color][/b]"+this.props.content.content+"[/quote]\n";this.setState({masters:r,content:a})}},t.prototype.componentWillReceiveProps=function(e){var t=moment(e.content.replyTime).format("YYYY-MM-DD HH:mm:ss");if(e.content.userName)if(1===this.state.mode){var n=">**以下是引用"+e.content.floor+"楼：用户"+e.content.userName+"在"+t+"的发言：**\n"+e.content.content+"\n";i.Constants.testEditor.appendMarkdown(n)}else{var r=e.content.floor,a=void 0,s=void 0;r>10?(a=parseInt(((r-1)/10).toString())+1,r%=10,s="/topic/"+this.props.topicInfo.id+"/"+a+"#"+(0===r?10:r)):s="/topic/"+this.props.topicInfo.id+"#"+e.content.floor;n="[quote][b]以下是引用"+e.content.floor+"楼：用户"+e.content.userName+"在"+t+"的发言：[color=blue][url="+s+"]>>查看原帖<<[/url][/color][/b]\n"+e.content.content+"[/quote]\n";this.setState({content:n})}},t.prototype.componentDidUpdate=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){return 1===this.state.mode&&(e=s.getApiUrl+"/file",editormd.emoji.path="/static/images/emoji/",i.Constants.testEditor=editormd("test-editormd",{width:"100%",height:400,path:"/static/scripts/lib/editor.md/lib/",saveHTMLToTextarea:!1,imageUpload:!1,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:e,emoji:!0,toc:!0,tocm:!0,toolbarIcons:function(){return["undo","redo","|","emoji","bold","del","italic","quote","|","h1","h2","h3","h4","|","list-ul","list-ol","hr","|","link","image","testIcon","code","table","html-entities"]},toolbarIconsClass:{testIcon:"fa-upload"},toolbarHandlers:{testIcon:function(){o("#upload-files").click()}}}),i.Constants.testEditor.setMarkdown(this.state.content)),[2]})})},t.prototype.sendUbbTopic=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i,c,l,u,d,p,m;return r.__generator(this,function(r){switch(r.label){case 0:return this.setState({buttonDisabled:!0,buttonInfo:"..."}),e="/topic/"+this.props.topicInfo.id+"/post",s.quoteJudger(this.state.content)?[4,s.getBasicPostsInfo([this.props.content.postId])]:[3,2];case 1:return r.sent(),t={content:this.state.content,contentType:0,title:"",parentId:this.props.content.postId},[3,3];case 2:t={content:this.state.content,contentType:0,title:""},r.label=3;case 3:return n=JSON.stringify(t),[4,s.getToken()];case 4:return a=r.sent(),(o=new Headers).append("Authorization",a),o.append("Content-Type","application/json"),[4,s.cc98Fetch(e,{method:"POST",headers:o,body:n})];case 5:return 402!==(i=r.sent()).status?[3,6]:(s.noticeMessageShow("postNone"),this.setState({buttonDisabled:!1,buttonInfo:"发帖"}),[3,11]);case 6:return 403!==i.status?[3,7]:(s.noticeMessageShow("postFast"),this.setState({buttonDisabled:!1,buttonInfo:"发帖"}),[3,11]);case 7:return 200!==i.status?[3,11]:(c=s.atHanderler(this.state.content))?[4,i.text()]:[3,10];case 8:return l=r.sent(),u=this.props.topicInfo.id,d=JSON.stringify(c),p="/notification/at?topicid="+u+"&postid="+l,(m=new Headers).append("Content-Type","application/json"),m.append("Authorization",a),[4,s.cc98Fetch(p,{method:"POST",headers:m,body:d})];case 9:r.sent(),r.label=10;case 10:s.removeLocalStorage("temporaryContent"),this.setState({content:"",buttonDisabled:!1,buttonInfo:"发帖"}),this.props.onChange(),r.label=11;case 11:return[2]}})})},t.prototype.routerWillLeave=function(e){return"确认要离开？"},t.prototype.sendMdTopic=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,c,l,u,d,p,m,h,f,g,v;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,8,,9]),this.setState({buttonDisabled:!0,buttonInfo:"..."}),e="/topic/"+this.props.topicInfo.id+"/post",t=i.Constants.testEditor.getMarkdown(),i.Constants.testEditor.setMarkdown(""),n={content:t,contentType:1,title:""},a=JSON.stringify(n),c=s.getLocalStorage("accessToken"),(l=new Headers).append("Authorization",c),l.append("Content-Type","application/json"),[4,s.cc98Fetch(e,{method:"POST",headers:l,body:a})];case 1:return 402!==(u=r.sent()).status?[3,2]:(s.noticeMessageShow("postNone"),this.setState({buttonDisabled:!1,buttonInfo:"发帖"}),[3,7]);case 2:return 403!==u.status?[3,3]:(s.noticeMessageShow("postFast"),this.setState({buttonDisabled:!1,buttonInfo:"发帖"}),[3,7]);case 3:return 200!==u.status?[3,7]:(d=s.atHanderler(t))?[4,u.text()]:[3,6];case 4:return p=r.sent(),m=this.props.topicInfo.id,h=JSON.stringify(d),f="/notification/at?topicid="+m+"&postid="+p,(g=new Headers).append("Content-Type","application/json"),g.append("Authorization",c),[4,s.cc98Fetch(f,{method:"POST",headers:g,body:h})];case 5:r.sent(),r.label=6;case 6:s.removeLocalStorage("temporaryContent"),this.props.onChange(),v=s.getApiUrl+"/file",editormd.emoji.path="/static/images/emoji/",i.Constants.testEditor=editormd("test-editormd",{width:"100%",height:400,path:"/static/scripts/lib/editor.md/lib/",saveHTMLToTextarea:!1,imageUpload:!1,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:v,emoji:!0,toc:!0,tocm:!0,toolbarIcons:function(){return["undo","redo","|","emoji","bold","del","italic","quote","|","h1","h2","h3","h4","|","list-ul","list-ol","hr","|","link","image","testIcon","code","table","html-entities"]},toolbarIconsClass:{testIcon:"fa-upload"},toolbarHandlers:{testIcon:function(){o("#upload-files").click()}}}),this.setState({content:"",buttonDisabled:!1,buttonInfo:"发帖"}),r.label=7;case 7:return[3,9];case 8:return r.sent(),[3,9];case 9:return[2]}})})},t.prototype.showIP=function(){o(".findIP").css("display","flex")},t.prototype.changeEditor=function(){0===this.state.mode?this.setState({mode:1}):this.setState({mode:0})},t.prototype.getInitialState=function(){return{value:""}},t.prototype.handleChange=function(e){this.setState({content:e.target.value})},t.prototype.render=function(){var e;0===this.state.mode?("使用UBB模式编辑",e=a.createElement("div",null,a.createElement(c.UbbEditor,{update:this.update,value:this.state.content,option:{height:20,submit:this.sendUbbTopic}}),a.createElement("div",{className:"row",style:{justifyContent:"center",marginBottom:"1.25rem "}},a.createElement("button",{id:"post-topic-button",onClick:this.sendUbbTopic,disabled:this.state.buttonDisabled,className:"button blue",style:{marginTop:"1.25rem",width:"6rem",height:"2rem",lineHeight:"0.8rem"}},this.state.buttonInfo)))):("使用Markdown编辑",e=a.createElement("div",{id:"sendTopic"},a.createElement("form",null,a.createElement("input",{type:"file",id:"upload-files",style:{display:"none "},onChange:s.uploadEvent}),a.createElement("div",{id:"test-editormd",className:"editormd"},a.createElement("textarea",{className:"editormd-markdown-textarea",name:"test-editormd-markdown-doc"}))),a.createElement("div",{className:"row",style:{justifyContent:"center",marginBottom:"1.25rem "}},a.createElement("button",{id:"post-topic-button",disabled:this.state.buttonDisabled,onClick:this.sendMdTopic.bind(this),className:"button blue",style:{marginTop:"1.25rem",width:"4.5rem",height:"2rem",lineHeight:"0.8rem"}},this.state.buttonInfo))));this.state.mode;var t=null;return s.isMaster(this.props.boardInfo.boardMasters)&&(t=a.createElement("div",null,a.createElement("button",{className:"topicManageBTN",id:"topicManagementBTN",style:{width:"5rem"},onClick:this.showManagement},"管理"))),a.createElement("div",{id:"sendTopicInfo",style:{width:"100%",display:"flex",flexDirection:"column"}},a.createElement("div",{className:"row",style:{justifyContent:"flex-end"}},a.createElement("div",{id:"post-topic-changeMode",className:"changeEditor",onClick:this.changeEditor.bind(this),style:{width:"12rem",marginBottom:"0.5rem"}},1===this.state.mode?"切换到Ubb编辑器":"切换到Markdown编辑器")),e,t,a.createElement(l.TopicManagement,{update:this.onChange,boardId:this.props.boardInfo.id,updateTime:Date.now(),topicInfo:this.props.topicInfo}),a.createElement(u.NoticeMessage,{text:"回复失败, 10s之内仅可进行一次回帖，请稍作休息",id:"postFast",top:"26%",left:"38%"}),a.createElement(u.NoticeMessage,{text:"回复失败, 请输入内容",id:"postNone",top:"26%",left:"44%"}),a.createElement(u.NoticeMessage,{text:"操作成功",id:"operationSuccess",top:"26%",left:"44%"}))},t}(a.Component);t.SendTopic=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);!function(e){var t=1;e.start=function(){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){return(n=indexedDB.open("cc98",t)).onupgradeneeded=function(e){n.result.objectStoreNames.contains("userInfo")||n.result.createObjectStore("userInfo",{keyPath:"userInfo.id"}).createIndex("name","userInfo.name",{unique:!0})},e.db?[2]:[2,new Promise(function(t,r){n.onsuccess=function(r){e.db=n.result,t()},n.onerror=function(e){return r()}})]})})}}(t.IndexedDB||(t.IndexedDB={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(153);t.addUserInfo=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,s;return r.__generator(this,function(r){return t=a.IndexedDB.db.transaction("userInfo","readwrite"),n=t.objectStore("userInfo"),s=n.put({userInfo:e,addTime:Date.now()}),[2,new Promise(function(e,t){s.onsuccess=function(t){return e()},s.onerror=function(e){return t()}})]})})},t.getUserInfo=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,s;return r.__generator(this,function(r){if(t=a.IndexedDB.db.transaction("userInfo","readonly"),n=t.objectStore("userInfo"),"number"==typeof e)s=n.get(e);else{if("string"!=typeof e)return[2,{id:null}];s=n.index("name").get(e)}return[2,new Promise(function(e,t){s.onsuccess=function(t){s.result&&s.result.addTime+36e5>Date.now()?e(s.result.userInfo):e(void 0)},s.onerror=function(e){return t()}})]})})},t.getUsersInfo=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){return t=a.IndexedDB.db.transaction("userInfo","readonly"),n=t.objectStore("userInfo"),[2,Promise.all(e.map(function(e){var t;if("number"==typeof e)t=n.get(e);else{if("string"!=typeof e)return{id:null};t=n.index("name").get(e)}return new Promise(function(e,n){t.onsuccess=function(n){t.result&&t.result.addTime+36e5>Date.now()?e(t.result.userInfo):e(void 0)},t.onerror=function(e){return n()}})}))]})})}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(7),o=n(155),i=n(332),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"img"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var r=e,o=t.value("title"),c=parseInt(t.value("img")),u=n.options,d=u.allowImage;return u.allowExternalImage||i(r).hostname.includes("cc98.org")||(d=!1),d?n.options.compatibility===s.UbbCompatiblityMode.EnforceMorden?1===c?a.createElement(l,{imageUri:r,title:o,isShowed:!1}):a.createElement("figure",null,a.createElement(l,{imageUri:r,title:o,isShowed:!0}),a.createElement("figcaption",null,o)):1===c?a.createElement(l,{imageUri:r,title:o,isShowed:!1}):a.createElement(l,{imageUri:r,title:o,isShowed:!0}):a.createElement("a",{href:r},r)},t}(s.TextTagHandler);t.ImageTagHandler=c;var l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isShowed:n.props.isShowed},n.toggleIsShowed=n.toggleIsShowed.bind(n),n}return r.__extends(t,e),t.prototype.toggleIsShowed=function(){this.setState(function(e){return{isShowed:!e.isShowed}})},t.prototype.render=function(){return this.state.isShowed?a.createElement(o.default,r.__assign({},{height:300,once:!0,offset:100}),a.createElement("img",{style:{maxWidth:"100%"},src:this.props.imageUri,alt:this.props.title})):a.createElement("div",{className:"hiddenImage",onClick:this.toggleIsShowed},"点击查看图片")},t}(a.Component);t.Image=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(22),i=n(16),c=n(6),l=n(59),u=n(71),d=n(108),p=n(4),m=function(e){function t(t,n){return e.call(this,t,n)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"match",{get:function(){return this.props.match},enumerable:!0,configurable:!0}),t}(a.Component);t.RouteComponent=m;var h=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.state={boardId:null,boardInfo:{bigPaper:"",masters:[],name:""},page:1,fetchState:"ok"},r}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,s.getBoardInfo(e.match.params.boardId)];case 1:return t=n.sent(),this.setState({boardInfo:t,boardId:this.match.params.boardId}),[2]}})})},t.prototype.componentWillMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,s.getBoardInfo(this.match.params.boardId)];case 1:return e=t.sent(),this.setState({boardInfo:e,boardId:this.match.params.boardId,fetchState:e}),[2]}})})},t.prototype.render=function(){switch(this.state.fetchState){case"ok":return a.createElement("div",null);case"not found":return a.createElement(u.NotFoundTopic,null);case"unauthorized":return a.createElement(u.UnauthorizedBoard,null);case"server error":return a.createElement(u.ServerError,null)}return a.createElement("div",{id:"listRoot"},a.createElement(i.default,{title:this.state.boardInfo.name+" - CC98论坛"}),a.createElement(f,{boardId:this.match.params.boardId,boardInfo:this.state.boardInfo}),a.createElement(g,{key:this.state.page,boardId:this.match.params.boardId,boardInfo:this.state.boardInfo}),a.createElement(y,{boardInfo:this.state.boardInfo,adsUrl:null}),a.createElement(c.Switch,null,a.createElement(c.Route,{exact:!0,path:"/list/:boardid/tags/:tag1Id/:tag2Id/:page?",component:C}),a.createElement(c.Route,{exact:!0,path:"/list/:boardId/tag/tag1/:tagId/:page?",component:w}),a.createElement(c.Route,{exact:!0,path:"/list/:boardId/tag/tag2/:tagId/:page?",component:w}),a.createElement(c.Route,{exact:!0,path:"/list/:boardId/best/:page?",component:N}),a.createElement(c.Route,{exact:!0,path:"/list/:boardId/save/:page?",component:S}),a.createElement(c.Route,{exact:!0,path:"/list/:boardId/record/:page?",component:I}),a.createElement(c.Route,{exact:!0,path:"/list/:boardId/:page?",component:_})))},t}(m);t.List=h;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e="/list/"+this.props.boardId;return a.createElement("div",{className:"row",style:{alignItems:"baseline",width:"100% ",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},a.createElement(c.Link,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),a.createElement("i",{className:"fa fa-chevron-right"}),a.createElement(c.Link,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem",marginLeft:"0.5rem"},to:"/boardlist"},"版面列表"),a.createElement("i",{className:"fa fa-chevron-right"}),a.createElement(c.Link,{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem"},to:e},this.props.boardInfo.name))},t}(a.Component);t.Category=f;var g=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.changeBigPaper=function(){return r.__awaiter(a,void 0,void 0,function(){var e,t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e="/board/"+this.props.boardId+"/big-paper",[4,s.getToken()];case 1:return t=r.sent(),(n=new Headers).append("Authorization",t),n.append("Content-Type","application/json"),[4,s.cc98Fetch(e,{method:"PUT",headers:n,body:JSON.stringify({content:this.state.curDesc})})];case 2:if(200!==r.sent().status)throw new Error;return this.setState({info:"修改成功"}),[3,4];case 3:return a=r.sent(),this.setState({info:"修改失败 "+a.message}),[3,4];case 4:return[2]}})})},a.state={isFollow:s.isFollowThisBoard(a.props.boardId),isExtend:!1,isEditing:!1,curDesc:t.boardInfo.bigPaper,info:""};s.isFollowThisBoard(a.props.boardId);return a.follow=a.follow.bind(a),a.unfollow=a.unfollow.bind(a),a.generateMasters=a.generateMasters.bind(a),a}return r.__extends(t,e),t.prototype.follow=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,s.followBoard(this.props.boardId)];case 1:return e.sent(),this.setState({isFollow:!0}),[2]}})})},t.prototype.unfollow=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,s.unfollowBoard(this.props.boardId)];case 1:return e.sent(),this.setState({isFollow:!1}),[2]}})})},t.prototype.generateMasters=function(e){var t=e.toString(),n="/user/name/"+encodeURIComponent(e.toString());return a.createElement("div",{style:{marginRight:"10px",fontSize:"0.75rem"}},a.createElement("a",{style:{color:this.state.isExtend?"#fff":"#000"},href:n},t))},t.prototype.componentWillReceiveProps=function(e){this.setState({isFollow:s.isFollowThisBoard(e.boardInfo.isFollow)})},t.prototype.onError=function(e){e.preventDefault(),e.target.src="/static/images/_CC98.png"},t.prototype.render=function(){var e=this,t="/list/"+this.props.boardId,n=(this.props.boardId,"/static/images/_"+this.props.boardInfo.name+".png"),r=s.isMaster(this.props.boardInfo.boardMasters),i=a.createElement("div",{className:"row",style:{width:"100%"}},this.props.boardInfo.name);return this.props.boardInfo&&this.props.boardInfo.name.length>8&&(i=a.createElement("div",{className:"row",style:{width:"100%",fontSize:"14px"}},this.props.boardInfo.name)),this.state.isExtend?a.createElement("div",{className:"row",style:{width:"100%",overflow:"hidden",maxHeight:"50rem",transition:"max-height 1.5s"}},a.createElement("div",{className:"boardMessage"},a.createElement("div",{className:"row",style:{height:"4rem",marginTop:"1.25rem"}},a.createElement("img",{style:{marginLeft:"1.25rem"},onError:this.onError,src:n}),a.createElement("div",{className:"boardMessageDetails"},a.createElement("div",{className:"row",style:{width:"100%"}},this.props.boardInfo.name),a.createElement("div",{className:"row",style:{width:"100%",alignItems:"center"}},a.createElement("div",{style:{fontSize:"0.75rem",width:"4.5rem"}},this.props.boardInfo.todayCount,"/",this.props.boardInfo.topicCount),a.createElement("div",{className:"boardFollow",onClick:this.state.isFollow?this.unfollow:this.follow},this.state.isFollow?"取关":"关注"," ")))),a.createElement("div",{className:"boardDescription"},a.createElement("div",null,this.props.boardInfo.description)),a.createElement("div",{className:"boardMasters"},a.createElement("div",null,"版主"),a.createElement("div",null,this.props.boardInfo.boardMasters.map(this.generateMasters)))),a.createElement("div",{className:"bigPaper",style:{display:"block"}},a.createElement("button",{className:"fa fa-angle-double-up",style:{float:"right",backgroundColor:"#fff",cursor:"pointer",border:"none"},type:"button",onClick:function(){return e.setState({isExtend:!1})}},"收起"),a.createElement("div",{className:"bigPaperTitle"},s.isMaster(this.props.boardInfo.boardMasters)?a.createElement("button",{type:"button",onClick:function(){return e.setState({isEditing:!0})}},"编辑"):null,this.state.isEditing?a.createElement("button",{type:"button",onClick:function(){e.changeBigPaper()}},"提交"):null,a.createElement("p",null,this.state.info)),this.state.isEditing?a.createElement("div",null,a.createElement("textarea",{style:{width:"50rem",height:"15rem",resize:"none"},onChange:function(t){return e.setState({curDesc:t.target.value})}},this.state.curDesc)):a.createElement("div",{style:{maxWidth:"53.25rem"}},a.createElement(o.UbbContainer,{code:this.props.boardInfo.bigPaper})))):a.createElement("div",{className:"row",style:{width:"100%",overflow:"hidden",maxHeight:"6rem",transition:"max-height 1s"}},a.createElement(c.Link,{to:t},a.createElement("div",{className:"boardMessage"},a.createElement("div",{className:"row",style:{height:"4rem",marginTop:"1.25rem"}},a.createElement("img",{style:{marginLeft:"1.25rem"},onError:this.onError,src:n}),a.createElement("div",{className:"boardMessageDetails"},i,a.createElement("div",{className:"row",style:{width:"100%",alignItems:"center"}},a.createElement("div",{style:{fontSize:"0.75rem",width:"4.5rem"}},this.props.boardInfo.todayCount,"/",this.props.boardInfo.topicCount),a.createElement("div",{className:"boardFollow",onClick:this.state.isFollow?this.unfollow:this.follow},this.state.isFollow?"取关":"关注"," ")))))),a.createElement("div",{className:"bigPaper",style:{display:"block"}},this.props.boardInfo.bigPaper?a.createElement("button",{className:"fa fa-angle-double-down",style:{float:"right",backgroundColor:"#fff",cursor:"pointer",border:"none"},type:"button",onClick:function(){return e.setState({isExtend:!0})}},"展开"):r?a.createElement("button",{style:{float:"right"},type:"button",onClick:function(){return e.setState({isEditing:!0,isExtend:!0})}},"编辑"):null,a.createElement("div",null,a.createElement("div",null,"版面简介：",this.props.boardInfo.description)),a.createElement("div",null,a.createElement("div",{style:{display:"flex",marginTop:".5rem",fontSize:"0.75rem"}},"版主：",this.props.boardInfo.boardMasters.map(this.generateMasters)))))},t}(m);t.ListHead=g;var v=function(e){function t(t,n){return e.call(this,t,n)||this}return r.__extends(t,e),t.prototype.generateTagButton=function(e){var t="/list/"+this.props.boardid+"/tag/tag1/"+e.id;return a.createElement("div",null,a.createElement(c.Link,{to:t},a.createElement("button",{className:"chooseTag"},e.name,a.createElement("span",{className:"tagNumber"}))))},t.prototype.generateTag2Button=function(e){var t="/list/"+this.props.boardid+"/tag/tag2/"+e.id;return a.createElement("div",null,a.createElement(c.Link,{to:t},a.createElement("button",{className:"chooseTag"},e.name,a.createElement("span",{className:"tagNumber"}))))},t.prototype.render=function(){var e=null,t=null,n="/list/"+this.props.boardid;return this.props.tag&&this.props.tag.length>=1&&(e=a.createElement("div",{style:{maxWidth:"35rem",lineHeight:"3rem",display:"flex",flexDirection:"row",justifyContent:"flex-start",width:"100%",marginLeft:"0.3125rem",marginRight:"0.3125rem",borderTop:"dashed #EAEAEA thin",marginBottom:"0.5rem"}},a.createElement("div",{className:"row",style:{display:"flex",flexWrap:"wrap",maxWidth:"35rem"}},a.createElement("div",null,a.createElement("button",{className:"chooseTag"},a.createElement(c.Link,{to:n},"全部"))),this.props.tag[0].tags.map(this.generateTagButton.bind(this))))),this.props.tag&&2===this.props.tag.length&&(t=a.createElement("div",{style:{maxWidth:"35rem",lineHeight:"3rem",display:"flex",flexDirection:"row",justifyContent:"flex-start",width:"100%",marginLeft:"0.3125rem",marginRight:"0.3125rem",borderTop:"dashed #EAEAEA thin",marginBottom:"0.5rem"}},a.createElement("div",{className:"row",style:{display:"flex",flexWrap:"wrap",maxWidth:"35rem"}},a.createElement("div",null,a.createElement("button",{className:"chooseTag"},a.createElement(c.Link,{to:n},"全部"))),this.props.tag[1].tags.map(this.generateTag2Button.bind(this))))),a.createElement("div",{className:"row",style:{width:"100%",marginLeft:"0.3125rem",marginRight:"0.3125rem",marginTop:"0.9375rem",justifyContent:"space-between",alignItems:"flex-end"}},a.createElement("div",null,e,t),a.createElement(l.Pager,{page:this.props.page,url:this.props.url,totalPage:this.props.totalPage}))},t}(a.Component);t.ListTagAndPager=v;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.clickListener=function(){var e=!1,t=!0,n=!1;s.getLocalStorage("userInfo")&&(e=!0),s.getLocalStorage("userInfo")&&!s.getLocalStorage("userInfo").isVerified&&(t=!1),s.getLocalStorage("userInfo")&&0!==s.getLocalStorage("userInfo").lockState&&(n=!0),e?t?n&&alert("您的账号被全站禁言！"):alert("您的帐号未认证，无法发言，请先前往https://account.cc98.org 认证激活。"):alert("请登陆！")},t.prototype.render=function(){var e=null,t=!1,n=!0,r=null;s.getLocalStorage("userInfo")?(!0,s.getLocalStorage("userInfo").isVerified?t=!0:(t=!1,r=a.createElement("div",{style:{marginLeft:"1rem",color:"red"}},"您的帐号未认证，无法发言，请先前往 ",a.createElement("a",{href:"https://account.cc98.org"},"https://account.cc98.org")," 认证激活。")),0!==s.getLocalStorage("userInfo").lockState?(n=!0,r=a.createElement("div",{style:{marginLeft:"1rem",color:"red"}},"您被全站禁言。")):n=!1):r=a.createElement("div",{style:{marginLeft:"1rem",color:"red"}},"您还未登录，不能发帖，请先登录");var o="/editor/postTopic/"+this.props.boardInfo.id;return e=!n&&p.isLogOn&&t?a.createElement(c.Link,{className:"button bgcolor",to:o},"发主题"):a.createElement("div",{style:{display:"flex",alignItems:"center"}},a.createElement("button",{style:{border:"none"},className:"button bgcolor",onClick:this.clickListener},"发主题"),r),a.createElement("div",{className:"row",style:{width:"100%",height:"6.25rem",alignItems:"flex-end",justifyContent:"space-between",marginTop:"1rem"}},e,a.createElement("div",{style:{height:"6.25rem"}}," ",a.createElement(d.AdsComponent,null)))},t}(a.Component);t.ListButtonAndAds=y;var E=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.state={data:[]},r}return r.__extends(t,e),t.prototype.convertTopicToElement=function(e){return a.createElement(T,{key:e.id,title:e.title,userName:e.userName,id:e.id,userId:e.userId,lastPostTime:e.lastPostTime,lastPostUser:e.lastPostUser,likeCount:e.likeCount,dislikeCount:e.dislikeCount,replyCount:e.replyCount,highlightInfo:e.highlightInfo,topState:e.topState,state:e.state,hitCount:e.hitCount,bestState:e.bestState})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,s.GetTopTopics(this.props.boardId)];case 1:return e=t.sent(),this.setState({data:e}),[2]}})})},t.prototype.render=function(){return a.createElement("div",null,this.state.data.map(this.convertTopicToElement))},t}(a.Component);t.ListTopContent=E;var b=function(e){function t(t){var n=e.call(this,t)||this;return n.state={data:[]},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,s.getBestTopics(this.props.boardId,this.props.curPage)];case 1:return e=t.sent(),this.setState({data:e}),[2]}})})},t.prototype.convertTopicToElement=function(e){return a.createElement(T,{key:e.id,title:e.title,userName:e.userName,id:e.id,userId:e.userId,lastPostTime:e.lastPostTime,lastPostUser:e.lastPostUser,likeCount:e.likeCount,dislikeCount:e.dislikeCount,replyCount:e.replyCount,highlightInfo:e.highlightInfo,topState:e.topState,state:e.state,hitCount:e.hitCount,bestState:e.bestState})},t.prototype.render=function(){return a.createElement("div",null,this.state.data.map(this.convertTopicToElement))},t}(a.Component);t.BestTopics=b;var _=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.state={items:[],totalPage:0,boardInfo:{masters:[],topicCount:1},fetchState:"ok",tags:[]},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o;return r.__generator(this,function(r){switch(r.label){case 0:return(e=this.match.params.page)||(e=1),[4,s.getBoardInfo(this.match.params.boardId)];case 1:return t=r.sent(),[4,s.getBoardTopicAsync(e,this.match.params.boardId,t.topicCount)];case 2:return n=r.sent(),a=this.getTotalListPage(t.topicCount),[4,s.getBoardTag(this.match.params.boardId)];case 3:return o=r.sent(),this.setState({items:n,totalPage:a,boardInfo:t,fetchState:n,tags:o}),[2]}})})},t.prototype.convertTopicToElement=function(e){return a.createElement(T,{key:e.id,title:e.title,userName:e.userName,id:e.id,userId:e.userId,lastPostTime:e.lastPostTime,lastPostUser:e.lastPostUser,likeCount:e.likeCount,dislikeCount:e.dislikeCount,replyCount:e.replyCount,highlightInfo:e.highlightInfo,topState:e.topState,state:e.state,hitCount:e.hitCount,bestState:e.bestState})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,o,i;return r.__generator(this,function(r){switch(r.label){case 0:return n=e.match.params.page,t=n?parseInt(n):1,[4,s.getBoardInfo(this.match.params.boardId)];case 1:return a=r.sent(),o=this.getTotalListPage(this.state.boardInfo.topicCount),[4,s.getBoardTopicAsync(t,e.match.params.boardId,a.topicCount)];case 2:return i=r.sent(),this.setState({items:i,totalPage:o}),[2]}})})},t.prototype.getTotalListPage=function(e){return s.getListTotalPage(e)},t.prototype.render=function(){var e=this.match.params.page?parseInt(this.match.params.page):1,t=null;1!==parseInt(this.match.params.page)&&this.match.params.page||(t=a.createElement("div",null,a.createElement(E,{boardId:this.match.params.boardId})));var n=this.state.items.map(this.convertTopicToElement),r="/list/"+this.match.params.boardId+"/best/",s="/list/"+this.match.params.boardId+"/save/",o="/list/"+this.match.params.boardId+"/",i="/list/"+this.match.params.boardId+"/record/";return a.createElement("div",{className:"listContent "},a.createElement(v,{page:e,totalPage:this.state.totalPage,boardid:this.match.params.boardId,url:o,tag:this.state.tags}),a.createElement("div",{className:"column tagColumn"},a.createElement("div",{className:"row board-topBar"},a.createElement("div",{className:"row",style:{alignItems:"center"}},a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:o},"全部")),a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:r},"精华")),a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:s},"保存"))),a.createElement("div",{className:"row",style:{alignItems:"center"}},a.createElement("div",{style:{marginRight:"14rem"}},a.createElement("span",null,"作者")),a.createElement("div",{style:{marginRight:"8rem"}},a.createElement("span",null,"最后回复")))),t,a.createElement("div",null,n)),a.createElement("div",{className:"listContentBottom"},a.createElement(l.Pager,{page:e,totalPage:this.state.totalPage,url:o}),a.createElement(c.Link,{to:i},a.createElement("div",{className:"boardRecordBtn"},"查看版面事件"))))},t}(m);t.ListContent=_;var w=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.state={items:[],totalPage:0,boardInfo:{masters:[],topicCount:1},fetchState:"ok",tags:[],layer:1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i;return r.__generator(this,function(r){switch(r.label){case 0:return(e=this.match.params.page)||(e=1),[4,s.getBoardInfo(this.match.params.boardId)];case 1:return t=r.sent(),[4,s.getBoardTag(this.match.params.boardId)];case 2:return n=r.sent(),a=s.getTagLayer(this.match.params.tagId,n),[4,s.getTopicByOneTag(this.match.params.tagId,this.match.params.boardId,a,e)];case 3:return o=r.sent(),i=this.getTotalListPage(o.count),this.setState({items:o.topics,totalPage:i,boardInfo:t,fetchState:o,tags:n,layer:a}),[2]}})})},t.prototype.convertTopicToElement=function(e){return a.createElement(T,{key:e.id,title:e.title,userName:e.userName,id:e.id,userId:e.userId,lastPostTime:e.lastPostTime,lastPostUser:e.lastPostUser,likeCount:e.likeCount,dislikeCount:e.dislikeCount,replyCount:e.replyCount,highlightInfo:e.highlightInfo,topState:e.topState,state:e.state,hitCount:e.hitCount,bestState:e.bestState})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,o,i,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return n=e.match.params.page,t=n?parseInt(n):1,[4,s.getBoardInfo(e.match.params.boardId)];case 1:return a=r.sent(),[4,s.getBoardTag(e.match.params.boardId)];case 2:return o=r.sent(),i=s.getTagLayer(e.match.params.tagId,o),[4,s.getTopicByOneTag(e.match.params.tagId,e.match.params.boardId,i,t)];case 3:return c=r.sent(),l=this.getTotalListPage(c.count),this.setState({items:c.topics,totalPage:l,boardInfo:a,fetchState:c,tags:o,layer:i}),[2]}})})},t.prototype.getTotalListPage=function(e){return s.getListTotalPage(e)},t.prototype.render=function(){var e=this.match.params.page?parseInt(this.match.params.page):1;1!==parseInt(this.match.params.page)&&this.match.params.page||a.createElement("div",null,a.createElement(E,{boardId:this.match.params.boardId}));var t=this.state.items.map(this.convertTopicToElement),n="/list/"+this.match.params.boardId+"/tag/tag"+this.state.layer+"/"+this.match.params.tagId+"/",r="/list/"+this.match.params.boardId+"/",s="/list/"+this.match.params.boardId+"/best/",o="/list/"+this.match.params.boardId+"/save/",i="/list/"+this.match.params.boardId+"/record/";return a.createElement("div",{className:"listContent "},a.createElement(v,{page:e,totalPage:this.state.totalPage,boardid:this.match.params.boardId,url:n,tag:this.state.tags}),a.createElement("div",{className:"column tagColumn"},a.createElement("div",{className:"row board-topBar"},a.createElement("div",{className:"row",style:{alignItems:"center"}},a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:r}," 全部")),a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:s},"精华")),a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:o},"保存"))),a.createElement("div",{className:"row",style:{alignItems:"center"}},a.createElement("div",{style:{marginRight:"14rem"}},a.createElement("span",null,"作者")),a.createElement("div",{style:{marginRight:"8rem"}},a.createElement("span",null,"最后回复")))),a.createElement("div",null,t)),a.createElement("div",{className:"listContentBottom"},a.createElement(l.Pager,{page:e,totalPage:this.state.totalPage,url:n}),a.createElement(c.Link,{to:i},a.createElement("div",{className:"boardRecordBtn"},"查看版面事件"))))},t}(m);t.ListTagContent=w;var C=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.state={items:[],totalPage:0,boardInfo:{masters:[],topicCount:1},fetchState:"ok",tags:[]},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o;return r.__generator(this,function(r){switch(r.label){case 0:return(e=this.match.params.page)||(e=1),[4,s.getBoardInfo(this.match.params.boardId)];case 1:return t=r.sent(),[4,s.getTopicByTwoTags(this.match.params.tag1Id,this.match.params.tag2Id,this.match.params.boardId,e)];case 2:return n=r.sent(),[4,s.getBoardTag(this.match.params.boardId)];case 3:return a=r.sent(),o=this.getTotalListPage(n.count),this.setState({items:n.topics,totalPage:o,boardInfo:t,fetchState:n,tags:a}),[2]}})})},t.prototype.convertTopicToElement=function(e){return a.createElement(T,{key:e.id,title:e.title,userName:e.userName,id:e.id,userId:e.userId,lastPostTime:e.lastPostTime,lastPostUser:e.lastPostUser,likeCount:e.likeCount,dislikeCount:e.dislikeCount,replyCount:e.replyCount,highlightInfo:e.highlightInfo,topState:e.topState,state:e.state,hitCount:e.hitCount,bestState:e.bestState})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,o,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return n=e.match.params.page,t=n?parseInt(n):1,[4,s.getBoardInfo(e.match.params.boardId)];case 1:return a=r.sent(),[4,s.getBoardTag(e.match.params.boardId)];case 2:return o=r.sent(),[4,s.getTopicByTwoTags(e.match.params.tag1Id,e.match.params.tag2Id,e.match.params.boardId,t)];case 3:return i=r.sent(),c=this.getTotalListPage(i.count),this.setState({items:i.topics,totalPage:c,boardInfo:a,fetchState:i,tags:o}),[2]}})})},t.prototype.getTotalListPage=function(e){return s.getListTotalPage(e)},t.prototype.render=function(){var e=this.match.params.page?parseInt(this.match.params.page):1;1!==parseInt(this.match.params.page)&&this.match.params.page||a.createElement("div",null,a.createElement(E,{boardId:this.match.params.boardId}));var t=this.state.items.map(this.convertTopicToElement),n="/list/"+this.match.params.boardId+"/tags/tag1/"+this.match.params.tag1Id+"/tag2/"+this.match.params.tag2Id+"/",r="/list/"+this.match.params.boardId+"/",s="/list/"+this.match.params.boardId+"/best/",o="/list/"+this.match.params.boardId+"/save/",i="/list/"+this.match.params.boardId+"/record/";return a.createElement("div",{className:"listContent "},a.createElement(v,{page:e,totalPage:this.state.totalPage,boardid:this.match.params.boardId,url:n,tag:this.state.tags}),a.createElement("div",{className:"column tagColumn"},a.createElement("div",{className:"row board-topBar"},a.createElement("div",{className:"row",style:{alignItems:"center"}},a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:r}," 全部")),a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:s},"精华")),a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:o},"保存"))),a.createElement("div",{className:"row",style:{alignItems:"center"}},a.createElement("div",{style:{marginRight:"14rem"}},a.createElement("span",null,"作者")),a.createElement("div",{style:{marginRight:"8rem"}},a.createElement("span",null,"最后回复")))),a.createElement("div",null,t)),a.createElement("div",{className:"listContentBottom"},a.createElement(l.Pager,{page:e,totalPage:this.state.totalPage,url:n}),a.createElement(c.Link,{to:i},a.createElement("div",{className:"boardRecordBtn"},"查看版面事件"))))},t}(m);t.ListTagsContent=C;var I=function(e){function t(t){var n=e.call(this,t)||this;return n.state={boardId:135,totalPage:1,curPage:1,tags:null,data:[]},n}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,o,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return(t=e.match.params.page)||(t=1),n=this.match.params.boardId,[4,s.getBoardRecord(n,20*(t-1),20)];case 1:return a=r.sent(),o=parseInt(((a.count-.5)/20+1).toString()),i=a.boardEvents,[4,s.getBoardTag(this.match.params.boardId)];case 2:return c=r.sent(),this.setState({boardId:n,totalPage:o,curPage:t,tags:c,data:i}),[2]}})})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i;return r.__generator(this,function(r){switch(r.label){case 0:return e=this.match.params.boardId,(t=this.match.params.page)||(t=1),[4,s.getBoardRecord(e,20*(t-1),20)];case 1:return n=r.sent(),a=parseInt(((n.count-.5)/20+1).toString()),o=n.boardEvents,[4,s.getBoardTag(this.match.params.boardId)];case 2:return i=r.sent(),this.setState({boardId:e,totalPage:a,curPage:t,tags:i,data:o}),[2]}})})},t.prototype.convertRecordToElement=function(e){return a.createElement(x,{id:e.id,topicId:e.topicId,boardId:e.boardId,targetUserName:e.targetUserName,operatorUserName:e.operatorUserName,content:e.content,time:e.time,ip:e.ip,isDeleted:e.isDeleted})},t.prototype.render=function(){var e=this.match.params.page?parseInt(this.match.params.page):1,t=this.state.data.map(this.convertRecordToElement),n="/list/"+this.match.params.boardId+"/record/";return a.createElement("div",{className:"listContent "},a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},a.createElement(l.Pager,{page:e,totalPage:this.state.totalPage,url:n})),a.createElement("div",{className:"column tagColumn"},a.createElement("div",{className:"row board-topBar"},a.createElement("div",{className:"row",style:{alignItems:"center"}},a.createElement("div",{className:"listContentTag",style:{alignItems:"center",width:"5rem",textAlign:"center"}},a.createElement("span",null,"对象")),a.createElement("div",{className:"listContentTag",style:{alignItems:"center",width:"46rem",textAlign:"center"}},a.createElement("span",null,"内容")),a.createElement("div",{className:"listContentTag",style:{alignItems:"center",width:"6rem",textAlign:"center"}},a.createElement("span",null,"时间")),a.createElement("div",{className:"listContentTag",style:{alignItems:"center",width:"11rem",textAlign:"center"}},a.createElement("span",null,"操作人")))),a.createElement("div",null,t)),a.createElement(l.Pager,{page:e,totalPage:this.state.totalPage,url:n}))},t}(m);t.BoardRecord=I;var N=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.state={items:[],totalPage:0,tags:[]},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return(e=this.match.params.page)||(e=1),[4,s.getBestTopics(e,this.match.params.boardId)];case 1:return t=r.sent(),[4,s.getBoardTag(this.match.params.boardId)];case 2:return n=r.sent(),a=t.totalPage,this.setState({items:t.boardtopics,totalPage:a,tags:n}),[2]}})})},t.prototype.convertTopicToElement=function(e){return a.createElement(T,{key:e.id,title:e.title,userName:e.userName,id:e.id,userId:e.userId,lastPostTime:e.lastPostTime,lastPostUser:e.lastPostUser,likeCount:e.likeCount,dislikeCount:e.dislikeCount,replyCount:e.replyCount,highlightInfo:e.highlightInfo,topState:e.topState,state:e.state,hitCount:e.hitCount,bestState:e.bestState})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,o;return r.__generator(this,function(r){switch(r.label){case 0:return n=e.match.params.page,t=n?parseInt(n):1,[4,s.getBestTopics(t,e.match.params.boardId)];case 1:return a=r.sent(),o=a.totalPage,this.setState({items:a.boardtopics,totalPage:o}),[2]}})})},t.prototype.render=function(){var e=this.match.params.page?parseInt(this.match.params.page):1,t=null;1!==parseInt(this.match.params.page)&&this.match.params.page||(t=a.createElement("div",null,a.createElement(E,{boardId:this.match.params.boardId})));var n=this.state.items.map(this.convertTopicToElement),r="/list/"+this.match.params.boardId+"/best/",s="/list/"+this.match.params.boardId+"/save/",o="/list/"+this.match.params.boardId+"/",i="/list/"+this.match.params.boardId+"/record/";return a.createElement("div",{className:"listContent "},a.createElement(v,{page:e,totalPage:this.state.totalPage,boardid:this.match.params.boardId,url:r,tag:this.state.tags}),a.createElement("div",{className:"column tagColumn"},a.createElement("div",{className:"row board-topBar"},a.createElement("div",{className:"row",style:{alignItems:"center"}},a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:o},"全部")),a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:r},"精华")),a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:s},"保存"))),a.createElement("div",{className:"row",style:{alignItems:"center"}},a.createElement("div",{style:{marginRight:"14rem"}},a.createElement("span",null,"作者")),a.createElement("div",{style:{marginRight:"8rem"}},a.createElement("span",null,"最后回复")))),t,a.createElement("div",null,n)),a.createElement("div",{className:"listContentBottom"},a.createElement(l.Pager,{page:e,totalPage:this.state.totalPage,url:r}),a.createElement(c.Link,{to:i},a.createElement("div",{className:"boardRecordBtn"},"查看版面事件"))))},t}(m);t.ListBestContent=N;var S=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.state={items:[],totalPage:0,tags:[]},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return(e=this.match.params.page)||(e=1),[4,s.getSaveTopics(e,this.match.params.boardId)];case 1:return t=r.sent(),n=t.totalPage,[4,s.getBoardTag(this.match.params.boardId)];case 2:return a=r.sent(),this.setState({items:t.boardtopics,totalPage:n,tags:a}),[2]}})})},t.prototype.convertTopicToElement=function(e){return a.createElement(T,{key:e.id,title:e.title,userName:e.userName,id:e.id,userId:e.userId,lastPostTime:e.lastPostTime,lastPostUser:e.lastPostUser,likeCount:e.likeCount,dislikeCount:e.dislikeCount,replyCount:e.replyCount,highlightInfo:e.highlightInfo,topState:e.topState,state:e.state,hitCount:e.hitCount,bestState:e.bestState})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return n=e.match.params.page,t=n?parseInt(n):1,[4,s.getSaveTopics(t,e.match.params.boardId)];case 1:return a=r.sent(),this.setState({items:a.boardtopics}),[2]}})})},t.prototype.render=function(){var e=this.match.params.page?parseInt(this.match.params.page):1,t=null;1!==parseInt(this.match.params.page)&&this.match.params.page||(t=a.createElement("div",null,a.createElement(E,{boardId:this.match.params.boardId})));var n=this.state.items.map(this.convertTopicToElement),r="/list/"+this.match.params.boardId+"/best/",s="/list/"+this.match.params.boardId+"/save/",o="/list/"+this.match.params.boardId+"/",i="/list/"+this.match.params.boardId+"/record/";return a.createElement("div",{className:"listContent "},a.createElement(v,{page:e,totalPage:this.state.totalPage,boardid:this.match.params.boardId,url:s,tag:this.state.tags}),a.createElement("div",{className:"column tagColumn"},a.createElement("div",{className:"row board-topBar"},a.createElement("div",{className:"row",style:{alignItems:"center"}},a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:o},"全部")),a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:r},"精华")),a.createElement("div",{className:"listContentTag"},a.createElement(c.Link,{to:s},"保存"))),a.createElement("div",{className:"row",style:{alignItems:"center"}},a.createElement("div",{style:{marginRight:"14rem"}},a.createElement("span",null,"作者")),a.createElement("div",{style:{marginRight:"8rem"}},a.createElement("span",null,"最后回复")))),t,a.createElement("div",null,n)),a.createElement("div",{className:"listContentBottom"},a.createElement(l.Pager,{page:e,totalPage:this.state.totalPage,url:s}),a.createElement(c.Link,{to:i},a.createElement("div",{className:"boardRecordBtn"},"查看版面事件"))))},t}(m);t.ListSaveContent=S;var T=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.state={pager:[]},r}return r.__extends(t,e),t.prototype.componentWillMount=function(){if("number"==typeof this.props.replyCount){var e=this.props.replyCount+1,t=e%10==0?e/10:(e-e%10)/10+1,n=[];if(1===t);else if(t<=7)for(var r=1;r<=t;r++)n.push(r);else n.push(1,2,3,4,-1,t-2,t-1,t);this.props.id;this.setState({pager:n})}},t.prototype.componentDidMount=function(){if("number"==typeof this.props.replyCount){var e="#title"+this.props.id;null!=this.props.highlightInfo&&(1==this.props.highlightInfo.isBold&&$(e).css("font-weight","bold"),1==this.props.highlightInfo.isItalic&&$(e).css("font-style","italic"),null!=this.props.highlightInfo.color&&$(e).css("color",this.props.highlightInfo.color))}},t.prototype.generateListPager=function(e){var t="/topic/"+this.props.id+"/"+e;return-1!=e?a.createElement("div",{style:{marginRight:"0.3rem"}},a.createElement(c.Link,{style:{color:"#79b8ca"},to:t},e)):a.createElement("div",{style:{marginRight:"0.3rem"}},"...")},t.prototype.render=function(){if("number"==typeof this.props.replyCount){var e=void 0;e=0===this.props.topState?"changeColor":"changeTopColor";var t="topic"+this.props.id,n="/topic/"+this.props.id,r="title"+this.props.id,o=void 0,i=void 0;i=s.getLocalStorage("userInfo")?s.getLocalStorage("userInfo").name:"",0===this.props.topState&&(o=a.createElement("div",{style:{width:"1rem",justifyContent:"flex-start"}},a.createElement("i",{style:{color:"#B0B0B0"},className:"fa fa-envelope fa-lg"}))),i===this.props.userName&&(o=a.createElement("div",{style:{width:"1rem",justifyContent:"flex-start"}},a.createElement("i",{style:{color:"#FFC90E"},className:"fa fa-envelope fa-lg"}))),this.props.replyCount>100&&0===this.props.topState&&(o=a.createElement("div",{style:{width:"1rem",justifyContent:"flex-start"}},a.createElement("i",{style:{color:"red"},className:"fa fa-envelope-open fa-lg"}))),1===this.props.state&&(o=a.createElement("div",{style:{width:"1rem",justifyContent:"flex-start"}},a.createElement("i",{style:{color:"#B0B0B0"},className:"fa fa-lock fa-lg"})));var l=this.props.hitCount;this.props.hitCount>1e5?l=((this.props.hitCount-this.props.hitCount%1e4)/1e4).toString()+"万":this.props.hitCount>1e4&&(l=(this.props.hitCount/1e4).toFixed(1).toString()+"万"),1===this.props.bestState&&(o=a.createElement("div",{style:{width:"1rem",justifyContent:"flex-start"}},a.createElement("i",{style:{color:"#FF1493"},className:"fa fa-star fa-lg"}))),2===this.props.topState?o=a.createElement("div",{style:{width:"1rem",justifyContent:"flex-start"}},a.createElement("i",{style:{color:"orange"},className:"fa fa-chevron-circle-up fa-lg"})):4===this.props.topState&&(o=a.createElement("div",{style:{width:"1rem",justifyContent:"flex-start"}},a.createElement("i",{style:{color:"red"},className:"fa fa-arrow-circle-up fa-lg"})));var u="#000",d="normal",p="normal";return this.props.highlightInfo&&(this.props.highlightInfo.isBold&&(d="bold"),this.props.highlightInfo.isItalic&&(p="italic"),this.props.highlightInfo.color&&(u=this.props.highlightInfo.color)),a.createElement("div",{id:e},a.createElement(c.Link,{to:n},a.createElement("div",{className:"rofw topicInList",id:t},a.createElement("div",{className:"listTitleAndPager"},a.createElement("div",{className:"row listTitleAndIcon"},o,a.createElement("div",{className:"listTitle",id:r,style:{marginLeft:"1rem",color:u,fontWeight:d,fontStyle:p}}," ",this.props.title)),a.createElement("div",{style:{display:"flex",fontSize:"0.75rem",marginLeft:"1rem",width:"auto"}},this.state.pager.map(this.generateListPager.bind(this)))),a.createElement("div",{className:"row",style:{width:"28rem",flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between",fontSize:"0.75rem",marginBottom:"-4px"}},a.createElement("div",{style:{width:"7.5rem",textAlign:"left"}}," ",a.createElement("span",null,this.props.userName||"匿名")),a.createElement("div",{className:"row topicIcon"},a.createElement("div",{id:"disliked",style:{display:"flex",width:"4.5rem"}},a.createElement("i",{className:"fa fa-eye fa-lg"}),a.createElement("span",{className:"timeProp tagSize"},l)),a.createElement("div",{id:"commentsAmount",style:{display:"flex",width:"3.5rem"}},a.createElement("i",{className:"fa fa-commenting-o fa-lg"}),a.createElement("span",{className:"timeProp tagSize"},this.props.replyCount))),a.createElement("div",{className:"lastReply"},a.createElement("span",null,this.props.lastPostUser,"/",moment(this.props.lastPostTime).format("YY-MM-DD HH:mm")))))))}return this.props,null},t}(a.Component);t.TopicTitleAndContent=T;var x=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.ipOver=r.ipOver.bind(r),r.ipOut=r.ipOut.bind(r),r}return r.__extends(t,e),t.prototype.ipOver=function(){"*"!==this.props.ip&&(this.props.ip,$("#ip_"+this.props.id).removeClass("displaynone"))},t.prototype.ipOut=function(){$("#ip_"+this.props.id).addClass("displaynone")},t.prototype.render=function(){var e;return e=this.props.targetUserName?a.createElement("a",{href:"/user/name/"+this.props.targetUserName,target:"_blank"},this.props.targetUserName):"匿名用户",a.createElement("div",{className:"boardRecord",id:"changeColor"},a.createElement("div",{className:"boardRecord-1"},e),a.createElement("div",{className:"boardRecord-2"},a.createElement("a",{href:"/topic/"+this.props.topicId,target:"_blank"},this.props.content)),a.createElement("div",{className:"boardRecord-3"},moment(this.props.time).format("YY-MM-DD HH:mm")),a.createElement("div",{className:"boardRecord-4",onMouseOver:this.ipOver,onMouseOut:this.ipOut},a.createElement("a",{href:"/user/name/"+this.props.operatorUserName,target:"_blank"},this.props.operatorUserName)),a.createElement("div",{className:"boardRecord-ip displaynone",id:"ip_"+this.props.id},this.props.ip))},t}(a.Component);t.BoardRecordContent=x},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAction=function(e,t){return t||function(){return{type:e}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(15),o=n(83),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){this.props.location.pathname!==e.location.pathname&&this.props.solveError()},t.prototype.render=function(){return null},t}(a.Component);t.default=s.connect(function(e){return{isError:e.error.isError}},function(e){return{solveError:function(){e(o.solveError())}}})(i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(66),o=n(4),i=n(6),c=n(16),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},a.createElement(i.Link,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),a.createElement("i",{className:"fa fa-chevron-right"}),a.createElement("div",{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"}},"历史上的今天"))},t}(a.Component);function u(e){return a.createElement(s.FocusTopicSingle,{title:e.title,hitCount:e.hitCount,id:e.id,boardId:e.boardId,boardName:e.boardName,replyCount:e.replyCount,userId:e.userId,userName:e.userName,portraitUrl:e.portraitUrl,time:e.time,likeCount:e.likeCount,dislikeCount:e.dislikeCount,lastPostUser:e.lastPostUser,lastPostTime:e.lastPostTime,tag1:e.tag1,tag2:e.tag2,floorCount:e.floorCount})}t.Category=l;var d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={data:[],from:0,loading:!0,buttonClassName:""},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return o.refreshHoverUnReadCount(),[4,o.getMonthlyHotTopic("history")];case 1:return e=t.sent(),this.setState({data:e}),[2]}})})},t.prototype.render=function(){return a.createElement("div",{className:"focus-root"},a.createElement(c.default,{title:"历史上的今天 - CC98论坛"}),a.createElement("div",{className:"focus"},a.createElement(l,null),a.createElement("div",{className:"focus-topic-area"},a.createElement("div",{className:"focus-topic-topicArea"},this.state.data.map(u)))))},t}(a.Component);t.HistoryHotTopic=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(66),o=n(4),i=n(6),c=n(16),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},a.createElement(i.Link,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),a.createElement("i",{className:"fa fa-chevron-right"}),a.createElement("div",{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"}},"7日热门话题"))},t}(a.Component);function u(e){return a.createElement(s.FocusTopicSingle,{title:e.title,hitCount:e.hitCount,id:e.id,boardId:e.boardId,boardName:e.boardName,replyCount:e.replyCount,userId:e.userId,userName:e.userName,portraitUrl:e.portraitUrl,time:e.time,likeCount:e.likeCount,dislikeCount:e.dislikeCount,lastPostUser:e.lastPostUser,lastPostTime:e.lastPostTime,tag1:e.tag1,tag2:e.tag2,floorCount:e.floorCount})}t.Category=l;var d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={data:[],from:0,loading:!0,buttonClassName:""},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return o.refreshHoverUnReadCount(),[4,o.getMonthlyHotTopic("weekly")];case 1:return e=t.sent(),this.setState({data:e}),[2]}})})},t.prototype.render=function(){return a.createElement("div",{className:"focus-root"},a.createElement(c.default,{title:"7日热门话题 - CC98论坛"}),a.createElement("div",{className:"focus"},a.createElement(l,null),a.createElement("div",{className:"focus-topic-area"},a.createElement("div",{className:"focus-topic-topicArea"},this.state.data.map(u)))))},t}(a.Component);t.WeeklyHotTopic=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(66),o=n(4),i=n(6),c=n(16),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},a.createElement(i.Link,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),a.createElement("i",{className:"fa fa-chevron-right"}),a.createElement("div",{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"}},"30日热门话题"))},t}(a.Component);function u(e){return a.createElement(s.FocusTopicSingle,{title:e.title,hitCount:e.hitCount,id:e.id,boardId:e.boardId,boardName:e.boardName,replyCount:e.replyCount,userId:e.userId,userName:e.userName,portraitUrl:e.portraitUrl,time:e.time,likeCount:e.likeCount,dislikeCount:e.dislikeCount,lastPostUser:e.lastPostUser,lastPostTime:e.lastPostTime,tag1:e.tag1,tag2:e.tag2,floorCount:e.floorCount})}t.Category=l;var d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={data:[],from:0,loading:!0,buttonClassName:""},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return o.refreshHoverUnReadCount(),[4,o.getMonthlyHotTopic("monthly")];case 1:return e=t.sent(),this.setState({data:e}),[2]}})})},t.prototype.render=function(){return a.createElement("div",{className:"focus-root"},a.createElement(c.default,{title:"30日热门话题 - CC98论坛"}),a.createElement("div",{className:"focus"},a.createElement(l,null),a.createElement("div",{className:"focus-topic-area"},a.createElement("div",{className:"focus-topic-topicArea"},this.state.data.map(u)))))},t}(a.Component);t.MonthlyHotTopic=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(34),i=n(6),c=n(80),l=n(106),u=n(70),d=n(74),p=n(83),m=function(e){function t(t){var n=e.call(this,t)||this;return n.update=n.update.bind(n),n.changeEditor=n.changeEditor.bind(n),n.sendMdTopic=n.sendMdTopic.bind(n),n.sendUbbTopic=n.sendUbbTopic.bind(n),n.editUBB=n.editUBB.bind(n),n.changeAcademicType=n.changeAcademicType.bind(n),n.changeActivityType=n.changeActivityType.bind(n),n.changeNormalType=n.changeNormalType.bind(n),n.state={masters:[],tags:[],boardName:"",ready:!1,mode:0,content:"",title:"",postInfo:{floor:0,title:"",content:"",contentType:0},tag1:"",tag2:"",fetchState:"ok",boardId:1,type:0,topicInfo:{}},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i,c,l,u,d,p,m,h,f,g;return r.__generator(this,function(r){switch(r.label){case 0:return e=this.match.params.mode,t=this.match.params.id,[4,s.getToken()];case 1:switch(n=r.sent(),(a=new Headers).append("Authorization",n),e){case"postTopic":return[3,2];case"edit":return[3,6]}return[3,16];case 2:return o="/Board/"+t,[4,s.cc98Fetch(o,{headers:a})];case 3:return[4,(i=r.sent()).json()];case 4:return c=r.sent(),u=c.name,[4,s.getBoardTag(t)];case 5:return l=r.sent(),this.setState({boardName:u,tags:l,boardId:t,masters:c.boardMasters}),[3,16];case 6:return o="/post/"+t+"/original",[4,s.cc98Fetch(o,{headers:a})];case 7:return 403===(i=r.sent()).status&&this.setState({fetchState:"not allowed"}),[4,i.json()];case 8:return c=r.sent(),[4,s.getTopicInfo(c.topicId)];case 9:return d=r.sent(),[4,s.getTagNamebyId(d.tag1)];case 10:return(p=r.sent())||(p=""),[4,s.getTagNamebyId(d.tag2)];case 11:return(m=r.sent())||(m=""),h=d.type,[4,s.getBoardTag(c.boardId)];case 12:return l=r.sent(),s.setLocalStorage("contentCache",c.content),s.getLocalStorage("contentCache"),o="/Board/"+c.boardId,[4,s.cc98Fetch(o,{headers:a})];case 13:return[4,(i=r.sent()).json()];case 14:return f=r.sent().boardMasters,s.isMaster(f)||-1!==(s.getLocalStorage("userInfo").userTitleIds||[]).indexOf(91)||1!==h||(h=0),[4,s.getBoardName(c.boardId)];case 15:return g=r.sent(),0===c.contentType?this.setState({masters:f,postInfo:c,content:c.content,title:c.title,boardName:g,boardId:c.boardId,type:h,tags:l,topicInfo:d,tag1:p,tag2:m,mode:0}):this.setState({masters:f,postInfo:c,content:c.content,title:c.title,boardName:g,boardId:c.boardId,type:h,tags:l,topicInfo:d,tag1:p,tag2:m,mode:1}),[3,16];case 16:return[2]}})})},t.prototype.changeNormalType=function(){this.setState({type:0})},t.prototype.changeAcademicType=function(){this.setState({type:2})},t.prototype.changeActivityType=function(){this.setState({type:1})},t.prototype.ready=function(){this.setState({ready:!0})},t.prototype.changeEditor=function(){0===this.state.mode?this.setState({mode:1}):this.setState({mode:0})},t.prototype.update=function(e){this.setState({content:e})},t.prototype.sendMdTopic=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i,c,l,d,p,m,h,f,g;return r.__generator(this,function(r){switch(r.label){case 0:return""!=this.state.title?[3,1]:(alert("请输入标题!"),[3,10]);case 1:return r.trys.push([1,9,,10]),e=void 0,t=void 0,n="/board/"+this.match.params.id+"/topic",a=u.Constants.testEditor.getMarkdown(),o=void 0,this.state.type,[4,s.getTagIdbyName(this.state.tag1)];case 2:return e=r.sent(),[4,s.getTagIdbyName(this.state.tag2)];case 3:return t=r.sent(),o=e&&!t?{content:a,contentType:1,title:this.state.title,tag1:e,type:this.state.type}:t?{content:a,contentType:1,title:this.state.title,tag1:e,tag2:t,type:this.state.type}:{content:a,contentType:1,title:this.state.title,type:this.state.type},i=JSON.stringify(o),[4,s.getToken()];case 4:return c=r.sent(),(l=new Headers).append("Authorization",c),l.append("Content-Type","application/json"),[4,s.cc98Fetch(n,{method:"POST",headers:l,body:i})];case 5:return 402===(d=r.sent()).status&&alert("请输入内容"),[4,d.text()];case 6:return p=r.sent(),(m=s.atHanderler(a))?(h=JSON.stringify(m),f="/notification/at?topicid="+p,(g=new Headers).append("Content-Type","application/json"),g.append("Authorization",c),[4,s.cc98Fetch(f,{method:"POST",headers:g,body:h})]):[3,8];case 7:r.sent(),r.label=8;case 8:return s.removeLocalStorage("contentCache"),this.props.history.push("/topic/"+p),[3,10];case 9:return r.sent(),[3,10];case 10:return[2]}})})},t.prototype.sendUbbTopic=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i,c,l,u,m,h,f;return r.__generator(this,function(r){switch(r.label){case 0:return""!=this.state.title?[3,1]:(alert("请输入标题！"),[3,10]);case 1:return e="/board/"+this.match.params.id+"/topic",t=void 0,n=void 0,a=void 0,this.state.type,[4,s.getTagIdbyName(this.state.tag1)];case 2:return n=r.sent(),[4,s.getTagIdbyName(this.state.tag2)];case 3:return a=r.sent(),t=n&&!a?{content:this.state.content,contentType:0,title:this.state.title,tag1:n,type:this.state.type}:a?{content:this.state.content,contentType:0,title:this.state.title,tag1:n,tag2:a,type:this.state.type}:{content:this.state.content,contentType:0,title:this.state.title,type:this.state.type},o=JSON.stringify(t),[4,s.getToken()];case 4:return i=r.sent(),(c=new Headers).append("Authorization",i),c.append("Content-Type","application/json"),[4,s.cc98Fetch(e,{method:"POST",headers:c,body:o})];case 5:return[4,r.sent().text()];case 6:return"cannot_post_in_this_board"!==(l=r.sent())?[3,7]:(d.default.dispatch(p.throwError("CannotPost")),[3,10]);case 7:return(u=s.atHanderler(this.state.content))?(m=JSON.stringify(u),h="/notification/at?topicid="+l,(f=new Headers).append("Content-Type","application/json"),f.append("Authorization",i),[4,s.cc98Fetch(h,{method:"POST",headers:f,body:m})]):[3,9];case 8:r.sent(),r.label=9;case 9:s.removeLocalStorage("contentCache"),this.props.history.push("/topic/"+l),r.label=10;case 10:return[2]}})})},t.prototype.editUBB=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i,c,l,u,d;return r.__generator(this,function(r){switch(r.label){case 0:return e="/post/"+this.match.params.id,[4,s.getTagIdbyName(this.state.tag1)];case 1:return t=r.sent(),[4,s.getTagIdbyName(this.state.tag2)];case 2:return n=r.sent(),a=t&&!n?{content:this.state.content,contentType:0,title:this.state.title,tag1:t,type:this.state.type}:n?{content:this.state.content,contentType:0,title:this.state.title,tag1:t,tag2:n,type:this.state.type}:{content:this.state.content,contentType:0,title:this.state.title,type:this.state.type},o=JSON.stringify(a),[4,s.getToken()];case 3:return r.sent(),[4,s.formAuthorizeHeader()];case 4:return(i=r.sent()).append("Content-Type","application/json"),[4,s.cc98Fetch(e,{method:"PUT",headers:i,body:o})];case 5:return r.sent(),c=this.state.postInfo.floor,l=c%10==0?10:c%10,u=c%10==0?c/10:(c-c%10)/10+1,s.removeLocalStorage("contentCache"),d="/topic/"+this.state.postInfo.topicId+"/"+u+"#"+l,this.props.history.push(d),[2]}})})},t.prototype.editMd=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i,c,l,d,p,m;return r.__generator(this,function(r){switch(r.label){case 0:return e="/post/"+this.match.params.id,t=u.Constants.testEditor.getMarkdown(),u.Constants.testEditor.setMarkdown(""),[4,s.getTagIdbyName(this.state.tag1)];case 1:return a=r.sent(),[4,s.getTagIdbyName(this.state.tag2)];case 2:return o=r.sent(),!a||o?[3,4]:[4,s.getTagIdbyName(this.state.tag1)];case 3:return a=r.sent(),n={content:t,contentType:1,title:this.state.title,tag1:a,type:this.state.type},[3,5];case 4:n=o?{content:t,contentType:1,title:this.state.title,tag1:a,tag2:o,type:this.state.type}:{content:t,contentType:1,title:this.state.title,type:this.state.type},r.label=5;case 5:return i=JSON.stringify(n),[4,s.getToken()];case 6:return r.sent(),[4,s.formAuthorizeHeader()];case 7:return(c=r.sent()).append("Content-Type","application/json"),[4,s.cc98Fetch(e,{method:"PUT",headers:c,body:i})];case 8:return r.sent(),l=this.state.postInfo.floor,d=l%10==0?10:l%10,p=l%10==0?l/10:(l-l%10)/10+1,m="/topic/"+this.state.postInfo.topicId+"/"+p+"#"+d,s.removeLocalStorage("contentCache"),this.props.history.push(m),[2]}})})},t.prototype.onTitleChange=function(e,t,n){""!=e?this.setState({title:e,tag1:t,tag2:n}):this.setState({tag1:t,tag2:n})},t.prototype.onUbbChange=function(e){this.setState({content:e})},t.prototype.render=function(){var e=s.getLocalStorage("contentCache");this.state.mode,this.state.content;var t,n=this.match.params.mode,r=this.match.params.id,o="/list/"+this.state.boardId,i=null;"postTopic"===n?(i=a.createElement(g,{boardId:r,tags:this.state.tags,onChange:this.onTitleChange.bind(this),title:this.state.postInfo.title,tag1:0,tag2:0}),t=0===this.state.mode?a.createElement("div",null,a.createElement("div",{className:"createTopicContent"},a.createElement("div",{className:"createTopicListName"},"主题内容"),a.createElement("div",{id:"post-topic-changeMode",onClick:this.changeEditor,className:"hiddenImage",style:{width:"12rem",marginBottom:"0.5rem"}},"切换到Markdown编辑器")),a.createElement(l.UbbEditor,{update:this.update,value:this.state.content,option:{height:20,submit:this.sendUbbTopic.bind(this)}}),a.createElement("div",{className:"row",style:{justifyContent:"center"}},a.createElement("div",{id:"post-topic-button",onClick:this.sendUbbTopic.bind(this),className:"button blue",style:{marginTop:"1.25rem",marginBottom:"1.25rem",width:"4.5rem",letterSpacing:"0.3125rem",alignSelf:"center"}},"发帖"))):a.createElement("div",null,a.createElement("div",{className:"createTopicContent"},a.createElement("div",{className:"createTopicListName"},"主题内容"),a.createElement("div",{id:"post-topic-changeMode",onClick:this.changeEditor,className:"hiddenImage",style:{width:"12rem",marginBottom:"0.5rem"}},"切换到UBB编辑器")),a.createElement(y,{postInfo:this.state.postInfo,content:e,onChange:this.sendMdTopic.bind(this),ready:this.state.ready,mode:this.match.params.mode}))):"edit"===n&&(0===this.state.mode?t=a.createElement("div",null,a.createElement("div",{className:"createTopicContent"},a.createElement("div",{className:"createTopicListName"},"主题内容"),a.createElement("div",{id:"post-topic-changeMode",onClick:this.changeEditor,className:"hiddenImage",style:{width:"12rem",marginBottom:"0.5rem"}},"切换到Markdown编辑器")),a.createElement(l.UbbEditor,{update:this.update,value:this.state.content,option:{submit:this.editUBB.bind(this)}}),a.createElement("div",{className:"row",style:{justifyContent:"center"}},a.createElement("div",{id:"post-topic-button",onClick:this.editUBB,className:"button blue",style:{marginTop:"1.25rem",marginBottom:"1.25rem",width:"4.5rem",letterSpacing:"0.3125rem",alignSelf:"center"}},"编辑"))):1===this.state.mode&&(t=a.createElement("div",null,a.createElement("div",{className:"createTopicContent"},a.createElement("div",{className:"createTopicListName"},"主题内容"),a.createElement("div",{id:"post-topic-changeMode",onClick:this.changeEditor,className:"hiddenImage",style:{width:"12rem",marginBottom:"0.5rem"}},"切换到UBB编辑器")),a.createElement(y,{postInfo:this.state.postInfo,content:e,onChange:this.editMd.bind(this),ready:this.state.ready,mode:this.match.params.mode}))),1===this.state.postInfo.floor&&(i=a.createElement(g,{boardId:r,tags:this.state.tags,onChange:this.onTitleChange.bind(this),title:this.state.postInfo.title,tag1:this.state.topicInfo.tag1,tag2:this.state.topicInfo.tag2}))),this.state.type;var c=a.createElement("div",{className:"createTopicType"},a.createElement("div",{className:"createTopicListName"},"发帖类型"),a.createElement("input",{type:"radio",name:"type",value:"普通",onClick:this.changeNormalType,checked:0===this.state.type})," 普通",a.createElement("input",{type:"radio",name:"type",value:"学术信息",onClick:this.changeAcademicType,checked:2===this.state.type})," 学术信息",a.createElement("div",{style:{color:"rgb(255,0,0)"}},"（活动帖和学术贴请选择正确的发帖类型)"));return s.isMaster(this.state.masters),(s.isMaster(this.state.masters)||-1!==(s.getLocalStorage("userInfo").userTitleIds||[]).indexOf(91))&&(c=a.createElement("div",{className:"createTopicType"},a.createElement("div",{className:"createTopicListName"},"发帖类型"),a.createElement("input",{type:"radio",name:"type",value:"普通",onClick:this.changeNormalType,checked:0===this.state.type})," 普通",a.createElement("input",{type:"radio",name:"type",value:"学术信息",onClick:this.changeAcademicType,checked:2===this.state.type})," 学术信息",a.createElement("input",{type:"radio",name:"type",value:"校园活动",onClick:this.changeActivityType,checked:1===this.state.type})," 校园活动",a.createElement("div",{style:{color:"rgb(255,0,0)"}},"（活动帖和学术贴请选择正确的发帖类型)"))),1!==this.state.postInfo.floor&&"edit"===n&&(c=null),a.createElement("div",{className:"createTopic"},a.createElement(h,{url:o,boardName:this.state.boardName,mode:n}),i,c,t)},t}(c.RouteComponent);t.Edit=m;var h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={url:"",boardName:""},n}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){this.setState({url:e.url,boardName:e.boardName})},t.prototype.render=function(){var e;return"postTopic"===this.props.mode?e="发表主题":"edit"===this.props.mode&&(e="编辑主题"),a.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},a.createElement(i.Link,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),a.createElement("i",{className:"fa fa-chevron-right"}),a.createElement(i.Link,{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"},to:this.state.url},this.state.boardName),a.createElement("i",{className:"fa fa-chevron-right"}),a.createElement("div",{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"}},e))},t}(a.Component);t.Category=h;var f=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",null)},t}(a.Component);t.Tags=f;var g=function(e){function t(t){var n=e.call(this,t)||this;return n.bindEvent=function(){return r.__awaiter(n,void 0,void 0,function(){var e,t,n,a,i,c,l,u,d,p;return r.__generator(this,function(r){switch(r.label){case 0:return 0===(e=o(".tagBoxSelect")).length?[2]:(this.setState({hasEvent:!0}),t=o(".downArrow"),n=o(".tagBoxSub"),a=n.find("li"),o(document).click(function(){n.css("display","none")}),e.click(function(){return"block"===n.css("display")?n.css("display","none"):n.css("display","block"),!1}),t.click(function(){return"block"===n.css("display")?n.css("display","none"):n.css("display","block"),!1}),a.click(function(){e.text(o(this).text())}),a.mouseover(function(){this.className="hover"}),a.mouseout(function(){this.className=""}),i=o(".tagBoxSelect1"),c=o(".downArrow1"),l=o(".tagBoxSub1"),u=l.find("li"),o(document).click(function(){l.css("display","none")}),i.click(function(){return"block"===l.css("display")?l.css("display","none"):l.css("display","block"),!1}),c.click(function(){return"block"===l.css("display")?l.css("display","none"):l.css("display","block"),!1}),u.click(function(){i.text(o(this).text())}),u.mouseover(function(){this.className="hover"}),u.mouseout(function(){this.className=""}),d="",p="",0===this.props.tag1?[3,2]:[4,s.getTagNamebyId(this.props.tag1)]);case 1:d=r.sent(),r.label=2;case 2:return 0===this.props.tag2?[3,4]:[4,s.getTagNamebyId(this.props.tag2)];case 3:p=r.sent(),r.label=4;case 4:return this.props.title&&!this.state.title?this.setState({title:this.props.title,tags:this.props.tags,tag1:d,tag2:p}):this.setState({tags:this.props.tags,tag1:d,tag2:p}),[2]}})})},n.handleTagChange=n.handleTagChange.bind(n),n.handleTitleChange=n.handleTitleChange.bind(n),n.generateTagOption=n.generateTagOption.bind(n),n.state={title:n.props.title,tags:n.props.tags,tag1:"",tag2:"",hasEvent:!1},n}return r.__extends(t,e),t.prototype.handleTitleChange=function(e){var t,n;0===this.state.tags.length?(this.props.onChange(e.target.value,"",""),this.setState({title:e.target.value})):1===this.state.tags.length?(t=o(".tagBoxSelect").text(),this.props.onChange(e.target.value,t,""),this.setState({title:e.target.value})):(t=o(".tagBoxSelect").text(),n=o(".tagBoxSelect1").text(),this.props.onChange(e.target.value,t,n),this.setState({title:e.target.value}))},t.prototype.handleTagChange=function(){var e=o(".tagBoxSelect").text(),t=o(".tagBoxSelect1").text();this.props.onChange("",e,t)},t.prototype.componentWillReceiveProps=function(e){e.title&&!this.state.title?this.setState({title:e.title,tags:e.tags}):this.setState({tags:e.tags})},t.prototype.componentDidMount=function(){this.state.tags.length>0&&this.bindEvent()},t.prototype.componentDidUpdate=function(){this.state.hasEvent||this.bindEvent()},t.prototype.generateTagOption=function(e){return a.createElement("li",{onClick:this.handleTagChange},e.name)},t.prototype.render=function(){var e=null,t=null;this.state.tags.length>0&&(e=a.createElement("ul",{className:"tagBoxSub"},this.state.tags[0].tags.map(this.generateTagOption))),2===this.state.tags.length&&(t=a.createElement("ul",{className:"tagBoxSub1"},this.state.tags[1].tags.map(this.generateTagOption)));var n=null;if(2===this.state.tags.length){var r=this.state.tags[0].tags[0].name,s=this.state.tags[1].tags[0].name;this.state.tag1&&(r=this.state.tag1),this.state.tag2&&(s=this.state.tag2),n=a.createElement("div",{className:"row"},a.createElement("div",{className:"column",style:{marginTop:"6.1rem",height:"8rem",zindex:"1000",marginLeft:"0.5rem"}},a.createElement("div",{style:{display:"flex"}},a.createElement("div",{className:"tagBoxSelect"},r),a.createElement("div",{className:"downArrow"},a.createElement("img",{src:"/static/images/downArrow.png",width:"12",height:"12"}))),e),a.createElement("div",{className:"column",style:{marginTop:"6.1rem",height:"8rem",zindex:"1000",marginLeft:"0.5rem"}},a.createElement("div",{style:{display:"flex"}},a.createElement("div",{className:"tagBoxSelect1"},s),a.createElement("div",{className:"downArrow1"},a.createElement("img",{src:"/static/images/downArrow.png",width:"12",height:"12"}))),t))}else if(1==this.state.tags.length){r=this.state.tags[0].tags[0].name;this.state.tag1&&(r=this.state.tag1),n=a.createElement("div",{className:"column",style:{marginTop:"6.1rem",height:"8rem",zindex:"1000",marginLeft:"0.5rem"}},a.createElement("div",{style:{display:"flex"}},a.createElement("div",{className:"tagBoxSelect"},r),a.createElement("div",{className:"downArrow"},a.createElement("img",{src:"/static/images/downArrow.png",width:"12",height:"12"}))),e)}return a.createElement("div",{className:"createTopicTitle"},a.createElement("div",{className:"createTopicListName"},"主题标题"),n,a.createElement("input",{value:this.state.title,placeholder:"请输入新主题的标题",onChange:this.handleTitleChange.bind(this)}))},t}(a.Component);t.InputTitle=g;var v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"createTopicOption"},a.createElement("div",{className:"createTopicListName"},"选项"),a.createElement("input",{type:"radio",checked:!0,name:"option",value:"all"}),"回复所有人可见",a.createElement("input",{type:"radio",name:"option",value:"host"}),"回复仅楼主可见",a.createElement("input",{type:"radio",name:"option",value:"special"}),"回复仅特定用户可见")},t}(a.Component);t.Options=v;var y=function(e){function t(t){var n=e.call(this,t)||this;return n.state={content:""},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e="";this.props.postInfo.content&&(e=this.props.content),editormd.emoji.path="/static/images/emoji/",u.Constants.testEditor=editormd("testEditor",{width:"100%",height:450,path:"/static/scripts/lib/editor.md/lib/",saveHTMLToTextarea:!1,emoji:!0,appendMarkdown:e,toc:!0,tocm:!0,toolbarIcons:function(){return["undo","redo","|","emoji","bold","del","italic","quote","|","h1","h2","h3","h4","|","list-ul","list-ol","hr","|","link","testIcon","image","code","table","html-entities"]},toolbarIconsClass:{testIcon:"fa-upload"},toolbarHandlers:{testIcon:function(e,t,n,r){o("#upload-files").click()}}}),this.setState({})},t.prototype.send=function(){var e=u.Constants.testEditor.getMarkdown();this.props.onChange(e)},t.prototype.render=function(){return a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column"}},a.createElement("div",{id:"sendTopic"},a.createElement("form",null,a.createElement("input",{type:"file",id:"upload-files",style:{display:"none "},onChange:s.uploadEvent}),a.createElement("div",{id:"testEditor",className:"editormd"},a.createElement("textarea",{className:"editormd-markdown-textarea",name:"testEditor-markdown-doc"}))),a.createElement("div",{className:"row",style:{justifyContent:"center",marginBottom:"1.25rem "}},a.createElement("div",{id:"post-topic-button",className:"button blue",style:{marginTop:"1.25rem",width:"4.5rem",letterSpacing:"0.3125rem"},onClick:this.send.bind(this)},"postTopic"===this.props.mode?"发帖":"编辑"))))},t}(a.Component);t.InputMdContent=y,t.ShowEdit=i.withRouter(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=["推荐阅读","推荐功能","校园新闻","广告"],i=["/index/column/recommandationreading","/index/column/recommandationfunction","/index/column/schoolnews","/config/global/advertisement"],c=function(){return function(){}}(),l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={info:"",data:[],type:0},n.getInfo=n.getInfo.bind(n),n.putCurData=n.putCurData.bind(n),n.handleTdChange=n.handleTdChange.bind(n),n.add=n.add.bind(n),n}return r.__extends(t,e),t.prototype.getInfo=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,o;return r.__generator(this,function(r){switch(r.label){case 0:this.setState({type:i.indexOf(e)+1,data:[]}),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,s.getToken()];case 2:return t=r.sent(),(n=new Headers).append("Authorization",t),[4,s.cc98Fetch(e+"/all",{headers:n})];case 3:return[4,r.sent().json()];case 4:return a=r.sent(),this.setState({data:a}),[3,6];case 5:return o=r.sent(),this.setState({info:o.message}),[3,6];case 6:return[2]}})})},t.prototype.handleTdChange=function(e,t,n){var a=this;this.setState(function(s){var o,i=s.data;i[n]=r.__assign({},i[n],((o={})[e]=t,o)),a.setState({data:i})})},t.prototype.putCurData=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,o,i,c;return r.__generator(this,function(r){switch(r.label){case 0:this.state.data[e].isNew?(t="/index/column/",n="POST"):(t="/index/column/"+this.state.data[e].id,n="PUT"),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,s.getToken()];case 2:return a=r.sent(),(o=new Headers).append("Authorization",a),o.append("Content-Type","application/json"),[4,s.cc98Fetch(t,{method:n,headers:o,body:JSON.stringify(this.state.data[e])})];case 3:if(200!==(i=r.sent()).status)throw new Error(i.status.toString());return this.setState({info:"修改成功"}),[3,5];case 4:return c=r.sent(),this.setState({info:c.message}),[3,5];case 5:return[2]}})})},t.prototype.add=function(){this.setState(function(e){var t=new c;return t.enable=!0,t.isNew=!0,t.type=e.type,t.id=e.data[0].id+1,{data:[t].concat(e.data)}})},t.prototype.render=function(){var e=this;return a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},a.createElement("div",{style:{display:"flex",justifyContent:"space-around",alignItems:"center",width:"100%",marginBottom:"1rem"}},a.createElement("div",{style:{marginTop:"10px"}},"自定义栏目"),a.createElement("div",null,a.createElement("button",{type:"button",className:"hiddenImage",disabled:1===this.state.type,onClick:function(){return e.getInfo(i[0])}},"推荐阅读")),a.createElement("div",null,a.createElement("button",{type:"button",className:"hiddenImage",disabled:2===this.state.type,onClick:function(){return e.getInfo(i[1])}},"推荐功能")),a.createElement("div",null,a.createElement("button",{type:"button",className:"hiddenImage",disabled:3===this.state.type,onClick:function(){return e.getInfo(i[2])}},"校园新闻")),a.createElement("div",null,a.createElement("button",{type:"button",className:"hiddenImage",disabled:4===this.state.type,onClick:function(){return e.getInfo(i[3])}},"广告")),this.state.type>0?a.createElement("div",null,a.createElement("button",{className:"hiddenImage",type:"button",onClick:function(){return e.add()}},"添加")):null),a.createElement("div",null,this.state.data.length>0?a.createElement("table",null,a.createElement("tbody",null,a.createElement("tr",null,a.createElement("th",null,"id"),a.createElement("th",null,"type"),a.createElement("th",null,"title"),1===this.state.type?a.createElement("th",null,"content"):null,a.createElement("th",null,"url"),3!==this.state.type?a.createElement("th",null,"imageUrl"):null,1===this.state.type||2===this.state.type?a.createElement("th",null,"orderWeight"):null,a.createElement("th",null,"enable"),4===this.state.type?a.createElement("th",null,"days"):null,4===this.state.type?a.createElement("th",null,"expiredTime"):null,a.createElement("th",null,"save")),this.state.data.map(function(t,n){return a.createElement("tr",{key:t.id},a.createElement("td",null,t.id),a.createElement("td",null,o[t.type-1]),a.createElement("td",null,a.createElement("input",{type:"text",onChange:function(t){return e.handleTdChange("title",t.target.value,n)},value:t.title})),1===e.state.type?a.createElement("td",null,a.createElement("input",{type:"text",onChange:function(t){return e.handleTdChange("content",t.target.value,n)},value:t.content})):null,a.createElement("td",null,a.createElement("input",{type:"text",onChange:function(t){return e.handleTdChange("url",t.target.value,n)},value:t.url})),3!==e.state.type?a.createElement("td",null,a.createElement("input",{type:"text",onChange:function(t){return e.handleTdChange("imageUrl",t.target.value,n)},value:t.imageUrl})):null,1===e.state.type||2===e.state.type?a.createElement("td",null,a.createElement("input",{type:"number",onChange:function(t){return e.handleTdChange("orderWeight",Number.parseInt(t.target.value),n)},value:t.orderWeight})):null,a.createElement("td",null,a.createElement("input",{onChange:function(t){return e.handleTdChange("enable",t.target.checked,n)},type:"checkbox",checked:t.enable})),4===e.state.type?a.createElement("td",null,a.createElement("input",{type:"number",onChange:function(t){return e.handleTdChange("days",Number.parseInt(t.target.value),n)},value:t.days})):null,4===e.state.type&&t.expiredTime?a.createElement("td",null,t.expiredTime.slice(0,19).replace("T"," ")):null,a.createElement("td",null,a.createElement("button",{type:"button",onClick:function(t){return e.putCurData(n)}},"保存")))}))):null,a.createElement("p",null,this.state.info)))},t}(a.Component);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(22),i=(function(){}(),function(e){function t(t){var n=e.call(this,t)||this;return n.state={announcement:"加载中",info:""},n.changeSiteAnnouncement=n.changeSiteAnnouncement.bind(n),n.clearMainPageCache=n.clearMainPageCache.bind(n),n}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return e="/config/global",[4,s.cc98Fetch(e)];case 1:return[4,n.sent().json()];case 2:return t=n.sent(),this.setState({announcement:t.announcement}),[2]}})})},t.prototype.changeSiteAnnouncement=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i,c=this;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e="/config/global/announcement",[4,s.getToken()];case 1:return t=r.sent(),n=this.state.announcement,(a=new Headers).append("Authorization",t),a.append("Content-Type","application/json"),[4,s.cc98Fetch(e,{method:"PUT",headers:a,body:JSON.stringify({announcement:n})})];case 2:if(200!==(o=r.sent()).status)throw new Error(o.status.toString());return this.setState({info:"修改全站公告成功"}),setTimeout(function(){c.setState({info:""})},1e3),[3,4];case 3:return i=r.sent(),this.setState({info:"修改失败"+i.message}),[3,4];case 4:return[2]}})})},t.prototype.clearMainPageCache=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a=this;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,s.formAuthorizeHeader()];case 1:return e=r.sent(),[4,s.cc98Fetch("/config/index/update",{method:"PUT",headers:e})];case 2:if(200!==(t=r.sent()).status)throw new Error(t.status.toString());return this.setState({info:"清除首页缓存成功"}),setTimeout(function(){a.setState({info:""})},1e3),[3,4];case 3:return n=r.sent(),this.setState({info:"清除首页缓存失败 "+n.message}),[3,4];case 4:return[2]}})})},t.prototype.render=function(){var e=this;return a.createElement("div",null,a.createElement("p",{style:{height:"2rem"}},this.state.info),a.createElement("div",null,a.createElement("div",{style:{display:"flex",fontSize:"20px",alignItems:"center"}},a.createElement("div",{style:{marginTop:"10px",marginLeft:"15px",marginRight:"15px"}},"全站公告"),a.createElement("div",null," ",a.createElement("button",{type:"button",className:"hiddenImage",onClick:this.changeSiteAnnouncement},"提交修改")," "),a.createElement("div",null," ",a.createElement("button",{type:"button",className:"hiddenImage",onClick:this.clearMainPageCache},"清除首页缓存")," ")),a.createElement("textarea",{style:{width:"1140px",height:"20rem",resize:"none",boxSizing:"border-box"},onChange:function(t){e.setState({announcement:t.target.value})},value:this.state.announcement}),a.createElement(o.UbbContainer,{code:this.state.announcement})))},t}(a.Component));t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(209),o=n(208),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{style:{backgroundColor:"white"}},a.createElement("div",{style:{display:"flex",justifyContent:"center",fontSize:"24px"}},"全站管理"),a.createElement(s.default,null),a.createElement(o.default,null))},t}(a.Component);t.SiteManage=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(106),i=n(6),c=function(e){function t(t){var n=e.call(this,t)||this;return n.update=n.update.bind(n),n.signin=n.signin.bind(n),n.state={signinInfo:{lastSignInCount:0,lastSignInTime:0},content:""},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,s.getSigninInfo()];case 1:return e=t.sent(),this.setState({signinInfo:e}),[2]}})})},t.prototype.update=function(e){this.setState({content:e})},t.prototype.signin=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return s.signin(this.state.content),[4,s.getGlobalConfig()];case 1:return e=r.sent(),t=e.signInTopicId,[4,s.getTopicInfo(t)];case 2:return n=r.sent(),a=n.replyCount,o=s.getTotalPageof10(a),0===(i=(a+1)%10)&&(i=10),this.props.history.push("/topic/"+t+"/"+o+"#"+i),this.setState({content:""}),c=s.getLocalStorage("userInfo"),l=(new Date((new Date).setHours(0,0,0,0)).getTime()+864e5-(new Date).getTime())/1e3,s.setLocalStorage("signin_"+c.id,!0,l),[2]}})})},t.prototype.render=function(){var e;if(this.state.signinInfo.hasSignedInToday){var t=s.getLocalStorage("userInfo"),n=(new Date((new Date).setHours(0,0,0,0)).getTime()+864e5-(new Date).getTime())/1e3;s.setLocalStorage("signin_"+t.id,!0,n),e=a.createElement("div",null,a.createElement("div",{className:"row",style:{justifyContent:"center"}},"你上次的签到日期是",moment(this.state.signinInfo.lastSignInTime).format("YYYY-MM-DD HH:mm:ss")),a.createElement("div",{className:"row",style:{justifyContent:"center"}},"你已经连续签到了",this.state.signinInfo.lastSignInCount,"天"))}else{t=s.getLocalStorage("userInfo");s.removeLocalStorage("signin_"+t.id),e=a.createElement("div",{className:"column"},a.createElement("div",{className:"row"},"你今天还未签到"),a.createElement("div",{style:{marginTop:"1.5rem"}},a.createElement(o.UbbEditor,{update:this.update,value:this.state.content,option:{height:10}}),a.createElement("div",{className:"row",style:{justifyContent:"center",marginBottom:"1.25rem "}},a.createElement("div",{id:"post-topic-button",onClick:this.signin,className:"button blue",style:{marginTop:"1.25rem",width:"6rem",height:"2rem",lineHeight:"2rem",letterSpacing:"0.3125rem"}},"签到"))))}return a.createElement("div",{className:"column",style:{width:"1140px",fontFamily:"微软雅黑",padding:"2rem",backgroundColor:"#fff",marginBottom:"1rem",fontSize:"1rem"}},a.createElement("div",{className:"column",style:{width:"100%"}},a.createElement("div",{className:"row",style:{width:"100%",justifyContent:"center"}},"论坛签到"),a.createElement("div",{className:"row"},"签到功能是 CC98 论坛提供的一项娱乐功能。每个用户每天可以签到一次，并获得额外的论坛财富值奖励。如果连续多日签到，则奖励会不断增加。目前财富值的奖励情况如下表所示："),a.createElement("div",{className:"column",style:{marginLeft:"2rem"}},a.createElement("div",{className:"row"},"第 1 天： 600 到 1200 论坛财富值"),a.createElement("div",{className:"row"},"第 2 天： 700 到 1400 论坛财富值"),a.createElement("div",{className:"row"},"第 3 天： 800 到 1600 论坛财富值"),a.createElement("div",{className:"row"},"第 4 天： 900 到 1800 论坛财富值"),a.createElement("div",{className:"row"},"第 5 天及以后： 1000 到 2000 论坛财富值"))),e)},t}(a.Component);t.Signin=c,t.ShowSignin=i.withRouter(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(16),i=n(6),c=function(e){function t(t){var n=e.call(this,t)||this;return n.state={data:[]},n}return r.__extends(t,e),t.prototype.getData=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n;return r.__generator(this,function(r){switch(r.label){case 0:return e=location.href.match(/\/searchBoard\?keyword=(.*)/),t=[],e?[3,1]:(this.showNoResult(),[3,3]);case 1:return n=decodeURI(decodeURI(e[1])),[4,s.getSearchBoard(n,this.context.router)];case 2:(t=r.sent())?this.setState({data:t}):this.showNoResult(),r.label=3;case 3:return[2]}})})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return this.getData(),[2]})})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return this.getData(),[2]})})},t.prototype.showNoResult=function(){$("#noResultBoard").removeClass("displaynone")},t.prototype.render=function(){return a.createElement("div",{className:"focus-root"},a.createElement(o.default,{title:"搜索结果 - CC98论坛"}),a.createElement("div",{className:"focus"},a.createElement(u,null),a.createElement("div",{className:"focus-board-area"},this.state.data.map(l))),a.createElement("div",{id:"noResultBoard",className:"noResult displaynone"},a.createElement("img",{src:"/static/images/searchNone.png",className:"noResultPic"}),a.createElement("div",{className:"noResultText"},"-----------------------抱歉呢前辈，没有找到你想要的版面哦~----------------------")))},t}(a.Component);function l(e){var t="/list/"+e.id;return a.createElement("a",{href:t,target:"_blank"},a.createElement("div",{className:"focus-board"},e.name))}t.SearchBoard=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},a.createElement(i.Link,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),a.createElement("i",{className:"fa fa-chevron-right"}),a.createElement(i.Link,{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"},to:"/boardList"},"版面列表"),a.createElement("i",{className:"fa fa-chevron-right"}),a.createElement("div",{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"}},"搜索版面"))},t}(a.Component);t.Category=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.tag1||$("#tag_"+this.props.id).addClass("displaynone"),this.props.userId||($("#user_"+this.props.id).removeAttr("href"),$("#user_"+this.props.id).removeAttr("target"),$("#lastpost_"+this.props.id).removeAttr("href"),$("#lastpost_"+this.props.id).removeAttr("target"))},t.prototype.render=function(){var e="";this.props.tag1&&(e=this.props.tag2?"标签："+this.props.tag1+" / "+this.props.tag2:"标签："+this.props.tag1);var t="/topic/"+this.props.id,n="/user/id/"+this.props.userId,r="/list/"+this.props.boardId,s=this.props.floorCount/10+1,o=parseInt(s),i=this.props.floorCount+10-10*o;var c="/user/name/"+encodeURI(this.props.lastPostUser);return a.createElement("div",{className:"focus-topic"},a.createElement("a",{className:"focus-topic-left",href:n,target:"_blank",id:"user_"+this.props.id},a.createElement("img",{className:"focus-topic-portraitUrl",src:this.props.portraitUrl}),a.createElement("div",{className:"focus-topic-userName"},this.props.userName)),a.createElement("div",{className:"focus-topic-middle"},a.createElement("a",{className:"focus-topic-title",href:t,target:"_blank"},this.props.title),a.createElement("div",{className:"focus-topic-info"},a.createElement("div",{id:"tag_"+this.props.id},e),a.createElement("div",null,a.createElement("i",{className:"fa fa-clock-o fa-lg"}),this.props.time),a.createElement("div",null,a.createElement("i",{className:"fa fa-eye fa-lg"})," ",this.props.hitCount),a.createElement("div",null,"最后回复：",a.createElement("a",{href:c,target:"_blank",id:"lastpost_"+this.props.id},this.props.lastPostUser)))),a.createElement("div",{className:"focus-topic-rightBar"}),a.createElement("a",{className:"focus-topic-right",href:r,target:"_blank"},a.createElement("div",{className:"focus-topic-board"},this.props.boardName)))},t}(a.Component);t.SearchTopicSingle=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(213),o=n(4),i=n(16),c=n(6),l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={boardId:0,boardName:"全站",words:[],data:[],from:0,loading:!0,buttonClassName:""},n.getMore=n.getMore.bind(n),n.handleScroll=n.handleScroll.bind(n),n}return r.__extends(t,e),t.prototype.getData=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a;return r.__generator(this,function(r){switch(r.label){case 0:return[4,o.getSearchTopic(e.boardId,e.words,t,this.context.router)];case 1:if((n=r.sent())&&0!==n.length)if(-1==n){if(0!==t)return this.setState({loading:!0}),$("#focus-topic-getMore").css("display","flex"),$("#focus-topic-loading").addClass("displaynone"),[2];this.showError(),this.setState({loading:!1})}else n.length<20?($("#focus-topic-getMore").css("display","none"),$("#focus-topic-loading").addClass("displaynone"),$("#focus-topic-loaddone").removeClass("displaynone"),a=this.state.data.concat(n),this.setState({boardName:e.boardName,data:a,from:a.length,loading:!1})):(a=this.state.data.concat(n),this.setState({boardName:e.boardName,data:a,from:a.length,loading:!0}),$("#focus-topic-getMore").css("display","flex"),$("#focus-topic-loading").addClass("displaynone"));else this.showNoResult(),this.setState({loading:!1});return[2]}})})},t.prototype.getNewData=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,o.getSearchTopic(e.boardId,e.words,t,this.context.router)];case 1:if((n=r.sent())&&0!==n.length)if(-1==n){if(0!==t)return this.setState({loading:!0}),$("#focus-topic-getMore").css("display","flex"),$("#focus-topic-loading").addClass("displaynone"),[2];this.showError(),this.setState({loading:!1})}else n.length<20?($("#focus-topic-getMore").css("display","none"),$("#focus-topic-loading").addClass("displaynone"),$("#focus-topic-loaddone").removeClass("displaynone"),this.setState({boardName:e.boardName,data:n,from:n.length,loading:!1})):(this.setState({boardName:e.boardName,data:n,from:n.length,loading:!0}),$("#focus-topic-getMore").css("display","flex"),$("#focus-topic-loading").addClass("displaynone"));else this.showNoResult(),this.setState({loading:!1});return[2]}})})},t.prototype.keyWordSearch=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,s;return r.__generator(this,function(r){switch(r.label){case 0:return e=location.href.match(/\/search\?boardId=(\d+)&keyword=(.*)/),t={boardId:0,boardName:"全站",words:null},e?[3,1]:(this.showNoResult(),this.setState({loading:!1}),[3,3]);case 1:return t.boardId=parseInt(e[1]),n=t,[4,o.getBoardName(parseInt(e[1]))];case 2:n.boardName=r.sent(),a=decodeURI(decodeURI(e[2])),(s=a.split(" ")).length>5&&(s=s.splice(5)),t.words=s,r.label=3;case 3:return o.setStorage("searchInfo",t),this.setState({boardId:t.boardId,boardName:t.boardName,words:t.words}),$("#focus-topic-getMore").css("display","none"),$("#focus-topic-loading").removeClass("displaynone"),this.getNewData(t,0),document.addEventListener("scroll",this.handleScroll),[2]}})})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return this.keyWordSearch(),[2]})})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return $("#focus-topic-area").removeClass("displaynone"),$("#noResult").addClass("displaynone"),$("#showError").addClass("displaynone"),this.keyWordSearch(),[2]})})},t.prototype.getMore=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){return this.state.loading&&($("#focus-topic-getMore").css("display","none"),$("#focus-topic-loading").removeClass("displaynone"),this.setState({loading:!1}),e=o.getStorage("searchInfo"),this.getData(e,this.state.from)),[2]})})},t.prototype.showNoResult=function(){$("#focus-topic-area").addClass("displaynone"),$("#noResult").removeClass("displaynone")},t.prototype.showError=function(){$("#focus-topic-area").addClass("displaynone"),$("#showError").removeClass("displaynone")},t.prototype.handleScroll=function(e){window.pageYOffset>234&&this.setState({buttonClassName:"btn-show"}),window.pageYOffset<234&&this.setState(function(e){return{buttonClassName:""===e.buttonClassName?"":"btn-disappare"}})},t.prototype.scrollToTop=function(){$("body,html").animate({scrollTop:0},500)},t.prototype.render=function(){return a.createElement("div",{className:"focus-root"},a.createElement(i.default,{title:"搜索结果 - CC98论坛"}),a.createElement("div",{className:"focus"},a.createElement(d,null),a.createElement("div",{className:"focus-topic-area",id:"focus-topic-area"},a.createElement("div",{className:"focus-topic-topicArea"},this.state.data.map(u)),a.createElement("div",{className:"focus-topic-getMore",onClick:this.getMore,id:"focus-topic-getMore"},a.createElement("div",null,"点击获取更多搜索结果~"),a.createElement("div",null,"······")),a.createElement("div",{className:"focus-topic-loading displaynone",id:"focus-topic-loading"},a.createElement("img",{src:"http://file.cc98.org/uploadfile/2017/12/20/6514723843.gif"})),a.createElement("div",{className:"focus-topic-loaddone displaynone",id:"focus-topic-loaddone"}," 没有更多帖子啦~"),a.createElement("button",{type:"button",id:"scrollToTop",className:this.state.buttonClassName,onClick:this.scrollToTop},"回到顶部")),a.createElement("div",{id:"noResult",className:"noResult displaynone"},a.createElement("img",{src:"/static/images/searchNone.png",className:"noResultPic"}),a.createElement("div",{className:"noResultText"},"-----------------------抱歉呢前辈，没有找到你想要的帖子哦~----------------------")),a.createElement("div",{id:"showError",className:"resultErr displaynone"},"查询出错了，请刷新重试")))},t}(a.Component);function u(e){return a.createElement(s.SearchTopicSingle,{title:e.title,hitCount:e.hitCount,id:e.id,boardId:e.boardId,boardName:e.boardName,replyCount:e.replyCount,userId:e.userId,userName:e.userName,portraitUrl:e.portraitUrl,time:e.time,likeCount:e.likeCount,dislikeCount:e.dislikeCount,lastPostUser:e.lastPostUser,lastPostTime:e.lastPostTime,tag1:e.tag1,tag2:e.tag2,floorCount:e.floorCount})}t.Search=l;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},a.createElement(c.Link,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),a.createElement("i",{className:"fa fa-chevron-right"}),a.createElement("div",{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"}},"搜索主题"))},t}(a.Component);t.Category=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(34),o=n(4),i=n(15),c=n(12),l=n(16),u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={loginName:"",loginPassword:"",loginMessage:"",isLoging:!1},n.handleNameChange=n.handleNameChange.bind(n),n.handlePasswordChange=n.handlePasswordChange.bind(n),n.handleLogin=n.handleLogin.bind(n),n}return r.__extends(t,e),t.prototype.shake=function(e){return e.classList.add("shake"),setTimeout(function(){e.classList.remove("shake")},500),e},t.prototype.handleNameChange=function(e){this.setState({loginName:e.target.value})},t.prototype.handlePasswordChange=function(e){this.setState({loginPassword:e.target.value})},t.prototype.handleLogin=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i,c,l,u,d,p,m=this;return r.__generator(this,function(r){switch(r.label){case 0:if(e.preventDefault(),this.state.isLoging)return[2,!1];if(!this.state.loginName)return this.setState({loginMessage:"请输入用户名"}),this.shake(document.getElementById("loginName")).focus(),[2,!1];if(!this.state.loginPassword)return this.setState({loginMessage:"请输入密码"}),this.shake(document.getElementById("loginPassword")).focus(),[2,!1];this.setState({loginMessage:"登录中",isLoging:!0}),this.props.logOff(),r.label=1;case 1:return r.trys.push([1,5,,6]),t="https://openid1.cc98.vaynetian.com/connect/token",n={client_id:"9a1fd200-8687-44b1-4c20-08d50a96e5cd",client_secret:"8b53f727-08e2-4509-8857-e34bf92b27f2",grant_type:"password",username:this.state.loginName,password:this.state.loginPassword,scope:"cc98-api openid offline_access"},(a=new Headers).append("Content-Type","application/x-www-form-urlencoded"),[4,fetch(t,{method:"POST",headers:a,body:s.param(n)})];case 2:if(200!==(i=r.sent()).status)throw new Error(i.status.toString());return[4,i.json()];case 3:return c=r.sent(),l=c.token_type+" "+c.access_token,o.setLocalStorage("accessToken",l,c.expires_in),o.setLocalStorage("refresh_token",c.refresh_token,2592e3),[4,o.refreshUserInfo()];case 4:if(r.sent(),1===(u=o.getLocalStorage("userInfo")).lockState||2===u.lockState)throw new Error("账号已锁定");return this.setState({loginMessage:"登录成功 正在返回"}),o.changeTheme(u.theme),this.props.logOn(),setTimeout(function(){1===m.props.history.length?m.props.history.push("/"):m.props.history.go(-1),o.refreshUnReadCount()},100),[3,6];case 5:switch(d=r.sent(),p=void 0,o.removeLocalStorage("userInfo"),o.removeLocalStorage("accessToken"),o.removeLocalStorage("refresh_token"),d.message){case"400":p="密码错误";break;case"账号已锁定":p="账号已锁定";break;default:p="未知错误 "+d.message}return this.setState({loginMessage:"登录失败 "+p,isLoging:!1}),this.props.logOff(),[3,6];case 6:return[2]}})})},t.prototype.render=function(){return a.createElement("div",{className:"login"},a.createElement(l.default,{title:"登录 - CC98论坛"}),a.createElement("div",null,a.createElement("img",{src:"/static/images/login.png"}),a.createElement("div",null,a.createElement("img",{src:"/static/images/login_welcome.png"}),a.createElement("form",{onSubmit:this.handleLogin,autoComplete:"on"},a.createElement("div",{className:"login-form"},a.createElement("p",null,"用户名"),a.createElement("input",{name:"username",type:"text",id:"loginName",onChange:this.handleNameChange,value:this.state.loginName,autoComplete:"username"})),a.createElement("div",{className:"login-form"},a.createElement("p",null,"密码"),a.createElement("input",{name:"password",type:"password",id:"loginPassword",onChange:this.handlePasswordChange,autoComplete:"current-password"})),a.createElement("p",{id:"loginMessage"},this.state.loginMessage),a.createElement("button",{type:"submit",disabled:this.state.isLoging},"登录账号")),a.createElement("p",null,a.createElement("span",null,"还没账号？我要 ",a.createElement("a",{href:"//account.cc98.org/",target:"_blank"},"注册"))),a.createElement("p",null,a.createElement("span",null,"密码错误？我要 ",a.createElement("a",{href:"//account.cc98.org/",target:"_blank"},"找回"))))))},t}(a.Component);t.default=i.connect(function(e){return{isLogOn:e.userInfo.isLogOn}},function(e){return{logOn:function(){e(c.userLogIn())},logOff:function(){e(c.userLogOff())},changeUserInfo:function(t){e(c.changeUserInfo(t))}}})(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(79),o=n(4),i=function(e){function t(t){var n=e.call(this,t)||this;return n.state={userRecentPosts:[],isLoading:!1},n.scrollHandler=n.scrollHandler.bind(n),n}return r.__extends(t,e),t.prototype.scrollHandler=function(e){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,s,i;return r.__generator(this,function(r){switch(r.label){case 0:if(!(document.body.scrollHeight-window.pageYOffset<1500&&!1===this.state.isLoading))return[3,8];r.label=1;case 1:return r.trys.push([1,7,,8]),this.setState({isLoading:!0}),e="/user/"+this.props.id+"/recent-topic?userid="+this.props.id+"&from="+this.state.userRecentPosts.length+"&size=11",[4,o.getToken()];case 2:return t=r.sent(),(n=new Headers).append("Authorization",t),[4,o.cc98Fetch(e,{headers:n})];case 3:return 200!==(a=r.sent()).status?[3,5]:[4,a.json()];case 4:return s=r.sent(),i=11===s.length?10:s.length,this.setState(function(e){return{userRecentPosts:e.userRecentPosts.concat(s.slice(0,i)),isLoading:!1}}),[3,6];case 5:throw{};case 6:return[3,8];case 7:return r.sent(),this.setState({isLoading:!1}),[3,8];case 8:return[2]}})})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,s,i;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,6,,7]),e="/user/"+this.props.id+"/recent-topic?userid="+this.props.id+"&from="+this.state.userRecentPosts.length+"&size=11",[4,o.getToken()];case 1:return t=r.sent(),(n=new Headers).append("Authorization",t),[4,o.cc98Fetch(e,{headers:n})];case 2:return 200!==(a=r.sent()).status?[3,4]:[4,a.json()];case 3:return s=r.sent(),i=11===s.length?10:s.length,this.setState({userRecentPosts:s.slice(0,i)}),11===s.length&&window.addEventListener("scroll",this.scrollHandler),[3,5];case 4:throw new Error;case 5:return[3,7];case 6:return r.sent(),[3,7];case 7:return[2]}})})},t.prototype.componentWillUnmount=function(){window.removeEventListener("scroll",this.scrollHandler)},t.prototype.render=function(){if(0===this.state.userRecentPosts.length){return a.createElement("div",{className:"user-activities"},a.createElement("p",null,"发表的主题"),a.createElement("div",{className:"user-posts",style:{marginLeft:"2rem"}},"没有主题"))}for(var e=this.state.userRecentPosts.map(function(e){return a.createElement(s.default,{userRecentPost:e})}),t=1;t<e.length;t+=2)e.splice(t,0,a.createElement("hr",null));return a.createElement("div",{className:"user-activities"},a.createElement("p",null,"发表的主题"),a.createElement("div",{className:"user-posts"},e))},t}(a.Component);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=n(22),i=n(4),c=n(7),l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isFollowing:t.userInfo.isFollowing,buttonIsDisabled:!1,buttonInfo:t.userInfo.isFollowing?"已关注":"关注"},n.unfollow=n.unfollow.bind(n),n.follow=n.follow.bind(n),n}return r.__extends(t,e),t.prototype.getPrivilegeColor=function(){switch(this.props.userInfo.privilege){case"注册用户":return"grey";case"超级版主":return"pink";case"全站贵宾":return"blue";case"管理员":return"red"}},t.prototype.follow=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return this.setState({buttonIsDisabled:!0,buttonInfo:"关注中"}),[4,i.followUser(this.props.userInfo.id)];case 1:return!0===(e=t.sent())?this.setState({buttonIsDisabled:!1,buttonInfo:"已关注",isFollowing:!0}):"follow_count_limited"===e?this.setState({buttonIsDisabled:!1,buttonInfo:"已达上限",isFollowing:!1}):this.setState({buttonIsDisabled:!1,buttonInfo:"关注失败",isFollowing:!1}),[2]}})})},t.prototype.unfollow=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return this.setState({buttonIsDisabled:!0,buttonInfo:"取关中"}),[4,i.unfollowUser(this.props.userInfo.id)];case 1:return!0===e.sent()?this.setState({buttonIsDisabled:!1,buttonInfo:"重新关注",isFollowing:!1}):this.setState({buttonIsDisabled:!1,buttonInfo:"取关失败",isFollowing:!0}),[2]}})})},t.prototype.render=function(){var e=this,t=!1;if(this.props.userInfo.birthday){var n=this.props.userInfo.birthday.match(/\d+-(\d+)-(\d+)/),i=new Date;Number.parseInt(n[1])===i.getMonth()+1&&Number.parseInt(n[2])===i.getDate()&&(t=!0)}return a.createElement("div",{className:"user-profile"},a.createElement("div",{id:"userId"},a.createElement("div",{id:"userId"},a.createElement("p",null,this.props.userInfo.name,a.createElement("span",{style:{fontSize:"12px",color:this.getPrivilegeColor(),marginLeft:"2rem"}},this.props.userInfo.privilege)),a.createElement(s.Link,{to:"/message/message?id="+this.props.userInfo.id},a.createElement("button",{type:"button"},"私信")),a.createElement("button",{type:"button",id:this.state.isFollowing?"unfollow":"",onClick:this.state.isFollowing?this.unfollow:this.follow,disabled:this.state.buttonIsDisabled,onMouseOver:function(){e.state.isFollowing&&!e.state.buttonIsDisabled&&e.setState({buttonInfo:"取消关注"})},onMouseLeave:function(){e.state.isFollowing&&!e.state.buttonIsDisabled&&e.setState({buttonInfo:"已关注"})}},this.state.buttonInfo))),a.createElement("div",{id:"userIntroducion"},this.props.userInfo.introduction),a.createElement("div",{id:"userGenderAndBirthday"},a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"性别"),1===this.props.userInfo.gender?"男":"女"," "),a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"发帖数"),this.props.userInfo.postCount),a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"威望"),this.props.userInfo.prestige),a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"粉丝数"),this.props.userInfo.fanCount),a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"风评"),this.props.userInfo.popularity),a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"注册时间"),this.props.userInfo.registerTime.replace("T"," ")),a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"最后登录"),this.props.userInfo.lastLogOnTime.replace("T"," ")),null===this.props.userInfo.birthday?null:a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"生日"),this.props.userInfo.birthday.slice(0,this.props.userInfo.birthday.indexOf("T")).replace("9999-",""),t?a.createElement("span",{style:{fontFamily:"FontAwesome",marginLeft:"1rem"},className:"fa-birthday-cake",title:"生日快乐~"}):null),this.props.userInfo.displayTitle?a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"用户组"),this.props.userInfo.displayTitle):null,this.props.userInfo.emailAddress?a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"邮箱"),this.props.userInfo.emailAddress):null,this.props.userInfo.qq?a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"QQ"),this.props.userInfo.qq):null,a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"被删帖数"),-this.props.userInfo.deleteCount)),this.props.userInfo.signatureCode?a.createElement("div",{className:"user-description"},a.createElement("p",null,"个性签名"),a.createElement(o.UbbContainer,{code:this.props.userInfo.signatureCode,options:r.__assign({},new c.UbbCodeOptions,{allowExternalImage:!1})})):null)},t}(a.Component);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(4),i=n(6),c=function(e){function t(t){var n=e.call(this,t)||this;return n.state={info:"",count:0,from:0,isLoading:!1,days:1,posts:[]},n}return r.__extends(t,e),t.prototype.handleSubmit=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i,c,l,u,d,p=this;return r.__generator(this,function(m){switch(m.label){case 0:return m.trys.push([0,5,,6]),this.setState({isLoading:!0}),[4,o.getToken()];case 1:return t=m.sent(),n=this.props.id,a=this.state.days,i="/User/"+n+"/post?days="+a+"&from="+e+"&size=10",(c=new Headers).append("Authorization",t),[4,s.cc98Fetch(i,{headers:c})];case 2:return[4,m.sent().json()];case 3:return l=m.sent(),u=l.postInfos.map(function(e){return r.__awaiter(p,void 0,void 0,function(){var t,n;return r.__generator(this,function(a){switch(a.label){case 0:return t=[{},e],n={},[4,o.getBoardName(e.boardId)];case 1:return[2,r.__assign.apply(void 0,t.concat([(n.boardName=a.sent(),n)]))]}})})}),[4,Promise.all(u)];case 4:return u=m.sent(),this.setState({posts:u,isLoading:!1,count:l.count,info:0===u.length?"啥也没有":"",from:e}),[3,6];case 5:return d=m.sent(),this.setState({info:d.message,isLoading:!1}),[3,6];case 6:return[2]}})})},t.prototype.render=function(){var e=this;return a.createElement("div",null,a.createElement("h2",null,"查看用户最近发言"),a.createElement("div",{className:"user-manager"},a.createElement("p",null,"天数："),a.createElement("input",{type:"number",onChange:function(t){e.setState({days:Number.parseInt(t.target.value)})},value:this.state.days}),a.createElement("button",{type:"button",onClick:function(){e.handleSubmit(0)}},"查看"),a.createElement("button",{type:"button",disabled:0===this.state.from,onClick:function(){e.handleSubmit(e.state.from-10)}},"上一页"),a.createElement("button",{type:"button",disabled:this.state.from+this.state.posts.length===this.state.count,onClick:function(){e.handleSubmit(e.state.from+10)}},"下一页")),a.createElement("div",{className:"user-manage-return"},a.createElement("p",null,this.state.info)),this.state.isLoading?a.createElement("div",{className:"user-center-loading"},a.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"})):a.createElement("div",null,this.state.posts.map(function(e){return a.createElement("div",{className:"user-manage-post",key:e.topicId},a.createElement("p",{className:"user-manage-post-date"},e.time.slice(0,19).replace("T"," ")),-1===e.floor?a.createElement("p",{className:"user-manage-post-content",title:e.content.slice(0,1e3)},e.content):a.createElement(i.Link,{className:"user-manage-post-content",to:"/topic/"+e.topicId+"/"+(Math.floor((e.floor-1)/10)+1)+"#"+(e.floor%10==0?10:e.floor%10),title:e.content.slice(0,1e3),target:"_blank"},e.content),a.createElement(i.Link,{className:"user-manage-post-board",to:"/list/"+e.boardId,target:"_blank"},e.boardName),a.createElement("p",{className:"user-manage-post-floor"},-1===e.floor?"已删除":e.floor),a.createElement("p",{className:"user-manage-post-ip"},e.ip))}),this.state.posts.length>0?a.createElement("p",{style:{textAlign:"right"}},"总共有",this.state.count,"条帖子，当前显示第",Math.floor(this.state.from/10)+1,"页，共",Math.floor(this.state.count/10)+1,"页"):null))},t}(a.Component);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(4),i=function(e){function t(t){var n=e.call(this,t)||this;return n.state={days:0,info:""},n}return r.__extends(t,e),t.prototype.handleSubmit=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i,c,l,u,d;return r.__generator(this,function(r){switch(r.label){case 0:if(r.trys.push([0,4,,5]),t=e?"post":"topic",n=this.props.id,(a=this.state.days)<1||a>365)throw new Error("请检查日期");return i="/user/"+n+"/"+t+"?days="+a,[4,o.getToken()];case 1:return c=r.sent(),(l=new Headers).append("Authorization",c),[4,s.cc98Fetch(i,{method:"DELETE",headers:l})];case 2:return[4,r.sent().json()];case 3:return u=r.sent(),this.setState({info:"删掉了"+u+"条"+t}),[3,5];case 4:return d=r.sent(),this.setState({info:d.message}),[3,5];case 5:return[2]}})})},t.prototype.render=function(){var e=this;return a.createElement("div",null,a.createElement("h2",null,"删除用户最近主题与回帖"),a.createElement("div",{className:"user-manager"},a.createElement("p",null,"天数："),a.createElement("input",{type:"number",onChange:function(t){e.setState({days:Number.parseInt(t.target.value)})},value:this.state.days}),a.createElement("button",{type:"button",onClick:function(){e.handleSubmit(!1)}},"删主题"),a.createElement("button",{type:"button",onClick:function(){e.handleSubmit(!0)}},"删回复")),a.createElement("p",{className:"user-manage-return"},this.state.info))},t}(a.Component);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(4),i=function(){return function(){}}(),c=(function(){}(),function(){}(),function(e){function t(t){var n=e.call(this,t)||this;return n.state={ForumUserOperation:new i,info:""},n}return r.__extends(t,e),t.prototype.handleForumUserOperationChange=function(e,t){this.setState(function(n){return{ForumUserOperation:r.__assign({},n.ForumUserOperation,(a={},a[e]=t,a))};var a})},t.prototype.handleSubmit=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i,c,l,u,d;return r.__generator(this,function(p){switch(p.label){case 0:t=this.state.ForumUserOperation,n=t.Days,a=t.PunishmentType,p.label=1;case 1:if(p.trys.push([1,4,,5]),!this.state.ForumUserOperation.Reason)throw new Error("请填写理由");if(!e&&3===a&&(n<-1||n>1e3||n<7&&n>-1))throw new Error("不合法的TP天数");return i="/user/"+this.props.id+"/operation",[4,o.getToken()];case 2:return c=p.sent(),(l=new Headers).append("Authorization",c),l.append("Content-Type","application/json"),[4,s.cc98Fetch(i,{method:"PUT",headers:l,body:JSON.stringify(r.__assign({},this.state.ForumUserOperation,{OperationType:e?0:1}))})];case 3:if(!(u=p.sent()).ok)throw new Error(u.statusText);return this.setState({info:"操作成功"}),[3,5];case 4:return d=p.sent(),this.setState({info:d.message}),[3,5];case 5:return[2]}})})},t.prototype.render=function(){var e=this;return a.createElement("div",null,a.createElement("h2",null,"TP"),a.createElement("div",{className:"user-manager"},a.createElement("p",null,"OperationType: "),a.createElement("select",{value:this.state.ForumUserOperation.PunishmentType||0,onChange:function(t){e.handleForumUserOperationChange("PunishmentType",Number.parseInt(t.target.value))}},a.createElement("option",{value:0,disabled:!0},"未选择"),a.createElement("option",{value:1},"锁定"),a.createElement("option",{value:2},"屏蔽"),a.createElement("option",{value:3},"TP")),a.createElement("p",null,"Reason: "),a.createElement("input",{type:"text",onChange:function(t){e.handleForumUserOperationChange("Reason",t.target.value)},value:this.state.ForumUserOperation.Reason}),a.createElement("p",null,"Days: "),a.createElement("input",{type:"number",onChange:function(t){e.handleForumUserOperationChange("Days",Number.parseInt(t.target.value))},value:this.state.ForumUserOperation.Days}),a.createElement("button",{type:"button",onClick:function(){e.handleSubmit(!1)}},"提交"),a.createElement("button",{type:"button",onClick:function(){e.handleSubmit(!0)}},"解除")),a.createElement("p",{className:"user-manage-return"},this.state.info))},t}(a.Component));t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=n(12),i=n(15),c=n(220),l=n(219),u=n(218),d=n(68),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:e=0===this.props.id?Number.parseInt(this.props.match.params.id):this.props.id,this.props.changePage("manage",e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,d.getUserInfo(e)];case 2:return t=n.sent(),this.setState({userInfo:t}),[3,4];case 3:return n.sent(),this.props.notFoundUser(),[3,4];case 4:return[2]}})})},t.prototype.render=function(){return this.state?a.createElement("div",{className:"user-manage"},a.createElement("div",{className:"user-manage-infos"},a.createElement("h2",null,"用户信息"),a.createElement("div",{className:"user-manage-info"},a.createElement("p",null,"id:",this.state.userInfo.id),a.createElement("p",null,"name: ",this.state.userInfo.name))),a.createElement(c.default,{id:this.props.id}),a.createElement(l.default,{id:this.props.id}),a.createElement(u.default,{id:this.props.id})):a.createElement("div",{className:"user-center-loading"},a.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}))},t}(a.Component);t.default=i.connect(function(e){return{id:e.userInfo.currentVisitingUserId}},function(e){return{changePage:function(t,n){e(o.changeCurrentVisitingUserPage(t,n))},notFoundUser:function(){e(o.userNotFound())}}})(s.withRouter(p))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=n(15),i=n(221),c=n(217),l=n(216),u=n(148),d=n(12),p=n(4),m=n(16),h=n(68),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"user-center-router"},a.createElement(s.Route,{path:"/user/:method/:id?",exact:!0,component:v}),a.createElement(s.Route,{path:"/user/:method/:id/manage",component:i.default}))},t}(a.Component);t.default=f;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return this.getInfo(this.props),[2]})})},t.prototype.componentWillReceiveProps=function(e){this.props.match.params.id!==e.match.params.id&&this.getInfo(e)},t.prototype.getInfo=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s,o,i,c,l,u;return r.__generator(this,function(r){switch(r.label){case 0:if(r.trys.push([0,3,,4]),void 0,t=e.match.params,n=t.id,a=t.method,s=new Headers,o=void 0,!n)throw new Error;return"name"===a?o=n:"id"===a&&(o=Number.parseInt(n)),c=(i=s).append,l=["Authorization"],[4,p.getToken()];case 1:return c.apply(i,l.concat([r.sent()])),[4,h.getUserInfo(o)];case 2:return u=r.sent(),this.props.history.replace("/user/id/"+u.id),this.props.changePage("exact",u.id),this.setState({userInfo:u}),[3,4];case 3:return r.sent(),this.props.notFoundUser(),[3,4];case 4:return[2]}})})},t.prototype.render=function(){return this.state?a.createElement("div",{className:"user-center-exact"},a.createElement(m.default,{title:this.state.userInfo.name+" - 用户详情 - CC98论坛"}),a.createElement(u.default,{userInfo:this.state.userInfo}),a.createElement(c.default,{userInfo:this.state.userInfo}),a.createElement(l.default,{id:this.state.userInfo.id})):a.createElement("div",{className:"user-center-loading"},a.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}))},t}(a.Component);var v=o.connect(null,function(e){return{changePage:function(t,n){e(d.changeCurrentVisitingUserPage(t,n))},notFoundUser:function(){e(d.userNotFound())}}})(s.withRouter(g))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=n(15),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"user-center-navigation",id:"userCenterNavigation"},a.createElement("ul",null,a.createElement("li",null,a.createElement(s.Link,{to:"/user/id/"+this.props.id,className:"exact"===this.props.currentVisitingUserPage?"user-center-navigation-active fa-home":"fa-home"},a.createElement("span",{style:{width:"0.5rem"}}),"主页")),a.createElement("hr",null),"管理员"===this.props.isManager?a.createElement("li",null,a.createElement(s.Link,{to:"/user/id/"+this.props.id+"/manage",className:"manage"===this.props.currentVisitingUserPage?"user-center-navigation-active fa-cog":"fa-cog"},a.createElement("span",{style:{width:"0.5rem"}}),"管理")):null))},t}(a.Component);t.default=o.connect(function(e){return{isManager:e.userInfo.currentUserInfo.privilege,currentVisitingUserPage:e.userInfo.currentVisitingUserPage,id:e.userInfo.currentVisitingUserId}},null)(i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(15),o=n(223),i=n(222),c=n(71),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return this.props.isError?a.createElement(c.NotFoundUser,null):a.createElement("div",{className:"user-center"},a.createElement("div",{className:"user-center-content"},a.createElement("div",{className:"user-center-head"},a.createElement("p",null,"用户详情")),a.createElement("div",{className:"user-center-body"},a.createElement(o.default,null),a.createElement(i.default,null))))},t}(a.Component);t.default=s.connect(function(e){return{isError:!e.userInfo.currentVisitingUserIsExisted}},null)(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"footer"},a.createElement("div",{className:"column"},a.createElement("div",{className:"footerRow"},a.createElement("div",{style:{marginRight:"15px",color:"#000"}},"友情链接"),a.createElement("a",{href:"http://www.zju.edu.cn/"},"浙江大学"),"|",a.createElement("a",{href:"http://www.cs.zju.edu.cn/"},"浙江大学计算机学院"),"|",a.createElement("a",{href:"http://www.zju88.org/agent/index.do"},"飘渺水云间"),"|",a.createElement("a",{href:"http://www.qsc.zju.edu.cn/"},"求是潮"),"|",a.createElement("a",{href:"http://luckweb.057101.com/bt2/index.asp"},"缘网"),"|",a.createElement("a",{href:"http://www.nexushd.org/login.php"},"NexusHD"),"|",a.createElement("a",{href:"https://www.zdgd.zju.edu.cn/"},"浙江大学广播电视网"),"|",a.createElement("a",{href:"http://zy.zju.edu.cn/"},"浙大搜索")),a.createElement("div",{className:"footerRow"},"Copyright © 2003-2018 CC98 Durian v3.2.1 | ",a.createElement("a",{href:"mailto:contact@cc98.org"},"Email: contact@cc98.org"))))},t}(a.Component);t.Footer=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(34),i=n(15),c=n(12),l=n(6),u=n(30),d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hoverElement:null,unreadCount:{totalCount:0,atCount:0,messageCount:0,replyCount:0,systemCount:0}},n.handleNotifyMessageReceive=n.handleNotifyMessageReceive.bind(n),n}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e=this;return r.__generator(this,function(t){return this.handleNotifyMessageReceive(),window.addEventListener("storage",function(t){if("userInfo"===t.key){if(t.oldValue===t.newValue)return;t.newValue?(e.props.reLogOn(JSON.parse(t.newValue.slice(4))),s.refreshUnReadCount()):e.props.logOff()}}),s.isLogOn()&&!s.getLocalStorage("shouldNotRefreshUserInfo")&&(this.props.refreshUserInfo(),s.setLocalStorage("shouldNotRefreshUserInfo",!0,86400)),[2]})})},t.prototype.componentWillUnmount=function(){},t.prototype.handleNotifyMessageReceive=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,s.refreshUnReadCount()];case 1:return e.sent(),this.setState({unreadCount:s.getStorage("unreadCount")}),[2]}})})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){return!this.props.isLogOn&&e.isLogOn||e.isLogOn,[2]})})},t.prototype.logOff=function(){this.handleMouseEvent("mouseout","userName"),s.removeLocalStorage("accessToken"),s.removeLocalStorage("refresh_token"),s.removeLocalStorage("userInfo"),s.removeStorage("all"),s.changeTheme(0),this.props.logOff()},t.prototype.handleMouseEvent=function(e,t){switch(e){case"mouseover":this.setState({hoverElement:t}),s.refreshHoverUnReadCount();break;case"mouseout":this.setState({hoverElement:null})}},t.prototype.render=function(){var e=this;if(this.props.isLogOn){var t={display:"block",transitionDuration:".2s",height:"0px"},n={totalCount:0,replyCount:0,atCount:0,systemCount:0,messageCount:0};s.getStorage("unreadCount")&&(n=s.getStorage("unreadCount"));var o="管理员"===this.props.userInfo.privilege?a.createElement(l.Link,{to:"/sitemanage",style:{color:"#fff"}},a.createElement("li",null,"全站管理")):null,i="topBarUserCenter";"/"===location.pathname&&(i="topBarUserCenter-mainPage");var c="topBarMessageDetails";"/"===location.pathname&&(c="topBarMessageDetails-mainPage");var u="签到",d=s.getLocalStorage("userInfo");return s.getLocalStorage("signin_"+d.id)&&(u="已签到"),a.createElement("div",{className:"topBarRight"},a.createElement("div",{className:"topBarUserInfo"},a.createElement("div",{className:"topBarMessage",id:"userMessage",onMouseOut:function(t){e.handleMouseEvent(t.type,"message")},onMouseOver:function(t){e.handleMouseEvent(t.type,"message")}},a.createElement(l.Link,{to:"/message/response",className:"messageTopBar"},a.createElement("div",{className:"topBarBell"}," ",a.createElement("i",{className:"fa fa-bell-o"})),a.createElement("div",{className:"message-counter displaynone",id:"unreadCount-totalCount"},n.totalCount))),a.createElement("div",{className:"topBarUserImg",onMouseOut:function(t){e.handleMouseEvent(t.type,"userName")},onMouseOver:function(t){e.handleMouseEvent(t.type,"userName")}},a.createElement("img",{src:this.props.userInfo.portraitUrl})),a.createElement("div",{className:"topBarUserName",onMouseOut:function(t){e.handleMouseEvent(t.type,"userName")},onMouseOver:function(t){e.handleMouseEvent(t.type,"userName")}},this.props.userInfo.name)),a.createElement("div",{className:i,onMouseOut:function(t){e.handleMouseEvent(t.type,"userName")},onMouseOver:function(t){e.handleMouseEvent(t.type,"userName")},style:r.__assign({},t,{overflow:"hidden",height:"userName"===this.state.hoverElement?"8rem":"0"})},a.createElement("ul",{style:{display:"inherit"}},a.createElement(l.Link,{to:"/usercenter"}," ",a.createElement("li",null,"个人中心")),o,a.createElement(l.Link,{to:"/signin"},a.createElement("li",null,u)),a.createElement("li",{onClick:this.logOff.bind(this)},"注销"))),a.createElement("div",{className:c,onMouseOut:function(t){e.handleMouseEvent(t.type,"message")},onMouseOver:function(t){e.handleMouseEvent(t.type,"message")},style:r.__assign({},t,{overflow:"hidden",height:"message"===this.state.hoverElement?"8rem":"0"})},a.createElement("ul",{style:{display:"inherit"}},a.createElement(l.Link,{to:"/message/response"},a.createElement("li",null,"回复我的",a.createElement("div",{className:"message-counterLi displaynone",id:"unreadCount-replyCount"},"(",n.replyCount,")"))),a.createElement(l.Link,{to:"/message/attme"},a.createElement("li",null,"@ 我的",a.createElement("div",{className:"message-counterLi displaynone",id:"unreadCount-atCount"},"(",n.atCount,")"))),a.createElement(l.Link,{to:"/message/system"},a.createElement("li",null,"系统通知",a.createElement("div",{className:"message-counterLi displaynone",id:"unreadCount-systemCount"},"(",n.systemCount,")"))),a.createElement(l.Link,{to:"/message/message"},a.createElement("li",null,"我的私信",a.createElement("div",{className:"message-counterLi displaynone",id:"unreadCount-messageCount"},"(",n.messageCount,")"))))))}return a.createElement("div",{className:"topBarUserInfo"},a.createElement("div",{className:"topBarText"}," ",a.createElement(l.Link,{to:"/logOn"},"登录")),a.createElement("div",{className:"topBarText"},a.createElement("a",{href:"https://account.cc98.org/"},"注册")))},t}(a.Component);var p=i.connect(function(e){return{userInfo:e.userInfo.currentUserInfo,isLogOn:e.userInfo.isLogOn}},function(e){return{logOff:function(){e(c.userLogOff())},reLogOn:function(t){s.changeTheme(t.theme),e(c.changeUserInfo(t)),e(c.userLogIn())},refreshUserInfo:function(){e(u.refreshCurrentUserInfo())}}})(d),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,i,c=this;return r.__generator(this,function(l){return e=o(".searchBoxSelect"),t=o(".caret-down"),n=o(".searchBoxSub"),a=o(".searchIco"),i=n.find("li"),o(document).click(function(){n.css("display","none")}),e.click(function(){return"block"===n.css("display")?n.css("display","none"):n.css("display","block"),!1}),t.click(function(){return"block"===n.css("display")?n.css("display","none"):n.css("display","block"),!1}),i.click(function(){e.text(o(this).text())}),i.mouseover(function(){this.className="hover"}),i.mouseout(function(){this.className=""}),this,a.click(function(){return r.__awaiter(c,void 0,void 0,function(){var t,n,a,i,c,l,u,d;return r.__generator(this,function(r){switch(r.label){case 0:return(t=o("#searchText").val())&&""!=t?"主题"!==e.text()&&"全站"!==e.text()?[3,1]:(this.props.history.push("/search?boardId=0&keyword="+encodeURI(encodeURI(t))),[3,8]):[3,8];case 1:return"版内"!==e.text()?[3,5]:(n=location.href.match(/\/topic\/(\d+)/),a=location.href.match(/\/list\/(\d+)/),i=location.href.match(/\/search\?boardId=(\d+)&/),c=0,n?(l=n[1],[4,s.getTopicInfo(l)]):[3,3]);case 2:return u=r.sent(),c=u.boardId,[3,4];case 3:a?c=parseInt(a[1]):i&&(c=parseInt(i[1]),i[1]),r.label=4;case 4:return this.props.history.push("/search?boardId="+c+"&keyword="+encodeURI(encodeURI(t))),[3,8];case 5:return"用户"!==e.text()?[3,7]:[4,s.getUserInfoByName(t)];case 6:return(d=r.sent())?this.props.history.push("/user/id/"+d.id):this.props.history.push("/search"),[3,8];case 7:"版面"===e.text()&&this.props.history.push("/searchBoard?keyword="+encodeURI(encodeURI(t))),r.label=8;case 8:return[2]}})})}),[2]})})},t.prototype.keypress_submit=function(e){var t=e||window.event;13===(t.which||t.keyCode||t.charCode)?o(".searchIco").click():"Enter"===t.key&&o(".searchIco").click()},t.prototype.render=function(){var e=location.href.match(/\/topic\/(\d+)/),t=location.href.match(/\/list\/(\d+)/),n=location.href.match(/\/(searchBoard)/),r=location.href.match(/\/search\?boardId=(\d+)/),s=1;return e?s=0:t?s=0:n||r&&0!==parseInt(r[1])&&(s=0),s?a.createElement("div",{id:"search"},a.createElement("div",{className:"box"},a.createElement("div",{className:"searchBoxSelect"},"主题"),a.createElement("div",{className:"caret-down"},a.createElement("i",{className:"fa fa-caret-down"})),a.createElement("input",{id:"searchText",type:"text",placeholder:"请输入搜索内容",onKeyPress:this.keypress_submit}),a.createElement("div",{className:"searchIco"},a.createElement("i",{className:"fa fa-search"}))),a.createElement("ul",{className:"searchBoxSub"},a.createElement("li",null,"主题"),a.createElement("li",null,"用户"),a.createElement("li",null,"版面"),a.createElement("li",{style:{display:"none"}}))):a.createElement("div",{id:"search"},a.createElement("div",{className:"box"},a.createElement("div",{className:"searchBoxSelect"},"版内"),a.createElement("div",{className:"caret-down"},a.createElement("i",{className:"fa fa-caret-down"})),a.createElement("input",{id:"searchText",type:"text",placeholder:"请输入搜索内容",onKeyPress:this.keypress_submit}),a.createElement("div",{className:"searchIco"},a.createElement("i",{className:"fa fa-search"}))),a.createElement("ul",{className:"searchBoxSub"},a.createElement("li",null,"版内"),a.createElement("li",null,"全站"),a.createElement("li",null,"用户"),a.createElement("li",null,"版面")))},t}(a.Component);t.SearchBeforeConnent=m,t.Search=l.withRouter(m);var h=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(n,e),n.prototype.refreshUnReadCount=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,s.refreshUnReadCount()];case 1:return e.sent(),[2]}})})},n.prototype.render=function(){return"/"===location.pathname?a.createElement("div",{className:"header"},a.createElement("div",{className:"topBar-mainPage"},a.createElement("div",{className:"topBarRow"},a.createElement("div",{className:"row",style:{display:"flex",flexDirection:"row",alignItems:"center"}},a.createElement("div",{className:"topBarLogo",onClick:this.refreshUnReadCount},a.createElement(l.Link,{to:"/"},a.createElement("img",{src:"/static/images/98LOGO.ico"}))),a.createElement("div",{className:"topBarCC98",onClick:this.refreshUnReadCount},a.createElement(l.Link,{to:"/"},"CC98论坛")),a.createElement("div",{className:"topBarText"},"|"),a.createElement("div",{className:"topBarText"},a.createElement(l.Link,{to:"/boardList"},"版面列表")),a.createElement("div",{className:"topBarText"},a.createElement(l.Link,{to:"/newTopics"},"新帖")),a.createElement("div",{className:"topBarText"},a.createElement(l.Link,{to:"/focus"},"关注")),a.createElement(l.Route,{component:t.Search})),a.createElement(p,null)))):a.createElement("div",{className:"headerWithoutImage"},a.createElement("div",{className:"topBar"},a.createElement("div",{className:"topBarRow"},a.createElement("div",{className:"row",style:{display:"flex",flexDirection:"row",alignItems:"center"}},a.createElement("div",{className:"topBarLogo"},a.createElement(l.Link,{to:"/"},a.createElement("img",{src:"/static/images/98LOGO.ico"}))),a.createElement("div",{className:"topBarCC98"},a.createElement(l.Link,{to:"/"},"CC98论坛")),a.createElement("div",{className:"topBarText"},"|"),a.createElement("div",{className:"topBarText"},a.createElement(l.Link,{to:"/boardList"},"版面列表")),a.createElement("div",{className:"topBarText"},a.createElement(l.Link,{to:"/newTopics"},"新帖")),a.createElement("div",{className:"topBarText"},a.createElement(l.Link,{to:"/focus"},"关注")),a.createElement(l.Route,{component:t.Search})),a.createElement(p,null))))},n}(a.Component);t.Header=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(146),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){$("#myFocusBoard").removeClass("focus-title-hover"),$("#myFocusUser").addClass("focus-title-hover")},t.prototype.render=function(){return a.createElement("div",null,a.createElement(s.FocusTopicArea,{id:-1,name:"关注用户"}))},t}(a.Component);t.FocusUserArea=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(146),o=n(4),i=function(e){function t(t){var n=e.call(this,t)||this;n.coverFocusBoard=function(e){return a.createElement("div",{className:"focus-board",id:"focusBoard_"+e.id},e.name)};var r=o.getStorage("focusBoardList");r||(r=[]);var s=o.getStorage("currentFocusBoard"),i=0,c="全站帖子";return s&&(i=s.boardId,c=s.boardName),n.state={data:r,currentBoardId:i,currentBoardName:c},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,s,i,c,l,u;return r.__generator(this,function(r){switch(r.label){case 0:return[4,o.refreshUnReadCount()];case 1:r.sent(),$("#myFocusUser").removeClass("focus-title-hover"),$("#myFocusBoard").addClass("focus-title-hover"),e=[],t=o.getLocalStorage("accessToken"),n=o.getLocalStorage("userInfo"),a=n.customBoards,(new Headers).append("Authorization",t),s=0,i=a,r.label=2;case 2:return s<i.length?(c=i[s],[4,o.getBoardName(c)]):[3,5];case 3:l=r.sent(),e.push({id:c,name:l}),r.label=4;case 4:return s++,[3,2];case 5:return this.setState({data:e}),o.setStorage("focusBoardList",e),$("#focusBoard_"+this.state.currentBoardId).addClass("focus-hover"),u=this,$(".focus-board").click(function(){var e=this.id.slice(11),t={boardId:e,boardName:this.innerHTML};o.setStorage("currentFocusBoard",t),$(".focus-board").removeClass("focus-hover"),$(this).addClass("focus-hover"),u.setState({currentBoardId:parseInt(e),currentBoardName:this.innerHTML})}),$(".focus-board").dblclick(function(){var e=this.id.slice(11);window.location.href="/list/"+e}),[2]}})})},t.prototype.render=function(){return a.createElement("div",null,a.createElement("div",{className:"focus-board-area"},a.createElement("div",{className:"focus-board",id:"focusBoard_0"},"全部帖子"),this.state.data.map(this.coverFocusBoard),a.createElement("div",{className:"focus-boardTip"},"提示：单击版面标签可切换下方展示内容，双击可直接进入版面")),a.createElement(s.FocusTopicArea,{id:this.state.currentBoardId,name:this.state.currentBoardName}))},t}(a.Component);t.FocusBoardArea=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(228),o=n(227),i=n(6),c=n(16),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"focus-root"},a.createElement(c.default,{title:"我的关注 - CC98论坛"}),a.createElement(i.BrowserRouter,null,a.createElement("div",{className:"focus"},a.createElement("div",{className:"focus-nav"},a.createElement(i.Link,{to:"/focus/board"}," ",a.createElement("div",{className:"focus-title",id:"myFocusBoard"},"关注版面")),a.createElement(i.Link,{to:"/focus/user"}," ",a.createElement("div",{className:"focus-title",id:"myFocusUser"},"关注用户"))),a.createElement(i.Route,{exact:!0,path:"/focus",component:s.FocusBoardArea}),a.createElement(i.Route,{path:"/focus/board",component:s.FocusBoardArea}),a.createElement(i.Route,{path:"/focus/user",component:o.FocusUserArea}))))},t}(a.Component);t.Focus=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(66),o=n(4),i=n(6),c=n(16),l=function(e){function t(t){var n=e.call(this,t)||this,r=o.getStorage("AllNewTopic");return r||(r=[]),n.state={data:r,from:0,loading:!0,buttonClassName:""},n.handleScroll=n.handleScroll.bind(n),n}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,o.refreshUnReadCount()];case 1:return t.sent(),[4,o.getAllNewTopic(0,this.context.router)];case 2:return(e=t.sent())&&(o.setStorage("AllNewTopic",e),this.setState({data:e,from:e.length})),document.addEventListener("scroll",this.handleScroll),[2]}})})},t.prototype.componentWillUnmount=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return document.removeEventListener("scroll",this.handleScroll),[2]})})},t.prototype.scrollToTop=function(){$("body,html").animate({scrollTop:0},500)},t.prototype.handleScroll=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n;return r.__generator(this,function(r){switch(r.label){case 0:if(window.pageYOffset>234&&this.setState({buttonClassName:"btn-show"}),window.pageYOffset<234&&this.setState(function(e){return{buttonClassName:""===e.buttonClassName?"":"btn-disappare"}}),!o.isBottom()||!this.state.loading)return[3,5];if(this.state.from>99)return $("#focus-topic-loading").addClass("displaynone"),$("#focus-topic-loaddone").removeClass("displaynone"),[2];this.setState({loading:!1}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,o.getAllNewTopic(this.state.from,this.context.router)];case 2:return e=r.sent(),[3,4];case 3:return r.sent(),this.setState({loading:!0}),[2];case 4:if(!(e&&e.length>0))return this.setState({loading:!0}),[2];for(t=this.state.data,n=0;n<t.length&&t[n].id!==e[0].id;n++);t=t.slice(0,n).concat(e),this.setState({data:t,from:t.length,loading:!0}),o.setStorage("AllNewTopic",t),r.label=5;case 5:return[2]}})})},t.prototype.render=function(){return a.createElement("div",{className:"focus-root"},a.createElement(c.default,{title:"查看新帖 - CC98论坛"}),a.createElement("div",{className:"focus"},a.createElement(d,null),a.createElement("div",{className:"focus-topic-area"},a.createElement("div",{className:"focus-topic-topicArea"},this.state.data.map(u)),a.createElement("div",{className:"focus-topic-loading",id:"focus-topic-loading"},a.createElement("i",{style:{marginTop:"1rem"},className:"fa fa-spinner fa-pulse fa-5x fa-fw"})),a.createElement("div",{className:"focus-topic-loaddone displaynone",id:"focus-topic-loaddone"},"无法加载更多了，小水怡情，可不要沉迷哦~"),a.createElement("button",{type:"button",id:"scrollToTop",className:this.state.buttonClassName,onClick:this.scrollToTop},"回到顶部"))))},t}(a.Component);function u(e){return a.createElement(s.FocusTopicSingle,{title:e.title,hitCount:e.hitCount,id:e.id,boardId:e.boardId,boardName:e.boardName,replyCount:e.replyCount,userId:e.userId,userName:e.userName,portraitUrl:e.portraitUrl,time:e.time,likeCount:e.likeCount,dislikeCount:e.dislikeCount,lastPostUser:e.lastPostUser,lastPostTime:e.lastPostTime,tag1:e.tag1,tag2:e.tag2,floorCount:e.floorCount})}t.AllNewTopic=l;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},a.createElement(i.Link,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),a.createElement("i",{className:"fa fa-chevron-right"}),a.createElement("div",{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"}},"查看新帖"))},t}(a.Component);t.Category=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(16),i=n(105),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){return(e=s.getLocalStorage("noticeSetting"))?("否"===e.response?($("#responseSetting1").removeAttr("checked"),$("#responseSetting2").attr("checked","checked")):($("#responseSetting1").attr("checked","checked"),$("#responseSetting2").removeAttr("checked")),"否"===e.attme?($("#attmeSetting1").removeAttr("checked"),$("#attmeSetting2").attr("checked","checked")):($("#attmeSetting1").attr("checked","checked"),$("#attmeSetting2").removeAttr("checked")),"否"===e.system?($("#systemSetting1").removeAttr("checked"),$("#systemSetting2").attr("checked","checked")):($("#systemSetting1").attr("checked","checked"),$("#systemSetting2").removeAttr("checked")),"否"===e.message?($("#messageSetting1").removeAttr("checked"),$("#messageSetting2").attr("checked","checked")):($("#messageSetting1").attr("checked","checked"),$("#messageSetting2").removeAttr("checked")),"否"===e.post?($("#postSetting1").removeAttr("checked"),$("#postSetting2").attr("checked","checked")):($("#postSetting1").attr("checked","checked"),$("#postSetting2").removeAttr("checked"))):(t={response:"是",attme:"是",system:"是",message:"是",post:"否"},s.setLocalStorage("noticeSetting",t)),[2]})})},t.prototype.setMessageSetting=function(){var e={response:$('input:radio[name="responseSetting"]:checked').val(),attme:$('input:radio[name="attmeSetting"]:checked').val(),system:$('input:radio[name="systemSetting"]:checked').val(),message:$('input:radio[name="messageSetting"]:checked').val(),post:$('input:radio[name="postSetting"]:checked').val()};s.setLocalStorage("noticeSetting",e),s.noticeMessageShow("saveSuccess")},t.prototype.render=function(){return a.createElement("div",{className:"message-right"},a.createElement(o.default,{title:"消息设置-CC98论坛"}),a.createElement("div",{className:"message-setting"},a.createElement("div",{className:"message-settingbox"},a.createElement("div",{className:"radioTitle"},"是否显示回复通知"),a.createElement("input",{type:"radio",name:"responseSetting",id:"responseSetting1",value:"是",checked:!0}),a.createElement("div",null,"是"),a.createElement("input",{type:"radio",name:"responseSetting",id:"responseSetting2",value:"否"}),a.createElement("div",null,"否")),a.createElement("div",{className:"message-settingbox"},a.createElement("div",{className:"radioTitle"},"是否显示@通知"),a.createElement("input",{type:"radio",name:"attmeSetting",id:"attmeSetting1",value:"是",checked:!0}),a.createElement("div",null,"是"),a.createElement("input",{type:"radio",name:"attmeSetting",id:"attmeSetting2",value:"否"}),a.createElement("div",null,"否")),a.createElement("div",{className:"message-settingbox"},a.createElement("div",{className:"radioTitle"},"是否显示系统通知"),a.createElement("input",{type:"radio",name:"systemSetting",id:"systemSetting1",value:"是",checked:!0}),a.createElement("div",null,"是"),a.createElement("input",{type:"radio",name:"systemSetting",id:"systemSetting2",value:"否"}),a.createElement("div",null,"否")),a.createElement("div",{className:"message-settingbox"},a.createElement("div",{className:"radioTitle"},"是否显示私信通知"),a.createElement("input",{type:"radio",name:"messageSetting",id:"messageSetting1",value:"是",checked:!0}),a.createElement("div",null,"是"),a.createElement("input",{type:"radio",name:"messageSetting",id:"messageSetting2",value:"否"}),a.createElement("div",null,"否")),a.createElement("div",{className:"message-settingbox"},a.createElement("div",{className:"radioTitle"},"回帖是否跳至最新回复"),a.createElement("input",{type:"radio",name:"postSetting",id:"postSetting1",value:"是"}),a.createElement("div",null,"是"),a.createElement("input",{type:"radio",name:"postSetting",id:"postSetting2",value:"否",checked:!0}),a.createElement("div",null,"否")),a.createElement("button",{className:"message-setting-btn",onClick:this.setMessageSetting},"保存消息设置"),a.createElement(i.NoticeMessage,{text:"保存成功",id:"saveSuccess",top:"31%",left:"43%"})))},t}(a.Component);t.MessageSetting=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(22),o=n(72),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e;if(this.props.topicId)if(this.props.floor){var t=this.props.floor/10+1,n=parseInt(t),r=this.props.floor+10-10*n,i=n+"#"+r;0===r&&(i=n-1+"#10"),e=this.props.isRead?"[url=/topic/"+this.props.topicId+"/"+i+"][color=gray]"+this.props.content+"[/color][/url]":"[url=/topic/"+this.props.topicId+"/"+i+"][b][color=black]"+this.props.content+"[/color][/b][/url]"}else e=this.props.isRead?"[url=/topic/"+this.props.topicId+"][color=gray]"+this.props.content+"[/color][/url]":"[url=/topic/"+this.props.topicId+"][b][color=black]"+this.props.content+"[/color][/b][/url]";else e=this.props.isRead?"[color=gray]"+this.props.content+"[/color]":"[color=black][b]"+this.props.content+"[/b][/color]";return a.createElement("div",{className:"message-system-box"},a.createElement("div",{className:"message-system-box-bar"},a.createElement("div",{className:"message-system-box-title"},this.props.title),a.createElement("div",{className:"message-system-box-date"},moment(this.props.time).format("YYYY-MM-DD HH:mm:ss"))),a.createElement("div",{className:"message-system-box-content"},a.createElement(s.UbbContainer,{code:e,options:{allowExternalImage:!1,allowAutoPlay:!1,autoDetectUrl:!0,allowExternalUrl:!0,allowImage:!0,allowMediaContent:!1,compatibility:o.UbbCompatiblityMode.Recommended,allowEmotion:!1}})))},t}(a.Component);t.MessageSystembox=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(232),o=n(4),i=n(59),c=n(16),l=function(e){function t(t){var n=e.call(this,t)||this;return n.coverMessageSystem=function(e){return a.createElement(s.MessageSystembox,{id:e.id,type:e.type,title:e.title,content:e.content,time:e.time,topicId:e.topicId,floor:e.floor,isRead:e.isRead})},n.state={data:[],from:0,loading:!0,totalPage:1},n}return r.__extends(t,e),t.prototype.getData=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return t=10,$(".message-nav > div").removeClass("message-nav-focus"),$("#system").addClass("message-nav-focus"),[4,o.getTotalPage(3)];case 1:return n=r.sent(),a=parseInt((n-.5)/t)+1,(!(s=e.match.params.page-1)||s<0)&&(s=0),[4,o.getMessageSystem(s*t,t,this.context.router)];case 2:return(i=r.sent())&&this.setState({data:i,from:s+1,totalPage:a}),0==s&&(c={data:i,from:s+1,totalPage:a},o.setStorage("systemState",c)),[4,o.refreshUnReadCount()];case 3:return r.sent(),[2]}})})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){return e=o.getStorage("unreadCount"),t=o.getStorage("systemState"),0===e.systemCount&&t?this.setState(t):this.getData(this.props),[2]})})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){return this.getData(e),[2]})})},t.prototype.render=function(){return a.createElement("div",{className:"message-right"},a.createElement(c.default,{title:"系统通知-CC98论坛"}),a.createElement("div",{className:"message-system"},this.state.data.map(this.coverMessageSystem)),a.createElement("div",{className:"message-pager"},a.createElement(i.Pager,{url:"/message/system/",page:this.state.from,totalPage:this.state.totalPage})))},t}(a.Component);t.MessageSystem=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(22),o=n(72),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e="[url=/list/"+this.props.boardId+"][color=dodgerblue]"+this.props.boardName+"[/color][/url]";0===this.props.boardId&&(e="[color=dodgerblue]"+this.props.boardName+"[/color]");var t,n=this.props.floor/10+1,r=parseInt(n),i=this.props.floor+10-10*r,c=r+"#"+i;if(0===i&&(c=r-1+"#10"),this.props.isRead){t=" "+(this.props.userId>0?"[url=/user/id/"+this.props.userId+"][color=gray]"+this.props.userName+"[/color][/url]":"[color=gray]"+this.props.userName+"[/color]")+" [color=gray]在《"+(this.props.boardId?"[url=/topic/"+this.props.topicId+"/"+c+"][color=#0b5394]"+this.props.topicTitle+"[/color][/url]":"[color=#0b5394]"+this.props.topicTitle+"[/color]")+"》中@了你。[/color]"}else{t=" "+(this.props.userId>0?"[url=/user/id/"+this.props.userId+"][color=gray][b]"+this.props.userName+"[/b][/color][/url]":"[color=gray][b]"+this.props.userName+"[/b][/color]")+" [color=gray][b]在《"+(this.props.boardId?"[url=/topic/"+this.props.topicId+"/"+c+"][color=#0b5394]"+this.props.topicTitle+"[/color][/url]":"[color=#0b5394]"+this.props.topicTitle+"[/color]")+"》中@了你。[/b][/color]"}return a.createElement("div",{className:"message-response-box"},a.createElement("div",{className:"message-response-box-middle"},a.createElement("div",{className:"message-response-box-middle1"},a.createElement("div",{className:"message-response-box-middle-title"},a.createElement(s.UbbContainer,{code:e})),a.createElement("div",{className:"message-response-box-middle-date"},moment(this.props.time).format("YYYY-MM-DD HH:mm:ss"))),a.createElement("div",{className:"message-response-box-middle-content"},a.createElement(s.UbbContainer,{code:t,options:{allowExternalImage:!1,allowAutoPlay:!1,autoDetectUrl:!0,allowExternalUrl:!0,allowImage:!1,allowMediaContent:!1,compatibility:o.UbbCompatiblityMode.Recommended,allowEmotion:!1}}))))},t}(a.Component);t.MessageAttmebox=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(234),o=n(4),i=n(59),c=n(16),l=function(e){function t(t){var n=e.call(this,t)||this;return n.coverMessageAttme=function(e){return a.createElement(s.MessageAttmebox,{id:e.id,type:e.type,time:e.time,topicId:e.topicId,topicTitle:e.topicTitle,floor:e.floor,userId:e.userId,userName:e.userName,boardId:e.boardId,boardName:e.boardName,isRead:e.isRead})},n.state={data:[],from:0,loading:!0,totalPage:1},n}return r.__extends(t,e),t.prototype.getData=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return t=10,$(".message-nav > div").removeClass("message-nav-focus"),$("#attme").addClass("message-nav-focus"),[4,o.getTotalPage(2)];case 1:return n=r.sent(),a=parseInt((n-.5)/t)+1,(!(s=e.match.params.page-1)||s<0)&&(s=0),[4,o.getMessageAttme(s*t,t,this.context.router)];case 2:return(i=r.sent())&&this.setState({data:i,from:s+1,totalPage:a}),0==s&&(c={data:i,from:s+1,totalPage:a},o.setStorage("atState",c)),[4,o.refreshUnReadCount()];case 3:return r.sent(),[2]}})})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){return e=o.getStorage("unreadCount"),t=o.getStorage("atState"),0===e.atCount&&t?this.setState(t):this.getData(this.props),[2]})})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){return this.getData(e),[2]})})},t.prototype.render=function(){return a.createElement("div",{className:"message-right"},a.createElement(c.default,{title:"@我的-CC98论坛"}),a.createElement("div",{className:"message-response"},this.state.data.map(this.coverMessageAttme)),a.createElement("div",{className:"message-pager"},a.createElement(i.Pager,{url:"/message/attme/",page:this.state.from,totalPage:this.state.totalPage})))},t}(a.Component);t.MessageAttme=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(22),o=n(72),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e="[url=/list/"+this.props.boardId+"][color=dodgerblue]"+this.props.boardName+"[/color][/url]";0===this.props.boardId&&(e="[color=dodgerblue]"+this.props.boardName+"[/color]");var t,n=this.props.floor/10+1,r=parseInt(n),i=this.props.floor+10-10*r,c=r+"#"+i;if(0===i&&(c=r-1+"#10"),this.props.isRead){t=" "+(this.props.userId>0?"[url=/user/id/"+this.props.userId+"][color=gray]"+this.props.userName+"[/color][/url]":"[color=gray]"+this.props.userName+"[/color]")+" [color=gray]在《"+(this.props.boardId?"[url=/topic/"+this.props.topicId+"/"+c+"][color=#0b5394]"+this.props.topicTitle+"[/color][/url]":"[color=#0b5394]"+this.props.topicTitle+"[/color]")+"》中回复了你。[/color]"}else{t=" "+(this.props.userId>0?"[url=/user/id/"+this.props.userId+"][color=gray][b]"+this.props.userName+"[/b][/color][/url]":"[color=gray][b]"+this.props.userName+"[/b][/color]")+" [color=gray][b]在《"+(this.props.boardId?"[url=/topic/"+this.props.topicId+"/"+c+"][color=#0b5394]"+this.props.topicTitle+"[/color][/url]":"[color=#0b5394]"+this.props.topicTitle+"[/color]")+"》中回复了你。[/b][/color]"}return a.createElement("div",{className:"message-response-box"},a.createElement("div",{className:"message-response-box-middle"},a.createElement("div",{className:"message-response-box-middle1"},a.createElement("div",{className:"message-response-box-middle-title"},a.createElement(s.UbbContainer,{code:e})),a.createElement("div",{className:"message-response-box-middle-date"},moment(this.props.time).format("YYYY-MM-DD HH:mm:ss"))),a.createElement("div",{className:"message-response-box-middle-content"},a.createElement(s.UbbContainer,{code:t,options:{allowAutoPlay:!1,autoDetectUrl:!0,allowExternalUrl:!0,allowImage:!1,allowMediaContent:!1,compatibility:o.UbbCompatiblityMode.Recommended,allowEmotion:!1,allowExternalImage:!1}}))))},t}(a.Component);t.MessageResponsebox=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(236),o=n(4),i=n(59),c=n(16),l=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.coverMessageResponse=function(e){return a.createElement(s.MessageResponsebox,{id:e.id,type:e.type,time:e.time,topicId:e.topicId,topicTitle:e.topicTitle,floor:e.floor,userId:e.userId,userName:e.userName,boardId:e.boardId,boardName:e.boardName,isRead:e.isRead})},r.state={data:[],from:0,loading:!0,totalPage:1},r}return r.__extends(t,e),t.prototype.getData=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return t=10,$(".message-nav > div").removeClass("message-nav-focus"),$("#response").addClass("message-nav-focus"),[4,o.getTotalPage(1)];case 1:return n=r.sent(),a=parseInt((n-.5)/t)+1,(!(s=e.match.params.page-1)||s<0)&&(s=0),[4,o.getMessageResponse(s*t,t,this.context.router)];case 2:return(i=r.sent())&&this.setState({data:i,from:s+1,totalPage:a}),0==s&&(c={data:i,from:s+1,totalPage:a},o.setStorage("responseState",c)),[4,o.refreshUnReadCount()];case 3:return r.sent(),[2]}})})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){return e=o.getStorage("unreadCount"),t=o.getStorage("responseState"),0===e.replyCount&&t?this.setState(t):this.getData(this.props),[2]})})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){return this.getData(e),[2]})})},t.prototype.render=function(){return a.createElement("div",{className:"message-right"},a.createElement(c.default,{title:"回复我的-CC98论坛"}),a.createElement("div",{className:"message-response"},this.state.data.map(this.coverMessageResponse)),a.createElement("div",{className:"message-pager"},a.createElement(i.Pager,{url:"/message/response/",page:this.state.from,totalPage:this.state.totalPage})))},t}(a.Component);t.MessageResponse=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(22),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e,t="/user/id/"+this.props.senderId;return e=this.props.showTime?"message-message-wcTime":"displaynone",a.createElement("div",{className:"message-message-wc"},a.createElement("div",{className:e},moment(this.props.time).format("YYYY-MM-DD HH:mm:ss")),a.createElement("div",{className:"message-message-wcReceiver"},a.createElement("a",{href:t,target:"_blank"},a.createElement("img",{className:"message-message-wcPortraitUrl",src:this.props.senderPortraitUrl})),a.createElement("div",{className:"message-message-wcContent"},a.createElement("div",{className:"message-message-wcText",id:String(this.props.id)},a.createElement(s.UbbContainer,{code:this.props.content})))))},t}(a.Component);t.MessageReceiver=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(22),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e,t="/user/id/"+this.props.senderId;return e=this.props.showTime?"message-message-wcTime":"displaynone",a.createElement("div",{className:"message-message-wc"},a.createElement("div",{className:e},moment(this.props.time).format("YYYY-MM-DD HH:mm:ss")),a.createElement("div",{className:"message-message-wcSender"},a.createElement("a",{href:t,target:"_blank"},a.createElement("img",{className:"message-message-wcPortraitUrl",src:this.props.senderPortraitUrl})),a.createElement("div",{className:"message-message-wcContent"},a.createElement("div",{id:String(this.props.id),className:"message-message-wcText"},a.createElement(s.UbbContainer,{code:this.props.content})))))},t}(a.Component);t.MessageSender=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(239),o=n(238),i=n(4),c=n(16),l=function(e){function t(t){var n=e.call(this,t)||this;return n.coverMessageProps=function(e){var t=i.getLocalStorage("userInfo"),r=n.props.data;return e.receiverId==t.id?a.createElement(o.MessageReceiver,{id:e.id,senderName:r.name,senderId:r.id,receiverName:t.name,receiverId:t.id,senderPortraitUrl:r.portraitUrl,receiverPortraitUrl:t.portraitUrl,content:e.content,isRead:e.isRead,time:e.time,showTime:e.showTime}):e.senderId==t.id?a.createElement(s.MessageSender,{id:e.id,senderName:t.name,senderId:t.id,receiverName:r.name,receiverId:r.id,senderPortraitUrl:t.portraitUrl,receiverPortraitUrl:r.portraitUrl,content:e.content,isRead:e.isRead,time:e.time,showTime:e.showTime}):void 0},n.report=function(){alert("举报他人恶意私信请到【论坛事务】按照格式发帖投诉，记得截图保留证据，管理员会及时进行处理！感谢您对CC98的支持！")},n.state={data:[]},n.getNewMessage=n.getNewMessage.bind(n),n.postMessage=n.postMessage.bind(n),n.getMoreMessage=n.getMoreMessage.bind(n),n}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return this.getData(this.props),[2]})})},t.prototype.getData=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s,o,c;return r.__generator(this,function(r){switch(r.label){case 0:return e.data?[4,i.getRecentMessage(e.data.id,0,10,this.context.router)]:[3,4];case 1:return t=r.sent(),0==(n=i.getStorage("unreadCount"))||0==n.messageCount?[3,3]:[4,i.refreshUnReadCount()];case 2:r.sent(),r.label=3;case 3:if(t&&t.length>0){if((a=e.data.message)&&a.length>0)for(o in t)if(t[o].id==a[0].id){t=t.slice(0,o).concat(a),t=i.sortRecentMessage(t);break}if(s=i.getStorage("recentContact")){for(o in s)if(s[o].id==e.data.id){s[o].message=t;break}i.setStorage("recentContact",s)}this.setState({data:t.reverse()}),10===t.length?($("#wcGetMore").removeClass("displaynone"),$("#wcLoadingImg").addClass("displaynone"),$("#wcLoadingText").addClass("displaynone")):($("#wcGetMore").addClass("displaynone"),$("#wcLoadingImg").addClass("displaynone"),$("#wcLoadingText").removeClass("displaynone"))}r.label=4;case 4:return(c=document.getElementById("messageContent")).scrollTop=c.scrollHeight,[2]}})})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){return this.getData(e),[2]})})},t.prototype.getMoreMessage=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,s,o,c,l,u;return r.__generator(this,function(r){switch(r.label){case 0:return $("#wcGetMore").addClass("displaynone"),$("#wcLoadingImg").removeClass("displaynone"),e=this.state.data.reverse(),t=document.getElementById("messageContent"),n=t.scrollHeight,[4,i.getRecentMessage(this.props.data.id,e.length,10,this.context.router)];case 1:return a=r.sent(),0==(s=i.getStorage("unreadCount"))||0==s.messageCount?[3,3]:[4,i.refreshUnReadCount()];case 2:r.sent(),r.label=3;case 3:if(a&&a.length>0){if(o=e.concat(a),o=i.sortRecentMessage(o),this.setState({data:o.reverse()}),c=i.getStorage("recentContact")){for(l in c)if(c[l].id==this.props.data.id){c[l].message=o;break}i.setStorage("recentContact",c)}10===a.length?($("#wcGetMore").removeClass("displaynone"),$("#wcLoadingImg").addClass("displaynone")):($("#wcLoadingImg").addClass("displaynone"),$("#wcLoadingText").removeClass("displaynone"))}else $("#wcLoadingImg").addClass("displaynone"),$("#wcLoadingText").removeClass("displaynone");return u=t.scrollHeight,t.scrollTop=u-n-25,[2]}})})},t.prototype.getNewMessage=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,s,o,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return[4,i.getRecentMessage(this.props.data.id,0,10,this.context.router)];case 1:if(e=r.sent(),t=[],n=i.getStorage("recentContact")){for(a=0;a<n.length;a++)if(n[a].id==this.props.data.id){if((t=n[a].message)!=[])for(s=0;s<e.length;s++)if(e[s].id==t[0].id){e=e.slice(0,s).concat(t),e=i.sortRecentMessage(e);break}n[a].message=e,n[a].lastContent=e[0].content;break}a==n.length?((o=[this.props.data])[0].message=e,o[0].lastContent=e[0].content,n=o.concat(n),i.setStorage("recentContact",n),this.props.onChange()):0==a?(i.setStorage("recentContact",n),this.setState({data:e.reverse()}),this.props.onChange()):(c=n[a],n.splice(a,1),n.unshift(c),i.setStorage("recentContact",n),this.props.onChange())}return(l=document.getElementById("messageContent")).scrollTop=l.scrollHeight,[2]}})})},t.prototype.handleFocus=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return $("#wPostNotice").addClass("displaynone"),$("#wPostError").addClass("displaynone"),$("#postContent")[0].focus(),[2]})})},t.prototype.handleBlur=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return""==$("#postContent").val()&&("none"==$("#wPostNotice").css("display")?$("#wPostNotice").removeClass("displaynone"):$("#wPostNotice").addClass("displaynone")),[2]})})},t.prototype.postMessage=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n;return r.__generator(this,function(r){switch(r.label){case 0:return""===(e=$("#postContent").val())?[2]:(t={receiverId:this.props.data.id,content:e},n=JSON.stringify(t),[4,i.sendMessage(n,this.context.router)]);case 1:return 403==r.sent().status?($("#postContent").val(""),$("#wPostError").removeClass("displaynone"),[2]):(setTimeout(this.getNewMessage,200),$("#postContent").val(""),[2])}})})},t.prototype.render=function(){var e=this.props.data;return e?a.createElement("div",{className:"message-message-window"},a.createElement(c.default,{title:"与 "+e.name+" 的私信-CC98论坛"}),a.createElement("div",{className:"message-message-wHeader"},a.createElement("div",{className:"message-message-wReport"}),a.createElement("div",{className:"message-message-wTitle"},"与 ",e.name," 的私信"),a.createElement("div",{className:"message-message-wReport displaynone"},a.createElement("button",{onClick:this.report},"举报"))),a.createElement("div",{className:"message-message-wContent",id:"messageContent"},a.createElement("div",{className:"message-message-wcLoading"},a.createElement("div",{id:"wcGetMore",className:"message-message-wcLoadingMore",onClick:this.getMoreMessage},"点击加载更多..."),a.createElement("img",{src:"http://file.cc98.org/uploadfile/2017/11/19/2348481046.gif",id:"wcLoadingImg",className:"displaynone"}),a.createElement("div",{id:"wcLoadingText",className:"message-message-wcLoadingText displaynone"},"没有更多消息了~")),this.state.data.map(this.coverMessageProps)),a.createElement("div",{className:"message-message-wPost"},a.createElement("textarea",{className:"message-message-wPostArea",id:"postContent",onFocus:this.handleFocus,onBlur:this.handleBlur}),a.createElement("div",{id:"wPostNotice",className:"message-message-wPostNotice",onClick:this.handleFocus},"请在这里填入您要发送的私信内容"),a.createElement("div",{id:"wPostError",className:"message-message-wPostError displaynone",onClick:this.handleFocus},"您的发送过快，请稍作歇息~"),a.createElement("button",{className:"message-message-wPostBtn",onClick:this.postMessage},"发送"))):a.createElement("div",{className:"message-message-window"},a.createElement("div",{className:"message-message-wHeader"},a.createElement("div",{className:"message-message-wReport"}),a.createElement("div",{className:"message-message-wTitle"},"无当前聊天对象"),a.createElement("div",{className:"message-message-wReport displaynone"},a.createElement("button",{onClick:this.report},"举报"))),a.createElement("div",{className:"message-message-wContent",id:"messageContent"},a.createElement("div",{className:"message-message-wcLoading"},a.createElement("img",{src:"http://file.cc98.org/uploadfile/2017/11/19/2348481046.gif",id:"wcLoadingImg",className:"displaynone"}),a.createElement("div",{id:"wcLoadingText",className:"message-message-wcLoadingText displaynone"},"没有更多消息了~"))),a.createElement("div",{className:"message-message-wPost"},a.createElement("textarea",{className:"message-message-wPostArea",id:"postContent",onFocus:this.handleFocus,onBlur:this.handleBlur}),a.createElement("div",{id:"wPostNotice",className:"message-message-wPostNotice",onClick:this.handleFocus},"请在这里填入您要发送的私信内容"),a.createElement("div",{id:"wPostError",className:"message-message-wPostError displaynone",onClick:this.handleFocus},"您的发送过快，请稍作歇息~"),a.createElement("button",{className:"message-message-wPostBtn",onClick:this.postMessage},"发送")))},t}(a.Component);t.MessageWindow=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(22),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.data;return e.lastContent||(e.lastContent=""),a.createElement("div",{className:"message-message-person"},a.createElement("img",{className:"message-message-pPortraitUrl",src:e.portraitUrl}),a.createElement("div",{className:"message-message-pInfo"},a.createElement("div",{className:"message-message-pName"},e.name),a.createElement("div",{className:"message-message-pMessage"},a.createElement(s.UbbContainer,{code:e.lastContent}))),a.createElement(i,{isRead:e.isRead}))},t}(a.Component);t.MessagePerson=o;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return this.props.isRead?a.createElement("div",{className:"message-counterPerson displaynone"}):a.createElement("div",{className:"message-counterPerson"})},t}(a.Component)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(241),o=n(240),i=n(4),c=n(16),l=function(e){function t(t){var n=e.call(this,t)||this;return n.coverMessagePerson=function(e){var t=n,o=i.getStorage("recentContact");return a.createElement("div",{onClick:function(){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){for(n in t.setState({chatObj:e}),$(".message-message-pList > div").removeClass("message-message-pFocus"),$("#contact_"+e.id).addClass("message-message-pFocus"),o)o[n].id===e.id&&!1===o[n].isRead&&(o[n].isRead=!0,i.setStorage("recentContact",o),t.setState({data:o}));return[2]})})},id:"contact_"+e.id},a.createElement(s.MessagePerson,{data:e}))},n.state={data:null,chatObj:null},n.getMoreContact=n.getMoreContact.bind(n),n.onChange=n.onChange.bind(n),n}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return i.getLocalStorage("accessToken"),i.getLocalStorage("userInfo"),"message-counterNav"===$("#unreadCount-messageCount1").attr("class")&&i.removeStorage("recentContact"),(e=i.getStorage("recentContact"))&&0!==e.length?[3,2]:[4,i.getRecentContact(0,7,this.context.router)];case 1:e=n.sent(),i.setStorage("recentContact",e),n.label=2;case 2:return[4,i.sortContactList(e,this.context.router)];case 3:return(e=n.sent())&&this.setState({data:e,chatObj:e[0]}),(t=this.state.chatObj)&&$("#"+t.name).addClass("message-message-pFocus"),[2]}})})},t.prototype.getMoreContact=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return"none"!=$("#moreDone").css("display")?[3,2]:($("#moreImg").removeClass("displaynone"),$("#moreDot").addClass("displaynone"),$("#moreShow").addClass("displaynone"),e=i.getStorage("recentContact"),[4,i.getRecentContact(e.length,7,this.context.router)]);case 1:t=n.sent(),e=e.concat(t),this.setState({data:e}),i.setStorage("recentContact",e),t.length<7?($("#moreImg").addClass("displaynone"),$("#moreDone").removeClass("displaynone")):($("#moreImg").addClass("displaynone"),$("#moreDot").removeClass("displaynone"),$("#moreShow").removeClass("displaynone")),n.label=2;case 2:return[2]}})})},t.prototype.onChange=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){return e=i.getStorage("recentContact"),this.setState({data:e,chatObj:e[0]}),$(".message-message-pList > div").removeClass("message-message-pFocus"),$("#"+this.state.chatObj.name).addClass("message-message-pFocus"),[2]})})},t.prototype.render=function(){$(".message-nav > div").removeClass("message-nav-focus"),$("#message").addClass("message-nav-focus");var e=this.state.data,t=this.state.chatObj;return e?e.length>6?a.createElement("div",{className:"message-message"},a.createElement(c.default,{title:"我的私信-CC98论坛"}),a.createElement("div",{className:"message-message-people"},a.createElement("div",{className:"message-message-pTitle"},"近期私信"),a.createElement("div",{className:"message-message-pList"},e.map(this.coverMessagePerson),a.createElement("div",{className:"message-message-plMore",onClick:this.getMoreContact},a.createElement("img",{id:"moreImg",src:"http://file.cc98.org/uploadfile/2017/11/19/2348481046.gif",className:"displaynone"}),a.createElement("div",{id:"moreDot"},"..."),a.createElement("div",{id:"moreShow"},"显示更多小伙伴~"),a.createElement("div",{id:"moreDone",className:"displaynone"},"小伙伴们都出来了~")))),a.createElement(o.MessageWindow,{data:t,onChange:this.onChange})):a.createElement("div",{className:"message-message"},a.createElement("div",{className:"message-message-people"},a.createElement("div",{className:"message-message-pTitle"},"近期私信"),a.createElement("div",{className:"message-message-pList"},e.map(this.coverMessagePerson))),a.createElement(o.MessageWindow,{data:t,onChange:this.onChange})):a.createElement("div",{className:"message-message"},a.createElement("div",{className:"message-message-people"},a.createElement("div",{className:"message-message-pTitle"},"近期私信"),a.createElement("div",{className:"message-message-pList"})),a.createElement(o.MessageWindow,{data:null,onChange:this.onChange}))},t}(a.Component);t.MessageMessage=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(242),o=n(237),i=n(235),c=n(233),l=n(231),u=n(4),d=n(16),p=n(6),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e={totalCount:0,replyCount:0,atCount:0,systemCount:0,messageCount:0};return u.getStorage("unreadCount")&&(e=u.getStorage("unreadCount")),a.createElement("div",{className:"message-root"},a.createElement(d.default,{title:"CC98论坛-我的消息"}),a.createElement("div",{className:"message"},a.createElement("div",{className:"readAllMessage"},a.createElement("button",{className:"message-message-wPostBtn",onClick:u.readAll},"全部标为已读")),a.createElement("div",{className:"message-title"},"我的消息"),a.createElement(p.BrowserRouter,null,a.createElement("div",{className:"message-content"},a.createElement("div",{className:"message-nav"},a.createElement(p.NavLink,{to:"/message/response"},a.createElement("div",{id:"response",className:"nav-div"},"回复我的",a.createElement("div",{className:"message-counterNav displaynone",id:"unreadCount-replyCount1"},e.replyCount))),a.createElement("hr",null),a.createElement(p.NavLink,{to:"/message/attme"},a.createElement("div",{id:"attme",className:"nav-div"},"@ 我的",a.createElement("div",{className:"message-counterNav displaynone",id:"unreadCount-atCount1"},e.atCount))),a.createElement("hr",null),a.createElement(p.NavLink,{to:"/message/system"},a.createElement("div",{id:"system",className:"nav-div"},"系统通知",a.createElement("div",{className:"message-counterNav displaynone",id:"unreadCount-systemCount1"},e.systemCount))),a.createElement("hr",null),a.createElement(p.NavLink,{to:"/message/message"},a.createElement("div",{id:"message",className:"nav-div"},"我的私信",a.createElement("div",{className:"message-counterNav displaynone",id:"unreadCount-messageCount1"},e.messageCount))),a.createElement("hr",null),a.createElement(p.NavLink,{to:"/message/setting"},a.createElement("div",{id:"setting",className:"nav-div"},"消息设置"))),a.createElement(p.Route,{exact:!0,path:"/message",component:o.MessageResponse}),a.createElement(p.Route,{path:"/message/response/:page?",component:o.MessageResponse}),a.createElement(p.Route,{path:"/message/attme/:page?",component:i.MessageAttme}),a.createElement(p.Route,{path:"/message/system/:page?",component:c.MessageSystem}),a.createElement(p.Route,{path:"/message/message/:page?",component:s.MessageMessage}),a.createElement(p.Route,{path:"/message/setting",component:l.MessageSetting})))))},t}(a.Component);t.Message=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(12),i=n(15),c=["系统默认","冬季","春季（浅色）","春季（深色）"],l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSubmit=function(e){return r.__awaiter(t,void 0,void 0,function(){var t,n,a;return r.__generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,s.formAuthorizeHeader()];case 1:return t=o.sent(),n="/me/theme?id="+e,[4,s.cc98Fetch(n,{headers:t,method:"PUT"})];case 2:if(!(a=o.sent()).ok)throw new Error(a.statusText);return this.props.changeUserInfo(r.__assign({},this.props.userInfo,{theme:e})),s.changeTheme(e),[3,4];case 3:return o.sent(),[3,4];case 4:return[2]}})})},t}return r.__extends(t,e),t.prototype.render=function(){var e=this;return a.createElement("div",{className:"user-theme"},a.createElement("div",{className:"user-theme-info"},a.createElement("h2",null,"切换皮肤"),a.createElement("p",null,"当前皮肤：",c[this.props.userInfo.theme])),a.createElement("div",{className:"user-theme-config"},a.createElement("button",{style:{backgroundColor:"#5198d8"},key:0,onClick:function(){return e.handleSubmit(0)},disabled:0===this.props.userInfo.theme},"系统默认"),a.createElement("button",{style:{backgroundColor:"#79b8ca"},key:1,onClick:function(){return e.handleSubmit(1)},disabled:1===this.props.userInfo.theme},"冬季"),a.createElement("button",{style:{backgroundColor:"#b1d396"},key:2,onClick:function(){return e.handleSubmit(2)},disabled:2===this.props.userInfo.theme},"春季（浅色）"),a.createElement("button",{style:{backgroundColor:"#95b675"},key:3,onClick:function(){return e.handleSubmit(3)},disabled:3===this.props.userInfo.theme},"春季（深色）"),a.createElement("button",{style:{backgroundColor:"#5198d8"},key:4,onClick:function(){return e.handleSubmit(4)},disabled:4===this.props.userInfo.theme},"夏季")))},t}(a.Component);t.default=i.connect(function(e){return{userInfo:e.userInfo.currentUserInfo}},function(e){return{changeUserInfo:function(t){e(o.changeUserInfo(t))}}})(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(15),o=n(12),i=n(30),c=function(e){function t(t){var n=e.call(this,t)||this;return n.state={userNames:"",wealth:"",reason:"",info:""},n.handleSubmit=n.handleSubmit.bind(n),n.handleWealthChange=n.handleWealthChange.bind(n),n}return r.__extends(t,e),t.prototype.handleSubmit=function(e){if(e.preventDefault(),!this.props.isLoading)try{this.props.solveError();var t=Number.parseFloat(this.state.wealth);if(!this.state.userNames)throw new Error("请输入收款人信息");if(this.state.wealth.match(/[^\d\.]/)||t<10)throw new Error("请输入合法的金额");if(!this.state.reason)throw new Error("请输入理由");var n=this.state.userNames.split(/\s+/);if(""===n[n.length-1]&&n.pop(),n=Array.from(new Set(n)),this.props.userInfo.wealth<t*n.length)throw new Error("财富值不足");this.setState({info:"转账中"}),this.props.sendWealthTo(n,t,this.state.reason)}catch(e){this.setState({info:e.message})}},t.prototype.componentWillReceiveProps=function(e){!e.isLoading&&this.props.isLoading&&this.setState({info:"成功给"+e.successNames.join(" ")+"转账了总计"+Number.parseFloat(this.state.wealth)*e.successNames.length+"个财富值"}),e.isError&&!this.props.isError&&this.setState({info:e.errorMessage})},t.prototype.handleWealthChange=function(e,t){var n=Number.parseFloat(e);if(""!==t&&""!==e)if(e.match(/[^\d\.]/))this.setState({wealth:e,info:"请输入数值",userNames:t});else if(n<10)this.setState({wealth:e,info:"请输入大于10的金额",userNames:t});else{var r=t.split(/\s+/);""===r[r.length-1]&&r.pop(),r=Array.from(new Set(r));var a="你总共有"+this.props.userInfo.wealth+"个财富值，";a+="共将扣除"+n*r.length+"个财富值，",r.length>1?a+=r.join("与")+"将各收到":a+=r+"将收到",a+=n-Math.max(Math.floor(.1*n),10)+"个财富值",this.setState({wealth:e,info:a,userNames:t})}else this.setState({userNames:t,wealth:e,info:""})},t.prototype.render=function(){var e=this;return a.createElement("div",{className:"user-center-transfer-wealth"},a.createElement("h2",null,"转账"),a.createElement("form",{onSubmit:this.handleSubmit},a.createElement("div",{className:"transfer-wealth-input"},a.createElement("p",null,"收款人"),a.createElement("input",{style:{width:"30rem"},type:"text",name:"user-names",value:this.state.userNames,onChange:function(t){return e.handleWealthChange(e.state.wealth,t.target.value)}})),a.createElement("div",{className:"transfer-wealth-input"},a.createElement("p",null,"金额"),a.createElement("input",{type:"text",name:"wealth",value:this.state.wealth,onChange:function(t){return e.handleWealthChange(t.target.value,e.state.userNames)}})),a.createElement("div",{className:"transfer-wealth-input"},a.createElement("p",null,"理由"),a.createElement("input",{style:{width:"30rem"},type:"text",name:"reason",value:this.state.reason,onChange:function(t){return e.setState({reason:t.target.value})}})),a.createElement("div",{className:"transfer-wealth-input"},a.createElement("p",null,"说明"),a.createElement("ul",{style:{marginLeft:"2.5rem"}},a.createElement("li",null,"转账需要收取一定的手续费，手续费金额为",a.createElement("strong",null,"10% 或者 10 中的较大值"),"。"),a.createElement("li",null,"转账手续费从转账金额中收取，因此对方实际收到的金额会少于您输入的金额。"),a.createElement("li",null,"转账的最小金额不能小于 ",a.createElement("strong",null,"10")),a.createElement("li",null,"可以对多人转账，请在收款人一栏用空格隔开每个用户。多人转账时每个用户都会收到您指定的金额并单独扣除手续费。您最多可以同时向 ",a.createElement("strong",null,"10")," 个用户进行转账。"))),a.createElement("button",{type:"submit",disabled:this.props.isLoading},"转账")),a.createElement("p",{className:"transfer-wealth-info"},this.state.info))},t}(a.Component);t.default=s.connect(function(e){return{userInfo:e.userInfo.currentUserInfo,isLoading:e.userInfo.isLoading,isError:e.userInfo.isError,errorMessage:e.userInfo.errorMessage,successNames:e.userInfo.transferSuccessUsers}},function(e){return{sendWealthTo:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e(i.sendWealthTo.apply(void 0,t))},solveError:function(){e(o.userCenterSolveError())}}})(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(79),o=n(78),i=n(12),c=n(15),l=n(6),u=n(30),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){if(this.props.match.params.page!==e.match.params.page){var t=parseInt(e.match.params.page)||1;this.props.getInfo(t),window.scroll(0,0)}},t.prototype.componentDidMount=function(){var e=parseInt(this.props.match.params.page)||1;this.props.getInfo(e),this.props.changePage()},t.prototype.render=function(){if(this.props.isLoading)return a.createElement("div",{className:"user-center-loading"},a.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}));if(0===this.props.userRecentPosts.length)return a.createElement("div",{className:"user-posts",style:{textAlign:"center"}},"没有主题");for(var e=parseInt(this.props.match.params.page)||1,t=this.props.hasTotal?this.props.totalPage:e+1,n=this.props.userRecentPosts.slice(10*(e-1),10*e).map(function(e){return a.createElement(s.default,{key:e.id,userRecentPost:e})}),r=1;r<n.length;r+=2)n.splice(r,0,a.createElement("hr",{key:r}));return a.createElement("div",{className:"user-posts"},n,a.createElement(o.default,{currentPage:e,totalPage:t,href:"/usercenter/myfavorites/",hasTotal:this.props.hasTotal}))},t}(a.Component);t.default=c.connect(function(e){return{userRecentPosts:e.userInfo.currentUserFavoritePosts,totalPage:e.userInfo.totalPage.myfavoriteposts,hasTotal:e.userInfo.hasTotal.myfavoriteposts,isLoading:e.userInfo.isLoading}},function(e){return{changePage:function(){e(i.changeUserCenterPage("myfavoriteposts"))},getInfo:function(t){e(u.getFavoritePosts(t))}}})(l.withRouter(d))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(6),i=function(e){function t(t){var n=e.call(this,t)||this;return n.state={buttonInfo:"取消关注",buttonIsDisabled:!1,isFollowing:!0},n.unfollow=n.unfollow.bind(n),n.follow=n.follow.bind(n),n}return r.__extends(t,e),t.prototype.unfollow=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:this.setState({buttonIsDisabled:!0,buttonInfo:"取关中"}),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,s.getToken()];case 2:return e=r.sent(),t=this.props.UserFavoritesBoard.id,n="/me/custom-board/"+t,(a=new Headers).append("Authorization",e),[4,s.cc98Fetch(n,{method:"DELETE",headers:a})];case 3:if(200!==r.sent().status)throw{};return this.setState({buttonIsDisabled:!1,buttonInfo:"重新关注",isFollowing:!1}),[3,5];case 4:return r.sent(),this.setState({buttonIsDisabled:!1,buttonInfo:"取关失败",isFollowing:!0}),[3,5];case 5:return[2]}})})},t.prototype.follow=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:this.setState({buttonIsDisabled:!0,buttonInfo:"关注中"}),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,s.getToken()];case 2:return e=r.sent(),t=this.props.UserFavoritesBoard.id,n="/me/custom-board/"+t,(a=new Headers).append("Authorization",e),[4,s.cc98Fetch(n,{method:"PUT",headers:a})];case 3:if(200!==r.sent().status)throw{};return this.setState({buttonIsDisabled:!1,buttonInfo:"取消关注",isFollowing:!0}),[3,5];case 4:return r.sent(),this.setState({buttonIsDisabled:!1,buttonInfo:"关注失败",isFollowing:!1}),[3,5];case 5:return[2]}})})},t.prototype.render=function(){return a.createElement("div",{className:"user-center-myfavorite-board"},a.createElement(o.Link,{to:"/list/"+this.props.UserFavoritesBoard.id,title:this.props.UserFavoritesBoard.name},a.createElement("img",{src:"/static/images/_"+this.props.UserFavoritesBoard.name+".png"})),a.createElement("div",{className:"user-center-myfavorite-board-info"},a.createElement(o.Link,{to:"/list/"+this.props.UserFavoritesBoard.id,title:this.props.UserFavoritesBoard.name},a.createElement("h2",null,this.props.UserFavoritesBoard.name)),a.createElement("p",null,"版主：",this.props.UserFavoritesBoard.boardMasters.join(" ")," 今日主题 ",this.props.UserFavoritesBoard.todayCount," / 总主题 ",this.props.UserFavoritesBoard.topicCount)),a.createElement("button",{type:"button",className:this.state.isFollowing?"":"user-follow-board",onClick:this.state.isFollowing?this.unfollow:this.follow,disabled:this.state.buttonIsDisabled},this.state.buttonInfo))},t}(a.Component);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(247),o=n(30),i=n(15),c=n(12),l=function(e){function t(t){var n=e.call(this,t)||this;return t.getInfo(),t.changePage(),n}return r.__extends(t,e),t.prototype.render=function(){if(this.props.isLoading)return a.createElement("div",{className:"user-center-loading"},a.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}));if(0===this.props.boards.length)return a.createElement("div",{style:{marginTop:"2rem",textAlign:"center"}},"没有关注");for(var e=this.props.boards.map(function(e){return a.createElement(s.default,{key:e.id,UserFavoritesBoard:e})}),t=1;t<e.length;t+=2)e.splice(t,0,a.createElement("hr",{key:t}));return a.createElement("div",null,e)},t}(a.Component);t.default=i.connect(function(e){return{boards:e.userInfo.currentUserFavoriteBoards,isLoading:e.userInfo.isLoading}},function(e){return{getInfo:function(){e(o.getCurrentUserFavoriteBoards())},changePage:function(){e(c.changeUserCenterPage("myfavoriteboards"))}}})(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(107),o=n(4),i=function(e){function t(t){var n=e.call(this,t)||this;return n.state={displayTitles:[]},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),e="/config/global/all-user-title",[4,o.cc98Fetch(e)];case 1:return[4,n.sent().json()];case 2:return t=n.sent(),this.setState({displayTitles:t}),[3,4];case 3:return n.sent(),[3,4];case 4:return[2]}})})},t.prototype.render=function(){var e=this,t=[],n=0;for(n=100;n--;)t.unshift(n+1920);var r=t.map(function(e){return a.createElement("option",{key:e,value:e},e)});for(r.unshift(a.createElement("option",{key:9999,value:9999},"保密")),r.unshift(a.createElement("option",{key:0,value:0},"未选择")),t=[],n=12;n--;)t.unshift(n+1);var s=t.map(function(e){return a.createElement("option",{key:e,value:e},e)});for(s.unshift(a.createElement("option",{key:0,value:0},"未选择")),t=[],n=31;n--;)t.unshift(n+1);var o=t.map(function(e){return a.createElement("option",{key:e,value:e},e)});return o.unshift(a.createElement("option",{key:0,value:0},"未选择")),a.createElement("div",{className:"user-center-config-others"},a.createElement("h2",null,"其他设置"),a.createElement("div",{className:"config-gender"},a.createElement("p",null,"性别："),a.createElement("select",{id:"genderSelect",name:"Gender",value:this.props.userinfo.Gender,onChange:function(t){e.props.handleChange(t.target.name,Number.parseInt(t.target.value))}},a.createElement("option",{value:1},"男"),a.createElement("option",{value:0},"女"))),a.createElement("div",{className:"config-birthday"},a.createElement("p",null,"生日："),a.createElement("select",{id:"birthdayYear",name:"birthdayYear",value:this.props.userinfo.birthdayYear,onChange:function(t){e.props.handleChange(t.target.name,Number.parseInt(t.target.value))}},r),a.createElement("p",null,"年"),a.createElement("select",{id:"birthdayMonth",name:"birthdayMonth",value:this.props.userinfo.birthdayMonth,disabled:0===this.props.userinfo.birthdayYear,onChange:function(t){e.props.handleChange(t.target.name,Number.parseInt(t.target.value))}},s),a.createElement("p",null,"月"),a.createElement("select",{id:"birthdayDay",name:"birthdayDay",value:this.props.userinfo.birthdayDay,disabled:0===this.props.userinfo.birthdayYear,onChange:function(t){e.props.handleChange(t.target.name,Number.parseInt(t.target.value))}},o),a.createElement("p",null,"日")),this.state.displayTitles.length>0?a.createElement("div",{className:"config-gender"},a.createElement("p",null,"头衔："),a.createElement("select",{style:{width:"auto",padding:"0 1rem"},name:"DisplayTitleId",value:this.props.userinfo.DisplayTitleId,onChange:function(t){e.props.handleChange(t.target.name,Number.parseInt(t.target.value))}},a.createElement("option",{value:0},"不显示"),this.props.userinfo.userTitleIds.map(function(t){var n=e.state.displayTitles.filter(function(e){return e.id===t});if(n.length>0)return a.createElement("option",{key:t,value:t},n[0].name)}))):null,a.createElement("div",{className:"config-text"},a.createElement("p",null,"QQ："),a.createElement("input",{type:"text",name:"QQ",value:this.props.userinfo.QQ,maxLength:20,onChange:function(t){e.props.handleChange(t.target.name,t.target.value)}})),a.createElement("div",{className:"config-text"},a.createElement("p",null,"邮箱："),a.createElement("input",{type:"email",name:"EmailAddress",value:this.props.userinfo.EmailAddress,maxLength:150,onChange:function(t){e.props.handleChange(t.target.name,t.target.value)}})),a.createElement("div",{className:"config-introduction"},a.createElement("p",null,"个人简介："),a.createElement("div",null,a.createElement("textarea",{name:"Introduction",value:this.props.userinfo.Introduction,maxLength:100,onChange:function(t){e.props.handleChange(t.target.name,t.target.value)}}),a.createElement("p",null,"*不超过100字"))))},t}(a.Component);t.default=i;!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r.__extends(t,e)}(s.ChangeUserInfo)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this;return a.createElement("div",null,a.createElement("h2",null,"修改签名档"),a.createElement("div",{className:"user-center-config-signature"},a.createElement("textarea",{id:"signature",onChange:function(t){e.props.onchange("SignatureCode",t.target.value)},value:this.props.signature,spellCheck:!1}),a.createElement("div",null,a.createElement("p",null,"注* 个性签名将在个人主页、发布文章、回复文章中显示，允许使用UBB代码"))))},t}(a.Component);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(15),i=n(30),c=function(e){function t(t){var n=e.call(this,t)||this;s.getLocalStorage("userInfo");return n.state={avatarURL:"",info:"",isShown:!1,divheight:0,divWidth:0,selectorWidth:160,selectorLeft:0,selectorTop:0,avatarNow:t.userInfo.portraitUrl,isLoading:!1,naturalWidth:0,naturalHeight:0,img:null,NUM_MAX:0,scaling:1,choosingDefault:!1,fileType:""},n.handleChange=n.handleChange.bind(n),n.handleIMGLoad=n.handleIMGLoad.bind(n),n.handleSelectorMove=n.handleSelectorMove.bind(n),n.handleResizeMove=n.handleResizeMove.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n.handleCoverMouseMove=n.handleCoverMouseMove.bind(n),n.handleMouseUp=n.handleMouseUp.bind(n),n.setDefaultAvatar=n.setDefaultAvatar.bind(n),n}return r.__extends(t,e),t.prototype.handleChange=function(e){var t=this,n=e.target.files[0];if(!n.type.match("image.*"))return this.setState({info:"请选择图片文件",isShown:!1,divheight:0}),!1;this.setState({fileType:n.type});var r=new FileReader;r.readAsDataURL(n),r.addEventListener("load",function(e){t.setState({isShown:!0,avatarURL:e.target.result})})},t.prototype.handleIMGLoad=function(e,t,n){if(e<160||t<160)this.setState({info:"图片至少为 160*160",isShown:!1,divheight:0});else{for(var r=this.myCanvas.getContext("2d"),a=this.state.scaling;e/a>800;)a*=1.1;this.myCanvas.width=e/a,this.myCanvas.height=t/a,r.drawImage(n,0,0,e,t,0,0,e/a,t/a),this.setState({divheight:t/a+50,divWidth:e/a+50,isShown:!0,info:"请选择要显示的区域",selectorLeft:e/a/4,selectorTop:t/a/4,selectorWidth:Math.min(t/a,e/a)/2,naturalWidth:e/a,naturalHeight:t/a,img:n,NUM_MAX:Math.min(500,e/a,t/a),scaling:a})}},t.prototype.handleMouseUp=function(){this.dragging=null},t.prototype.componentDidMount=function(){this.selector.addEventListener("mousedown",this.handleSelectorMove),this.selector.addEventListener("mousemove",this.handleSelectorMove),this.selector.addEventListener("mouseup",this.handleSelectorMove),this.resize.addEventListener("mousedown",this.handleResizeMove),this.resize.addEventListener("mousemove",this.handleResizeMove),this.resize.addEventListener("mouseup",this.handleResizeMove),this.cover.addEventListener("mousemove",this.handleCoverMouseMove),this.cover.addEventListener("mouseup",this.handleCoverMouseMove),window.addEventListener("mouseup",this.handleMouseUp)},t.prototype.componentWillUnmount=function(){this.selector.removeEventListener("mousedown",this.handleSelectorMove),this.selector.removeEventListener("mousemove",this.handleSelectorMove),this.selector.removeEventListener("mouseup",this.handleSelectorMove),this.resize.removeEventListener("mousedown",this.handleResizeMove),this.resize.removeEventListener("mousemove",this.handleResizeMove),this.resize.removeEventListener("mouseup",this.handleResizeMove),this.cover.removeEventListener("mousemove",this.handleCoverMouseMove),this.cover.removeEventListener("mouseup",this.handleCoverMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)},t.prototype.handleSelectorMove=function(e){var t=this;if(void 0!==this.dragging&&null!==this.dragging&&"resize"===this.dragging.id)this.handleCoverMouseMove(e);else switch(e.type){case"mousedown":this.diffX=e.clientX-e.target.offsetLeft,this.diffY=e.clientY-e.target.offsetTop,this.dragging=e.target;break;case"mousemove":if(null!==this.dragging){var n=e.clientY-this.diffY,r=e.clientX-this.diffX;this.setState(function(e){return n<0&&(n=0),r<0&&(r=0),n>e.naturalHeight-t.state.selectorWidth&&(n=e.naturalHeight-t.state.selectorWidth),r>e.naturalWidth-t.state.selectorWidth&&(r=e.naturalWidth-t.state.selectorWidth),{selectorTop:n,selectorLeft:r}})}break;case"mouseup":this.dragging=null}},t.prototype.handleResizeMove=function(e){var t=this;switch(e.type){case"mousedown":this.diffX=e.clientX-e.target.offsetLeft,this.dragging=e.target;break;case"mousemove":null!==this.dragging&&(this.diffY=e.clientX-e.target.offsetLeft,this.setState(function(e){var n=e.selectorWidth+t.diffY-t.diffX,r=Math.min(e.NUM_MAX,e.naturalWidth-e.selectorLeft,e.naturalHeight-e.selectorTop);return isNaN(n)||(n<100&&(n=100),n>r&&(n=r)),{selectorWidth:isNaN(n)?e.selectorWidth:n}}));break;case"mouseup":this.dragging=null}},t.prototype.handleCoverMouseMove=function(e){var t=this;switch(e.type){case"mouseup":this.dragging=null;break;case"mousemove":if(void 0!==this.dragging&&null!==this.dragging&&"resize"===this.dragging.id)this.diffY=e.clientX-this.dragging.offsetLeft,this.setState(function(e){var n=e.selectorWidth+t.diffY-t.diffX;if(!isNaN(n)){var r=Math.min(e.NUM_MAX,e.naturalWidth-e.selectorLeft,e.naturalHeight-e.selectorTop);n<100&&(n=100),n>r&&(n=r)}return{selectorWidth:isNaN(n)?e.selectorWidth:n}});else if(void 0!==this.dragging&&null!==this.dragging&&"selector"===this.dragging.id){var n=e.clientY-this.diffY,r=e.clientX-this.diffX;this.setState(function(e){return n<0&&(n=0),r<0&&(r=0),n>e.naturalHeight-t.state.selectorWidth&&(n=e.naturalHeight-t.state.selectorWidth),r>e.naturalWidth-t.state.selectorWidth&&(r=e.naturalWidth-t.state.selectorWidth),{selectorTop:n,selectorLeft:r}})}}},t.prototype.handleSubmit=function(){var e=this,t=this.newAvatar,n=t.getContext("2d"),a=this.state.selectorLeft,o=this.state.selectorTop,i=this.state.selectorWidth;t.width=i,t.height=i,n.drawImage(this.state.img,a*this.state.scaling,o*this.state.scaling,i*this.state.scaling,i*this.state.scaling,0,0,i,i),t.toBlob(function(t){return r.__awaiter(e,void 0,void 0,function(){var e,n,a,o,i,c,l,u,d;return r.__generator(this,function(r){switch(r.label){case 0:(e=new Blob([t],{type:this.state.fileType})).lastModifiedDate=Date.now(),e.name="头像."+this.state.fileType.slice(this.state.fileType.indexOf("/")+1,this.state.fileType.length),r.label=1;case 1:return r.trys.push([1,5,,6]),n="/file/portrait",a=new Headers,i=(o=a).append,c=["Authorization"],[4,s.getToken()];case 2:return i.apply(o,c.concat([r.sent()])),(l=new FormData).append("files",e,e.name),l.append("contentType","multipart/form-data"),[4,s.cc98Fetch(n,{method:"POST",headers:a,body:l})];case 3:return[4,(u=r.sent()).json()];case 4:return d=r.sent(),200===u.status&&0!==d.length&&this.changeAvatar(d[0]),[3,6];case 5:return r.sent(),this.setState({info:"修改失败",isLoading:!1,isShown:!1,divheight:0,choosingDefault:!1,avatarURL:""}),[3,6];case 6:return[2]}})})},this.state.fileType,.75)},t.prototype.setDefaultAvatar=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return t=e.target,[4,this.changeAvatar(t.src)];case 1:return n.sent(),[2]}})})},t.prototype.changeAvatar=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),this.setState({isLoading:!0}),[4,s.getToken()];case 1:return t=r.sent(),n="/me/portrait",(a=new Headers).append("Content-Type","application/json"),a.append("Authorization",t),[4,s.cc98Fetch(n,{method:"PUT",headers:a,body:JSON.stringify(e)})];case 2:if(200!==r.sent().status)throw new Error;return this.setState({info:"修改成功",avatarNow:e,isLoading:!1,isShown:!1,divheight:0,choosingDefault:!1,avatarURL:""}),this.props.refreshUserInfo(),[3,4];case 3:return r.sent(),this.setState({info:"修改失败",isLoading:!1,isShown:!1,divheight:0,choosingDefault:!1,avatarURL:""}),[3,4];case 4:return[2]}})})},t.prototype.render=function(){var e=this,t={display:"none"};s.getLocalStorage("userInfo");return a.createElement("div",null,a.createElement("h2",null,"修改头像"),a.createElement("div",{className:"user-center-config-avatar"},a.createElement("img",{src:this.state.avatarNow}),a.createElement("div",null,a.createElement("button",{id:"chooseDefaultAvatar",type:"button",onClick:function(){return e.setState({choosingDefault:!0,info:"暂时只有六枚"})}},"选择论坛头像"),a.createElement("div",null,a.createElement("input",{onChange:function(t){e.handleChange(t),t.target.value=""},id:"uploadAvatar",type:"file",accept:"image/*",style:t}),a.createElement("label",{htmlFor:"uploadAvatar",onClick:function(){return e.setState({choosingDefault:!1})}},a.createElement("p",null,"选择本地图片")),a.createElement("p",{style:{color:"red",margin:"0"}},this.state.info),a.createElement("button",{type:"button",className:"config-submit-button",style:this.state.isShown?{}:t,onClick:this.handleSubmit,disabled:this.state.isLoading},"提交"))),a.createElement("div",{className:"user-center-config-avatar-preview",style:this.state.isShown?{opacity:1,marginTop:"2rem"}:{zIndex:-1}},a.createElement("div",{style:{position:"absolute",width:"824px",overflow:"hidden",paddingBottom:"50px"}},a.createElement("canvas",{id:"newAvatar",style:t,ref:function(t){e.newAvatar=t}}),a.createElement("canvas",{ref:function(t){e.myCanvas=t},style:this.state.isShown?{position:"relative"}:{display:"none"}}),a.createElement("div",{id:"cover",ref:function(t){e.cover=t},style:{width:this.state.divWidth+"px",height:this.state.divheight+"px",top:0}}),a.createElement("div",{className:"imgdata",style:this.state.isShown?{width:this.state.selectorWidth+"px",height:this.state.selectorWidth+"px",borderRadius:this.state.selectorWidth/2+"px",top:this.state.selectorTop+"px",left:this.state.selectorLeft+"px"}:t},a.createElement("img",{src:this.state.avatarURL,style:{position:"relative",top:"-"+this.state.selectorTop+"px",left:"-"+this.state.selectorLeft+"px",width:this.state.naturalWidth+"px",height:this.state.naturalHeight+"px"}})),a.createElement("div",{id:"selector",ref:function(t){e.selector=t},style:this.state.isShown?{width:this.state.selectorWidth+"px",height:this.state.selectorWidth+"px",borderRadius:this.state.selectorWidth/2+"px",top:this.state.selectorTop+"px",left:this.state.selectorLeft+"px"}:t}),a.createElement("span",{id:"resize",ref:function(t){e.resize=t},style:{top:this.state.selectorWidth+this.state.selectorTop+"px",left:this.state.selectorWidth+this.state.selectorLeft+"px"}})),a.createElement("img",{onLoad:function(t){e.handleIMGLoad(t.target.naturalWidth,t.target.naturalHeight,t.target)},style:t,src:this.state.avatarURL})),a.createElement("div",{style:{width:"100%",height:this.state.divheight+"px",transitionDuration:".5s"}}),a.createElement("div",{style:this.state.choosingDefault?{display:"flex",flexDirection:"row",width:"100%",justifyContent:"center",flexWrap:"wrap"}:{display:"none"}},["default_avatar_boy.png","default_avatar_girl.png","default_avatar_boy2.jpg","default_avatar_girl2.jpg","default_avatar_boy3.jpg","default_avatar_girl3.jpg"].map(function(t){return a.createElement("img",{key:t,style:{margin:"3rem 5rem",cursor:"pointer",height:"10rem",width:"10rem"},onClick:e.setDefaultAvatar,src:"/static/images/"+t})}))))},t}(a.Component);t.default=o.connect(function(e){return{userInfo:e.userInfo.currentUserInfo}},function(e){return{refreshUserInfo:function(){e(i.refreshCurrentUserInfo())}}})(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(107),i=n(12),c=n(251),l=n(250),u=n(249),d=n(15),p=n(30),m=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r.__extends(t,e)}(o.ChangeUserInfo),function(e){function t(t){var n=e.call(this,t)||this;t.changePage();var r={EmailAddress:t.userInfo.emailAddress,Gender:t.userInfo.gender,Introduction:t.userInfo.introduction,QQ:t.userInfo.qq,SignatureCode:t.userInfo.signatureCode,Birthday:t.userInfo.birthday,birthdayYear:t.userInfo.birthday?Number.parseInt(t.userInfo.birthday.slice(0,4)):0,birthdayMonth:t.userInfo.birthday?Number.parseInt(t.userInfo.birthday.slice(5,7)):0,birthdayDay:t.userInfo.birthday?Number.parseInt(t.userInfo.birthday.slice(8,10)):0,DisplayTitleId:t.userInfo.displayTitleId||0,userTitleIds:t.userInfo.userTitleIds||[]};return n.state={userInfo:r,info:"",isLoading:!1},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n.handleReset=n.handleReset.bind(n),n}return r.__extends(t,e),t.prototype.handleReset=function(){var e=this.props.userInfo,t={EmailAddress:e.emailAddress,Gender:e.gender,Introduction:e.introduction,QQ:e.qq,SignatureCode:e.signatureCode,Birthday:e.birthday,birthdayYear:e.birthday?Number.parseInt(e.birthday.slice(0,4)):0,birthdayMonth:e.birthday?Number.parseInt(e.birthday.slice(5,7)):0,birthdayDay:e.birthday?Number.parseInt(e.birthday.slice(8,10)):0,DisplayTitleId:e.displayTitleId,userTitleIds:e.userTitleIds};this.setState({userInfo:t})},t.prototype.handleChange=function(e,t){this.setState(function(n){return{userInfo:r.__assign({},n.userInfo,(a={},a[e]=t,a))};var a})},t.prototype.handleSubmit=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i,c,l=this;return r.__generator(this,function(r){switch(r.label){case 0:this.setState({isLoading:!0,info:"修改中"}),r.label=1;case 1:if(r.trys.push([1,4,,5]),(e=this.state.userInfo).Birthday=0!==this.state.userInfo.birthdayYear?this.state.userInfo.birthdayYear+"-"+this.state.userInfo.birthdayMonth+"-"+this.state.userInfo.birthdayDay:"",e.EmailAddress&&!e.EmailAddress.match(/[\S]+@[\S]+\.[\S]+/))throw new Error("请检查邮箱地址");if(e.QQ&&(Number.parseInt(e.QQ)<=0||Number.parseInt(e.QQ).toString()!==e.QQ))throw new Error("请检查QQ是否正确");if(t=new Date(this.state.userInfo.birthdayYear+10,this.state.userInfo.birthdayMonth-1,this.state.userInfo.birthdayDay),0!==this.state.userInfo.birthdayYear&&9999!==this.state.userInfo.birthdayYear&&t.getTime()>Date.now())throw new Error("请检查生日是否正确");return[4,s.getToken()];case 2:return n=r.sent(),a="/me",(o=new Headers).append("Authorization",n),o.append("Content-Type","application/json"),[4,s.cc98Fetch(a,{method:"PUT",headers:o,body:JSON.stringify(e)})];case 3:if(200!==(i=r.sent()).status)throw new Error(i.status.toString());return this.props.refreshUserInfo(),this.setState({info:"修改成功",isLoading:!1}),setTimeout(function(){l.setState({info:""})},1e3),[3,5];case 4:return c=r.sent(),this.setState({info:c.message,isLoading:!1}),[3,5];case 5:return[2]}})})},t.prototype.render=function(){return a.createElement("div",{className:"user-center-config"},a.createElement(c.default,null),a.createElement("hr",null),a.createElement(l.default,{signature:this.state.userInfo.SignatureCode,onchange:this.handleChange}),a.createElement("hr",null),a.createElement(u.default,{userinfo:this.state.userInfo,handleChange:this.handleChange}),a.createElement("hr",null),a.createElement("div",{className:"config-submit"},a.createElement("h2",null,"提交修改"),a.createElement("div",{className:"config-buttons"},a.createElement("button",{className:"config-submit-button",type:"button",disabled:this.state.isLoading,onClick:this.handleSubmit},"提交"),a.createElement("button",{type:"button",onClick:this.handleReset},"重置")),a.createElement("p",{style:{height:""===this.state.info?"0":"1rem",color:"red"}},this.state.info)))},t}(a.Component));t.default=d.connect(function(e){return{userInfo:e.userInfo.currentUserInfo}},function(e){return{refreshUserInfo:function(){e(p.refreshCurrentUserInfo())},changePage:function(){e(i.changeUserCenterPage("config"))}}})(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(79),o=n(78),i=n(15),c=n(6),l=n(30),u=n(12),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){if(this.props.match.params.page!==e.match.params.page){var t=parseInt(e.match.params.page)||1;this.props.getInfo(t),window.scroll(0,0)}},t.prototype.componentDidMount=function(){var e=parseInt(this.props.match.params.page)||1;this.props.getInfo(e),this.props.changePage()},t.prototype.render=function(){if(this.props.isLoading)return a.createElement("div",{className:"user-center-loading"},a.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}));if(0===this.props.userRecentPosts.length)return a.createElement("div",{className:"user-posts",style:{textAlign:"center"}},"没有主题");for(var e=parseInt(this.props.match.params.page)||1,t=this.props.hasTotal?this.props.totalPage:e+1,n=this.props.userRecentPosts.slice(10*(e-1),10*e).map(function(e){return a.createElement(s.default,{key:e.id,userRecentPost:e})}),r=1;r<n.length;r+=2)n.splice(r,0,a.createElement("hr",{key:r}));return a.createElement("div",{className:"user-posts"},n,a.createElement(o.default,{currentPage:e,totalPage:t,href:"/usercenter/myposts/",hasTotal:this.props.hasTotal}))},t}(a.Component);t.default=i.connect(function(e){return{userRecentPosts:e.userInfo.recentPosts,totalPage:e.userInfo.totalPage.myposts,hasTotal:e.userInfo.hasTotal.myposts,isLoading:e.userInfo.isLoading}},function(e){return{getInfo:function(t){e(l.getRecentPosts(t))},changePage:function(){e(u.changeUserCenterPage("myposts"))}}})(c.withRouter(d))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(147),o=n(78),i=n(12),c=n(15),l=n(6),u=n(30),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentWillMount=function(){var e=parseInt(this.props.match.params.page)||1;this.props.changePage(),this.props.getInfo(e)},t.prototype.componentWillReceiveProps=function(e){if(this.props.match.params.page!==e.match.params.page){window.scroll(0,0);var t=parseInt(e.match.params.page)||1;this.props.getInfo(t)}},t.prototype.render=function(){if(this.props.isLoading)return a.createElement("div",{className:"user-center-loading"},a.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}));if(0===this.props.userFans.length)return a.createElement("div",{className:"user-center-myfans",style:{textAlign:"center"}},"没有粉丝");for(var e=parseInt(this.props.match.params.page)||1,t=this.props.userFans.slice(10*(e-1),10*e).map(function(e){return a.createElement(s.default,{key:e.id,userFanInfo:e})}),n=1;n<t.length;n+=2)t.splice(n,0,a.createElement("hr",{key:n}));return a.createElement("div",{className:"user-center-myfans"},a.createElement("div",{className:"user-center-myfans-exact"},t),a.createElement(o.default,{currentPage:e,totalPage:this.props.totalPage,href:"/usercenter/myfans/",hasTotal:!0}))},t}(a.Component);t.default=c.connect(function(e){return{userFans:e.userInfo.currentUserFansInfo,totalPage:e.userInfo.totalPage.myfans,isLoading:e.userInfo.isLoading,hasTotal:e.userInfo.hasTotal.myfans}},function(e){return{changePage:function(){e(i.changeUserCenterPage("myfans"))},getInfo:function(t){e(u.getUserFansInfo(t))}}})(l.withRouter(d))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(147),o=n(78),i=n(12),c=n(15),l=n(6),u=n(30),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentWillMount=function(){var e=parseInt(this.props.match.params.page)||1;this.props.getInfo(e),this.props.changePage()},t.prototype.componentWillReceiveProps=function(e){if(this.props.match.params.page!==e.match.params.page){window.scroll(0,0);var t=parseInt(e.match.params.page)||1;this.props.getInfo(t)}},t.prototype.render=function(){if(this.props.isLoading)return a.createElement("div",{className:"user-center-loading"},a.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}));if(0===this.props.userFollowings.length)return a.createElement("div",{className:"user-center-myfans",style:{textAlign:"center"}},"没有关注");for(var e=parseInt(this.props.match.params.page)||1,t=this.props.userFollowings.slice(10*(e-1),10*e).map(function(e){return a.createElement(s.default,{key:e.id,userFanInfo:e})}),n=1;n<t.length;n+=2)t.splice(n,0,a.createElement("hr",{key:n}));return a.createElement("div",{className:"user-center-myfans"},a.createElement("div",{className:"user-center-myfans-exact"},t),a.createElement(o.default,{currentPage:e,totalPage:this.props.totalPage,href:"/usercenter/myfollowings/",hasTotal:!0}))},t}(a.Component);t.default=c.connect(function(e){return{userFollowings:e.userInfo.currentUserFollowingInfo,totalPage:e.userInfo.totalPage.myfollowings,isLoading:e.userInfo.isLoading,hasTotal:e.userInfo.hasTotal.myfollowings}},function(e){return{changePage:function(){e(i.changeUserCenterPage("myfollowings"))},getInfo:function(t){e(u.getUserFollowingsInfo(t))}}})(l.withRouter(d))},function(e,t,n){"use strict";var r=this;Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(12),o=n(4);t.sendWealth=function(e,t,n){return function(i,c){return a.__awaiter(r,void 0,void 0,function(){var r,l,u,d,p,m,h;return a.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),i(s.userCenterLoading()),i(s.userCenterTransferWealthSuccess([])),[4,o.formAuthorizeHeader()];case 1:return(r=a.sent()).append("Content-Type","application/json"),l="/me/transfer-wealth",u={userNames:e,wealth:t,reason:n},[4,o.cc98Fetch(l,{method:"PUT",headers:r,body:JSON.stringify(u)})];case 2:if(!(d=a.sent()).ok)throw new Error(d.statusText);return[4,d.json()];case 3:return p=a.sent(),(m=c().userInfo.currentUserInfo).wealth-=p.length*t,i(s.changeUserInfo(m)),i(s.userCenterTransferWealthSuccess(p)),[2,i(s.userCenterLoaded())];case 4:return h=a.sent(),i(s.userCenterLoaded()),[2,i(s.userCenterError(h.message))];case 5:return[2]}})})}}},function(e,t,n){"use strict";var r=this;Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(12),o=n(4);t.refreshCurrentUserInfo=function(){return function(e){return a.__awaiter(r,void 0,void 0,function(){var t,n,r,i;return a.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),[4,o.formAuthorizeHeader()];case 1:return t=a.sent(),[4,o.cc98Fetch("/me",{headers:t})];case 2:if(200!==(n=a.sent()).status)throw new Error(n.statusText);return[4,n.json()];case 3:return r=a.sent(),[2,e(s.changeUserInfo(r))];case 4:return i=a.sent(),[2,e(s.userCenterError(i.message))];case 5:return[2]}})})}}},function(e,t,n){"use strict";var r=this;Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(12),o=n(4),i=n(67);t.getUserFollowingsInfo=function(e){return function(t,n){return a.__awaiter(r,void 0,void 0,function(){var r,c,l,u,d,p,m,h,f,g;return a.__generator(this,function(a){switch(a.label){case 0:if(a.trys.push([0,5,,6]),t(s.userCenterLoading()),0===(r=n().userInfo).currentUserInfo.followCount)return[2,t(s.userCenterLoaded())];if(!(c=r.currentUserFollowingInfo.length<10*(e-1)+1))for(l=10*(e-1);l<Math.min(10*e,r.currentUserFollowingInfo.length);l++)if(!r.currentUserFollowingInfo[l]){c=!0;break}return c?(u="/me/followee?from="+10*(e-1)+"&size=10",[4,o.formAuthorizeHeader()]):[2,t(s.userCenterLoaded())];case 1:return d=a.sent(),[4,o.cc98Fetch(u,{headers:d})];case 2:if(200!==(p=a.sent()).status)throw new Error(p.statusText);return[4,p.json()];case 3:return 0===(m=a.sent()).length?(t(s.changeUserFollowingsInfo([])),t(s.usercenterPageLoadFinish(0)),[2,t(s.userCenterLoaded())]):[4,i.getUsersInfo(m)];case 4:return h=a.sent(),f=r.currentUserFollowingInfo,h.forEach(function(t,n){return f[n+10*(e-1)]=t}),t(s.changeUserFollowingsInfo(f)),[2,t(s.userCenterLoaded())];case 5:return g=a.sent(),[2,t(s.userCenterError(g.message))];case 6:return[2]}})})}}},function(e,t,n){"use strict";var r=this;Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(12),o=n(4),i=n(67);t.getUserFansInfo=function(e){return function(t,n){return a.__awaiter(r,void 0,void 0,function(){var r,c,l,u,d,p,m,h,f,g;return a.__generator(this,function(a){switch(a.label){case 0:if(a.trys.push([0,5,,6]),t(s.userCenterLoading()),0===(r=n().userInfo).currentUserInfo.fanCount)return[2,t(s.userCenterLoaded())];if(!(c=r.currentUserFansInfo.length<10*(e-1)+1))for(l=10*(e-1);l<Math.min(10*e,r.currentUserFansInfo.length);l++)if(!r.currentUserFansInfo[l]){c=!0;break}return c?(u="/me/follower?from="+10*(e-1)+"&size=10",[4,o.formAuthorizeHeader()]):[2,t(s.userCenterLoaded())];case 1:return d=a.sent(),[4,o.cc98Fetch(u,{headers:d})];case 2:if(200!==(p=a.sent()).status)throw new Error(p.statusText);return[4,p.json()];case 3:return 0===(m=a.sent()).length?(t(s.changeUserFansInfo([])),t(s.usercenterPageLoadFinish(0)),[2,t(s.userCenterLoaded())]):[4,i.getUsersInfo(m)];case 4:return h=a.sent(),f=r.currentUserFansInfo,h.forEach(function(t,n){return f[n+10*(e-1)]=t}),t(s.changeUserFansInfo(f)),[2,t(s.userCenterLoaded())];case 5:return g=a.sent(),[2,t(s.userCenterError(g.message))];case 6:return[2]}})})}}},function(e,t,n){"use strict";var r=this;Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(12),o=n(4);t.getRecentPosts=function(e){return function(t,n){return a.__awaiter(r,void 0,void 0,function(){var r,i,c,l,u,d,p,m,h,f,g;return a.__generator(this,function(a){switch(a.label){case 0:for(a.trys.push([0,7,,8]),t(s.userCenterLoading()),r=n().userInfo.recentPosts,i=n().userInfo.hasTotal.myposts,c=r.length<10*(e-1)+1&&!i,l=10*(e-1);l<Math.min(r.length,10*e);l++)if(!r[l]){c=!0;break}return c?(u="/me/recent-topic?from="+10*(e-1)+"&size=11",[4,o.formAuthorizeHeader()]):[2,t(s.userCenterLoaded())];case 1:return d=a.sent(),[4,o.cc98Fetch(u,{headers:d})];case 2:if(200!==(p=a.sent()).status)throw new Error(p.statusText);return[4,p.json()];case 3:m=a.sent(),h=11===m.length?10:m.length,11!==m.length&&t(s.usercenterPageLoadFinish(e)),a.label=4;case 4:return h--?(f=m[h],[4,o.getBoardName(m[h].boardId)]):[3,6];case 5:return f.boardName=a.sent(),r[10*(e-1)+h]=m[h],[3,4];case 6:return t(s.changeUserRecentPosts(r)),[2,t(s.userCenterLoaded())];case 7:return g=a.sent(),[2,t(s.userCenterError(g.message))];case 8:return[2]}})})}}},function(e,t,n){"use strict";var r=this;Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(12),o=n(4);t.getFavoritePosts=function(e){return function(t,n){return a.__awaiter(r,void 0,void 0,function(){var r,i,c,l,u,d,p,m,h,f;return a.__generator(this,function(a){switch(a.label){case 0:for(a.trys.push([0,4,,5]),t(s.userCenterLoading()),r=n().userInfo.currentUserFavoritePosts,i=n().userInfo.hasTotal.myfavoriteposts,c=r.length<10*(e-1)+1&&!i,l=10*(e-1);l<Math.min(r.length,10*e);l++)if(!r[l]){c=!0;break}return c?(u="/topic/me/favorite?from="+10*(e-1)+"&size=11",[4,o.formAuthorizeHeader()]):[2,t(s.userCenterLoaded())];case 1:return d=a.sent(),[4,o.cc98Fetch(u,{headers:d})];case 2:if(200!==(p=a.sent()).status)throw new Error(p.statusText);return[4,p.json()];case 3:for(m=a.sent(),h=11===m.length?10:m.length,11!==m.length&&t(s.usercenterPageLoadFinish(e));h--;)r[10*(e-1)+h]=m[h];return t(s.changeUserFavoritePosts(r)),[2,t(s.userCenterLoaded())];case 4:return f=a.sent(),[2,t(s.userCenterError(f.message))];case 5:return[2]}})})}}},function(e,t,n){"use strict";var r=this;Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(12),o=n(4);t.getCurrentUserFavoriteBoards=function(){return function(e,t){return a.__awaiter(r,void 0,void 0,function(){var n,r,i,c,l,u,d,p;return a.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),e(s.userCenterLoading()),n=t().userInfo.currentUserInfo.customBoards,r=t().userInfo.currentUserFavoriteBoards.map(function(e){return e.id}),n.length!==r.length||r.some(function(e,t){return e!==n[t]})?(i=t().userInfo.currentUserInfo.customBoards.join("&id="),c="/board/?id="+i,[4,o.formAuthorizeHeader()]):[2,e(s.userCenterLoaded())];case 1:return l=a.sent(),[4,o.cc98Fetch(c,{headers:l})];case 2:if(200!==(u=a.sent()).status)throw new Error(u.statusText);return[4,u.json()];case 3:return d=a.sent(),e(s.changeUserFavoriteBoards(d)),[2,e(s.userCenterLoaded())];case 4:return p=a.sent(),[2,e(s.userCenterError(p.message))];case 5:return[2]}})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(79),o=n(15),i=n(30),c=n(12),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._page=1,t.scrollHandler=function(e){return r.__awaiter(t,void 0,void 0,function(){return r.__generator(this,function(e){return document.body.scrollHeight-window.pageYOffset<1500&&!1===this.props.isLoading&&this.props.getInfo(this.page),[2]})})},t}return r.__extends(t,e),Object.defineProperty(t.prototype,"page",{get:function(){return this._page++},enumerable:!0,configurable:!0}),t.prototype.componentWillMount=function(){for(var e=!this.props.hasTotal,t=0;t<this.props.userRecentPosts.length;t++)if(!this.props.userRecentPosts[t]){this.props.clearPosts(),e=!0;break}e&&(this.props.getInfo(this.page),window.addEventListener("scroll",this.scrollHandler))},t.prototype.componentWillUnmount=function(){window.removeEventListener("scroll",this.scrollHandler)},t.prototype.componentWillReceiveProps=function(e){e.hasTotal&&window.removeEventListener("scroll",this.scrollHandler)},t.prototype.render=function(){if(0===this.props.userRecentPosts.length&&this.props.hasTotal)return a.createElement("div",{className:"user-posts",style:{marginLeft:"2rem"}},"没有主题");for(var e=this.props.userRecentPosts.map(function(e){return a.createElement(s.default,{key:e.id,userRecentPost:e})}),t=1;t<e.length;t+=2)e.splice(t,0,a.createElement("hr",{key:t}));return a.createElement("div",{className:"user-posts"},e,this.props.isLoading?a.createElement("div",{className:"user-center-loading"},a.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"})):null)},t}(a.Component);t.default=o.connect(function(e){return{userRecentPosts:e.userInfo.recentPosts,hasTotal:e.userInfo.hasTotal.myposts,isLoading:e.userInfo.isLoading}},function(e){return{getInfo:function(t){e(i.getRecentPosts(t))},clearPosts:function(){e(c.changeUserRecentPosts([])),e(c.usercenterPageLoadUnfinish())}}})(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(263),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"user-activities"},a.createElement("p",null,"发表的主题"),a.createElement(s.default,null))},t}(a.Component);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=n(22),i=n(7),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.getPrivilegeColor=function(){switch(this.props.userInfo.privilege){case"注册用户":return"grey";case"超级版主":return"pink";case"全站贵宾":return"blue";case"管理员":return"red"}},t.prototype.render=function(){var e=!1;if(this.props.userInfo.birthday){var t=this.props.userInfo.birthday.match(/\d+-(\d+)-(\d+)/),n=new Date;Number.parseInt(t[1])===n.getMonth()+1&&Number.parseInt(t[2])===n.getDate()&&(e=!0)}return a.createElement("div",{className:"user-profile"},a.createElement("div",{id:"userId"},a.createElement("p",null,this.props.userInfo.name,a.createElement("span",{style:{fontSize:"12px",color:this.getPrivilegeColor(),marginLeft:"2rem"}},this.props.userInfo.privilege)),a.createElement(s.Link,{to:"/message/message"},a.createElement("button",{type:"button"},"私信"))),a.createElement("div",{id:"userIntroducion"},this.props.userInfo.introduction),a.createElement("div",{id:"userGenderAndBirthday"},a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"性别"),1===this.props.userInfo.gender?"男":"女"," "),a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"发帖数"),this.props.userInfo.postCount),a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"财富值"),this.props.userInfo.wealth),a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"粉丝数"),this.props.userInfo.fanCount),a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"威望"),this.props.userInfo.prestige),a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"风评"),this.props.userInfo.popularity),a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"注册时间"),this.props.userInfo.registerTime.replace("T"," ")),a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"最后登录"),this.props.userInfo.lastLogOnTime.replace("T"," ")),null===this.props.userInfo.birthday?null:a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"生日"),this.props.userInfo.birthday.slice(0,this.props.userInfo.birthday.indexOf("T")).replace("9999-",""),e?a.createElement("span",{style:{fontFamily:"FontAwesome",marginLeft:"1rem"},className:"fa-birthday-cake",title:"生日快乐~"}):null),this.props.userInfo.displayTitle?a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"用户组"),this.props.userInfo.displayTitle):null,this.props.userInfo.emailAddress?a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"邮箱"),this.props.userInfo.emailAddress):null,this.props.userInfo.qq?a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"QQ"),this.props.userInfo.qq):null,a.createElement("p",null,a.createElement("span",{className:"user-profile-info"},"被删帖数"),-this.props.userInfo.deleteCount)),this.props.userInfo.signatureCode?a.createElement("div",{className:"user-description"},a.createElement("p",null,"个性签名"),a.createElement(o.UbbContainer,{code:this.props.userInfo.signatureCode,options:r.__assign({},new i.UbbCodeOptions,{allowExternalImage:!1})})):null)},t}(a.Component);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(265),o=n(264),i=n(148),c=n(30),l=n(12),u=n(15),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.changePage(),this.props.refreshCurrentUserInfo()},t.prototype.render=function(){return a.createElement("div",{className:"user-center-exact"},a.createElement(i.default,{userInfo:this.props.userInfo}),a.createElement(s.default,{userInfo:this.props.userInfo}),a.createElement(o.default,null))},t}(a.Component);t.default=u.connect(function(e){return{userInfo:e.userInfo.currentUserInfo}},function(e){return{refreshCurrentUserInfo:function(){e(c.refreshCurrentUserInfo())},changePage:function(){e(l.changeUserCenterPage("profile"))}}})(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=n(266),i=n(255),c=n(254),l=n(253),u=n(252),d=n(248),p=n(246),m=n(245),h=n(244),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"user-center-router"},a.createElement(s.Route,{exact:!0,path:"/usercenter/",component:o.default}),a.createElement(s.Route,{path:"/usercenter/myfollowings/:page?",component:i.default}),a.createElement(s.Route,{path:"/usercenter/myfans/:page?",component:c.default}),a.createElement(s.Route,{path:"/usercenter/myposts/:page?",component:l.default}),a.createElement(s.Route,{path:"/usercenter/myfavorites/:page?",component:p.default}),a.createElement(s.Route,{path:"/usercenter/config",component:u.default}),a.createElement(s.Route,{path:"/usercenter/mycustomboards",component:d.default}),a.createElement(s.Route,{path:"/usercenter/transferwealth",component:m.default}),a.createElement(s.Route,{path:"/usercenter/theme",component:h.default}))},t}(a.Component);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=n(34),i=function(e){function t(t){var n=e.call(this,t)||this;return n.state={buttonClassName:""},n.handleScroll=n.handleScroll.bind(n),n}return r.__extends(t,e),t.prototype.handleScroll=function(e){window.pageYOffset>234&&this.setState({buttonClassName:"btn-show"}),window.pageYOffset<234&&this.setState(function(e){return{buttonClassName:""===e.buttonClassName?"":"btn-disappare"}})},t.prototype.componentDidMount=function(){document.addEventListener("scroll",this.handleScroll)},t.prototype.componentWillUnmount=function(){document.removeEventListener("scroll",this.handleScroll)},t.prototype.scrollToTop=function(){o("body,html").animate({scrollTop:0},500)},t.prototype.render=function(){return a.createElement("div",{className:"user-center-navigation",id:"userCenterNavigation"},a.createElement("ul",null,a.createElement("li",null,a.createElement(s.NavLink,{to:"/usercenter",exact:!0,activeClassName:"user-center-navigation-active",className:"fa-home"},a.createElement("p",null,"个人主页"))),a.createElement("hr",null),a.createElement("li",null,a.createElement(s.NavLink,{to:"/usercenter/config",activeClassName:"user-center-navigation-active",className:"fa-cog"},a.createElement("p",null,"修改资料"))),a.createElement("hr",null),a.createElement("li",null,a.createElement(s.NavLink,{to:"/usercenter/myposts",activeClassName:"user-center-navigation-active",className:"fa-pencil-square-o"},a.createElement("p",null,"我的主题"))),a.createElement("hr",null),a.createElement("li",null,a.createElement(s.NavLink,{to:"/usercenter/myfavorites",activeClassName:"user-center-navigation-active",className:"fa-star"},a.createElement("p",null,"我的收藏"))),a.createElement("hr",null),a.createElement("li",null,a.createElement(s.NavLink,{to:"/usercenter/mycustomboards",activeClassName:"user-center-navigation-active",className:"fa-rss"},a.createElement("p",null,"关注版面"))),a.createElement("hr",null),a.createElement("li",null,a.createElement(s.NavLink,{to:"/usercenter/myfollowings",activeClassName:"user-center-navigation-active",className:"fa-heart"},a.createElement("p",null,"关注用户"))),a.createElement("hr",null),a.createElement("li",null,a.createElement(s.NavLink,{to:"/usercenter/myfans",activeClassName:"user-center-navigation-active",className:"fa-users"},a.createElement("p",null,"我的粉丝"))),a.createElement("hr",null),a.createElement("li",null,a.createElement(s.NavLink,{to:"/usercenter/transferwealth",activeClassName:"user-center-navigation-active",className:"fa-credit-card"},a.createElement("p",null,"转账系统"))),a.createElement("hr",null),a.createElement("li",null,a.createElement(s.NavLink,{to:"/usercenter/theme",activeClassName:"user-center-navigation-active",className:"fa-magic"},a.createElement("p",null,"切换皮肤")))),a.createElement("button",{type:"button",id:"scrollToTop",className:this.state.buttonClassName,onClick:this.scrollToTop},"回到顶部"))},t}(a.Component);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(15),o=n(268),i=n(267),c=n(71),l=n(16),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return this.props.isLogOn?a.createElement("div",{className:"user-center"},a.createElement(l.default,{title:"个人中心 - CC98论坛"}),a.createElement("div",{className:"user-center-content"},a.createElement("div",{className:"user-center-head"},a.createElement("p",null,"个人中心")),a.createElement("div",{className:"user-center-body"},a.createElement(o.default,null),a.createElement(i.default,null)))):a.createElement(c.LogOut,null)},t}(a.Component);t.default=s.connect(function(e){return{isLogOn:e.userInfo.isLogOn}},null)(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(6),i=n(16),c=function(){return function(e,t,n,r){this.name=e,this.id=t,this.masters=n,this.boards=r}}();t.RootBoardState=c;var l=function(){return function(e,t,n,r,a,s){this.name=e,this.id=t,this.masters=n,this.todayCount=r,this.topicCount=a,this.postCount=s}}();t.ChildBoardState=l;var u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={data:new Array},n}return r.__extends(t,e),t.prototype.getData=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,s.cc98Fetch("/Board/all")];case 1:return[4,e.sent().json()];case 2:return[2,e.sent()]}})})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,this.getData()];case 1:return e=t.sent(),this.setState({data:e}),[2]}})})},t.prototype.scroll=function(e){document.getElementById(e).scrollIntoView()},t.prototype.generateRootBoard=function(e){return a.createElement(d,{data:e})},t.prototype.generateBoardGuide=function(e){var t=this,n=""+e.name;return a.createElement("div",{onClick:function(){return t.scroll(n)},className:"row boardOption"},e.name)},t.prototype.render=function(){return a.createElement("div",{className:"row",style:{width:"1140px"}},a.createElement(i.default,{title:"版面列表 - CC98论坛"}),a.createElement("div",{className:"boardList"},this.state.data.map(this.generateRootBoard)),a.createElement("div",{className:"boardGuide"},this.state.data.map(this.generateBoardGuide.bind(this))))},t}(a.Component);t.BoardList=u;var d=function(e){function t(t){var n=e.call(this,t)||this,r=n.props.data;return 2===r.id||29===r.id||35===r.id||37===r.id?n.state={isExpanded:!1}:n.state={isExpanded:!0},n.toggleIsExpanded=n.toggleIsExpanded.bind(n),n}return r.__extends(t,e),t.prototype.toggleIsExpanded=function(){this.setState(function(e){return{isExpanded:!e.isExpanded}})},t.prototype.convertMasters=function(e,t,n){var r=n.length,s="/user/name/"+encodeURIComponent(e);return t===r-1?a.createElement(o.Link,{to:s},e):a.createElement("div",{style:{marginRight:"1rem"}},a.createElement(o.Link,{to:s},e))},t.prototype.render=function(){var e=this.state.isExpanded?"flex":"none",t=this.state.isExpanded?"收起":"展开",n=this.props.data,r=(n.id,n.masters,n.masters.length?"主管：":"");return a.createElement("div",{className:"anArea",id:n.name},a.createElement("div",{className:"column",style:{border:"2px solid #e9e9e9"}},a.createElement("div",{className:"row boardListHead",onClick:this.toggleIsExpanded},a.createElement("div",{className:"row",style:{marginRight:"1rem",alignItems:"center"}},a.createElement("div",{className:"areaName"},n.name),a.createElement("div",{className:"areaName"},r,n.masters.map(this.convertMasters))),a.createElement("div",{className:"expendBoardList"}," ",t)),a.createElement("div",{className:"hiddenContent",style:{display:e}},a.createElement(p,{id:n.id,boards:n.boards}))))},t}(a.Component);t.RootBoard=d;var p=function(e){function t(t){var n=e.call(this,t)||this;return n.state={thisBoardState:[]},n}return r.__extends(t,e),t.prototype.onError=function(e){e.preventDefault(),e.target.src="/static/images/_CC98.png"},t.prototype.convertChildBoard=function(e){var t="/static/images/_"+e.name+".png";return a.createElement("div",{className:"boardContent"},a.createElement(o.Link,{to:"/list/"+e.id},a.createElement("div",{className:"greenBackdrop"},a.createElement("img",{style:{width:"6rem",height:"6rem"},src:t,onError:this.onError}))),a.createElement("div",{className:"column boardBlock"},a.createElement(o.Link,{to:"/list/"+e.id},a.createElement("div",{className:"boardName2",style:{fontSize:"1.2rem",fontWeight:"bold"}},e.name)),a.createElement("div",{className:"boardInfo"},a.createElement("div",{className:"row"},"今日  ",e.todayCount," "),a.createElement("div",{className:"row"},"总数  ",e.postCount))))},t.prototype.convertNoImgChildBoard=function(e){return a.createElement("div",{className:"noImgBoardContent"},a.createElement(o.Link,{to:"/list/"+e.id},a.createElement("div",{className:"boardName2"},e.name)))},t.prototype.render=function(){var e=[],t=0;return this.props.boards&&this.props.id&&(e=this.props.boards,t=this.props.id),2===t||29===t||35===t||37===t||33===t||604===t?a.createElement("div",{className:"areaContent"},e.map(this.convertNoImgChildBoard)):a.createElement("div",{className:"areaContent"},e.map(this.convertChildBoard.bind(this)))},t}(a.Component);t.ChildBoard=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(59),i=n(80),c=n(152),l=n(150),u=n(149),d=n(151),p=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.quote=r.quote.bind(r),r.shouldRender=r.shouldRender.bind(r),r.handleChange=r.handleChange.bind(r),r.state={page:1,topicId:r.match.params.topicId,totalPage:1,postId:r.match.params.postId,topicInfo:{replyCount:0},boardInfo:{masters:[],id:7},content:"",shouldRender:!1,isFav:!1},r}return r.__extends(t,e),t.prototype.quote=function(e){this.setState({content:e})},t.prototype.handleChange=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return[4,s.getPostInfo(this.match.params.postId)];case 1:return e=r.sent(),[4,s.getTopicInfo(this.match.params.topicId)];case 2:return t=r.sent(),n=this.match.params.page?parseInt(this.match.params.page):1,[4,this.getTotalPage(this.state.topicInfo.replyCount,e)];case 3:return a=r.sent(),this.setState({page:n,topicId:this.match.params.topicId,totalPage:a,topicInfo:t}),[2]}})})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,o,i,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return t=e.match.params.page?parseInt(e.match.params.page):1,e.match.params.userId,[4,s.getPostInfo(this.match.params.postId)];case 1:return n=r.sent(),[4,s.getTopicInfo(this.match.params.topicId)];case 2:return a=r.sent(),o=a.boardId,[4,s.getBoardInfo(o)];case 3:return i=r.sent(),[4,s.getFavState(e.match.params.topicId)];case 4:return c=r.sent(),[4,this.getTotalPage.bind(this)(this.match.params.topicId,n)];case 5:return l=r.sent(),this.setState({page:t,topicId:e.match.params.topicId,totalPage:l,postId:e.match.params.postId,topicInfo:a,boardInfo:i,isFav:c}),[2]}})})},t.prototype.shouldRender=function(e){e?this.setState({shouldRender:!0}):this.setState({shouldRender:!1})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i;return r.__generator(this,function(r){switch(r.label){case 0:return[4,s.getPostInfo(this.match.params.postId)];case 1:return e=r.sent(),t=this.match.params.page?parseInt(this.match.params.page):1,[4,s.getTopicInfo(this.match.params.topicId)];case 2:return n=r.sent(),a=n.boardId,[4,s.getBoardInfo(a)];case 3:return o=r.sent(),[4,this.getTotalPage.bind(this)(this.match.params.topicId,e)];case 4:return i=r.sent(),this.setState({page:t,topicId:this.match.params.topicId,totalPage:i,topicInfo:n,boardInfo:o}),[2]}})})},t.prototype.getTotalPage=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,s.getTopicInfo(e)];case 1:return n=r.sent(),n.isAnonymous?[4,s.getAnonymousTraceTopicsCount(e,t.id)]:[3,3];case 2:return[2,r.sent()];case 3:return[4,s.getCurUserTotalReplyPage(e,t.userId)];case 4:return[2,r.sent()]}})})},t.prototype.render=function(){var e="/topic/"+this.match.params.topicId+"/postId/"+this.match.params.postId+"/";this.state.topicId;return a.createElement("div",{className:"center",style:{width:"1140px"}},a.createElement("div",{className:"row",style:{width:"100%",justifyContent:"space-between",alignItems:"center"}},a.createElement(d.Category,{topicInfo:this.state.topicInfo,boardInfo:this.state.boardInfo,topicId:this.match.params.topicId}),a.createElement(o.Pager,{page:this.state.page,url:e,totalPage:this.state.totalPage})),a.createElement(u.TopicInfo,{topicInfo:this.state.topicInfo,tag1:this.state.topicInfo.tag1,tag2:this.state.topicInfo.tag2,boardInfo:this.state.boardInfo,isFav:this.state.isFav}),a.createElement(l.Reply,{topicInfo:this.state.topicInfo,boardInfo:this.state.boardInfo,page:this.state.page,postId:this.state.postId,quote:this.quote,isTrace:!0,isHot:!1,topicId:this.match.params.topicId}),a.createElement("div",{className:"row",style:{width:"100%",justifyContent:"space-between",alignItems:"center",marginTop:"1rem"}},a.createElement(d.Category,{topicInfo:this.state.topicInfo,boardInfo:this.state.boardInfo,topicId:this.match.params.topicId}),a.createElement(o.Pager,{page:this.state.page,url:e,totalPage:this.state.totalPage})),a.createElement(c.SendTopic,{onChange:this.handleChange,boardInfo:this.state.boardInfo,content:this.state.content,topicInfo:this.state.topicInfo}))},t}(i.RouteComponent);t.CurUserPost=p;var m=function(){return function(){}}();t.ContentState=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(22),i=n(6),c=n(72),l=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.showManageUI=r.showManageUI.bind(r),r.showJudgeUI=r.showJudgeUI.bind(r),r.quote=r.quote.bind(r),r.edit=r.edit.bind(r),r.state={likeNumber:r.props.likeInfo.likeCount,dislikeNumber:r.props.likeInfo.dislikeCount,likeState:r.props.likeInfo.likeState},r}return r.__extends(t,e),t.prototype.quote=function(){this.props.quote(this.props.postInfo.content,this.props.userInfo.name,this.props.postInfo.time,this.props.postInfo.floor,this.props.postInfo.id)},t.prototype.showManageUI=function(){var e="#manage"+this.props.postInfo.id;$(e).css("display","")},t.prototype.showJudgeUI=function(){var e="#judge"+this.props.postInfo.id;$(e).css("display","")},t.prototype.edit=function(){},t.prototype.isAllowedtoEdit=function(e){return!!s.getLocalStorage("userInfo")&&("管理员"===s.getLocalStorage("userInfo").privilege||"管理员"!==e&&(!!s.isMaster(this.props.boardInfo.boardMasters)||void 0))},t.prototype.like=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n;return r.__generator(this,function(r){switch(r.label){case 0:return e="#like"+this.props.postInfo.id,t="#dislike"+this.props.postInfo.id,1!==this.state.likeState?[3,2]:[4,s.like(this.props.topicInfo.id,this.props.postInfo.id,this.context.router)];case 1:return r.sent(),$(e).css("color","#8dc9db"),[3,7];case 2:return 2!==this.state.likeState?[3,5]:[4,s.dislike(this.props.topicInfo.id,this.props.postInfo.id,this.context.router)];case 3:return r.sent(),[4,s.like(this.props.topicInfo.id,this.props.postInfo.id,this.context.router)];case 4:return r.sent(),$(e).css("color","red"),$(t).css("color","#8dc9db"),[3,7];case 5:return[4,s.like(this.props.topicInfo.id,this.props.postInfo.id,this.context.router)];case 6:r.sent(),$(e).css("color","red"),r.label=7;case 7:return[4,s.refreshLikeState(this.props.topicInfo.id,this.props.postInfo.id)];case 8:return n=r.sent(),this.setState({likeNumber:n.likeCount,dislikeNumber:n.dislikeCount,likeState:n.likeState}),[2]}})})},t.prototype.dislike=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n;return r.__generator(this,function(r){switch(r.label){case 0:return e="#like"+this.props.postInfo.id,t="#dislike"+this.props.postInfo.id,2!==this.state.likeState?[3,2]:[4,s.dislike(this.props.topicInfo.id,this.props.postInfo.id,this.context.router)];case 1:return r.sent(),$(t).css("color","#8dc9db"),[3,7];case 2:return 1!==this.state.likeState?[3,5]:[4,s.like(this.props.topicInfo.id,this.props.postInfo.id,this.context.router)];case 3:return r.sent(),[4,s.dislike(this.props.topicInfo.id,this.props.postInfo.id,this.context.router)];case 4:return r.sent(),$(e).css("color","#8dc9db"),$(t).css("color","red"),[3,7];case 5:return[4,s.dislike(this.props.topicInfo.id,this.props.postInfo.id,this.context.router)];case 6:r.sent(),$(t).css("color","red"),r.label=7;case 7:return[4,s.refreshLikeState(this.props.topicInfo.id,this.props.postInfo.id)];case 8:return n=r.sent(),this.setState({likeNumber:n.likeCount,dislikeNumber:n.dislikeCount,likeState:n.likeState}),[2]}})})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n;return r.__generator(this,function(r){return e="#like"+this.props.postInfo.id,t="#dislike"+this.props.postInfo.id,1===this.state.likeState?$(e).css("color","red"):2===this.state.likeState&&$(t).css("color","red"),"icon"+this.props.postInfo.id,n="#icon"+this.props.postInfo.id,(s.isMaster(this.props.boardInfo.boardMasters)||144==this.props.boardInfo.id&&this.props.postInfo.isLZ)&&$(n).css("display",""),[2]})})},t.prototype.render=function(){var e="icon"+this.props.postInfo.id,t="like"+this.props.postInfo.id,n="dislike"+this.props.postInfo.id,l=a.createElement("div",{className:"signature"},a.createElement(o.UbbContainer,{code:this.props.userInfo.signatureCode,options:r.__assign({},new c.UbbCodeOptions,{allowExternalImage:!1})}));this.props.userInfo.signatureCode||(l=null);var u=null,d="/editor/edit/"+this.props.postInfo.id;s.getLocalStorage("userInfo")&&(this.isAllowedtoEdit(this.props.userInfo.privilege)||this.props.userInfo.name===s.getLocalStorage("userInfo").name||182===this.props.boardInfo.id)&&(u=a.createElement(i.Link,{to:d},a.createElement("div",{className:"operation1",onClick:this.edit},"   编辑")));var p=null;if(this.props.postInfo.lastUpdateAuthor&&this.props.postInfo.lastUpdateTime){var m=moment(this.props.postInfo.lastUpdateTime).format("YYYY-MM-DD HH:mm:ss");p="该帖最后由 "+(this.props.userInfo.name===this.props.postInfo.lastUpdateAuthor?"作者":this.props.postInfo.lastUpdateAuthor)+" 在 "+m+" 编辑"}var h="/topic/"+this.props.topicInfo.id,f="/topic/"+this.props.topicInfo.id+"/postid/"+this.props.postInfo.id,g=a.createElement("div",{className:"operation1"},a.createElement(i.Link,{to:this.props.traceMode?h:f},this.props.traceMode?"返回":"追踪")),v=null;(1==s.isMaster(this.props.boardInfo.boardMasters)||144===this.props.boardInfo.id&&s.getLocalStorage("userInfo").name===this.props.topicInfo.userName)&&(v=a.createElement("div",{className:"operation1",id:e,style:{cursor:"pointer"},onClick:this.showManageUI},"管理"));var y=a.createElement("div",{className:"operation1",onClick:this.showJudgeUI},"   评分");return a.createElement("div",{className:"column",style:{marginTop:"1rem",width:"52rem",marginBottom:"0.5rem"}},a.createElement("div",{className:"comment1"},a.createElement("div",{style:{width:"40rem",marginLeft:"1.2rem",fontSize:"0.8rem"}},a.createElement("span",null,"发表于 ",moment(this.props.postInfo.time).format("YYYY-MM-DD HH:mm:ss")),a.createElement("span",{style:{marginLeft:"1rem"}},p)),a.createElement("div",{className:"row",style:{alignItems:"center"}},a.createElement("div",{id:t,className:"upup",style:{marginRight:"0.7rem"},onClick:this.like.bind(this)},a.createElement("i",{title:"赞",className:"fa fa-thumbs-o-up fa-lg"}),a.createElement("span",{className:"commentProp"}," ",this.state.likeNumber)),a.createElement("div",{id:n,className:"downdown",onClick:this.dislike.bind(this)},a.createElement("i",{title:"踩",className:"fa fa-thumbs-o-down fa-lg"}),a.createElement("span",{className:"commentProp"}," ",this.state.dislikeNumber)),a.createElement("div",{id:"commentlike"},y,a.createElement("div",{className:"operation1",onClick:this.quote},"   引用"),g,u,v))),a.createElement("div",{className:"row",style:{width:"100%",justifyContent:"center"}},"  ",l))},t}(a.Component);t.ReplierSignature=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(34),i=function(e){function t(t){var n=e.call(this,t)||this;return n.showMinus1UI=n.showMinus1UI.bind(n),n.showPlus1UI=n.showPlus1UI.bind(n),n.reasonInput=n.reasonInput.bind(n),n.confirm=n.confirm.bind(n),n.close=n.close.bind(n),n.state={reason:"",tips:"",UI:"plus1"},n}return r.__extends(t,e),t.prototype.confirm=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:if(e="ok","plus1"!==o("input[name='option']:checked").val()&&"minus1"!==o("input[name='option']:checked").val())return[3,16];switch(this.state.UI){case"plus1":return[3,1];case"minus1":return[3,8]}return[3,15];case 1:return o("input[name='reason']:checked").val()?(t="#judge"+this.props.postId,"自定义"===o("input[name='reason']:checked").val()?[3,3]:[4,s.plus1(this.props.topicId,this.props.postId,o("input[name='reason']:checked").val())]):[3,6];case 2:return e=n.sent(),[3,5];case 3:return[4,s.plus1(this.props.topicId,this.props.postId,this.state.reason)];case 4:e=n.sent(),n.label=5;case 5:return"ok"===e?(o(t).css("display","none"),this.props.update()):"already"===e?this.setState({tips:"您今天已经评分过啦~"}):"not allowed"===e?this.setState({tips:"您还没有资格评分哦~"}):"rateself"===e&&this.setState({tips:"您不能给自己评分哦~"}),[3,7];case 6:this.setState({tips:"请输入原因！"}),n.label=7;case 7:return[3,15];case 8:return o("input[name='reason']:checked").val()?(t="#judge"+this.props.postId,"自定义"===o("input[name='reason']:checked").val()?[3,10]:[4,s.minus1(this.props.topicId,this.props.postId,o("input[name='reason']:checked").val())]):[3,13];case 9:return e=n.sent(),[3,12];case 10:return[4,s.minus1(this.props.topicId,this.props.postId,this.state.reason)];case 11:e=n.sent(),n.label=12;case 12:return"ok"===e?(o(t).css("display","none"),this.props.update()):"already"===e?this.setState({tips:"您今天已经评分过啦~"}):"not allowed"===e?this.setState({tips:"您还没有资格评分哦~"}):"rateself"===e&&this.setState({tips:"您不能给自己评分哦~"}),[3,14];case 13:this.setState({tips:"请输入原因！"}),n.label=14;case 14:return[3,15];case 15:return[3,17];case 16:this.setState({tips:"请选择+1或-1"}),n.label=17;case 17:return[2]}})})},t.prototype.reasonInput=function(e){this.setState({reason:e.target.value})},t.prototype.close=function(){var e="#judge"+this.props.postId;o(e).css("display","none")},t.prototype.showPlus1UI=function(){this.setState({UI:"plus1"})},t.prototype.showMinus1UI=function(){this.setState({UI:"minus1"})},t.prototype.render=function(){var e,t=a.createElement("div",{className:"column",id:"award"},a.createElement("div",{className:"column manageOperation"},a.createElement("div",{className:"manageObject"},a.createElement("div",{className:"judgeName"},"原因")),a.createElement("div",{className:"row",style:{justifyContent:"space-between",marginTop:"2rem",marginLeft:"3rem",marginRight:"3rem",color:"#fff"}},a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"reason",value:"所言极是"}),a.createElement("div",null,"所言极是")),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"reason",value:"momo"}),a.createElement("div",null,"momo")),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"reason",value:"好人一生平安"}),a.createElement("div",null,"好人一生平安"))),a.createElement("div",{className:"row",style:{marginTop:"1rem",justifyContent:"flex-start",marginLeft:"3rem",marginRight:"3rem",color:"#fff"}},a.createElement("div",{className:"judgeOption",style:{marginRight:"2rem"}},a.createElement("input",{type:"radio",name:"reason",value:"自定义"}),a.createElement("div",null,"自定义")),a.createElement("input",{type:"text",style:{borderRadius:"1rem",backgroundColor:"#8bc9db",border:"solid 1.6px #ffffff",color:"white",paddingLeft:"0.5rem"},value:this.state.reason,onChange:this.reasonInput})),a.createElement("div",{style:{color:"#fff",fontSize:"0.75rem",textAlign:"center",marginTop:"0.1rem"}},this.state.tips))),n=a.createElement("div",{className:"column",id:"award"},a.createElement("div",{className:"column manageOperation"},a.createElement("div",{className:"manageObject"},a.createElement("div",{className:"judgeName"},"原因")),a.createElement("div",{className:"row",style:{marginTop:"2rem",marginLeft:"2rem",marginRight:"2rem",justifyContent:"space-between",color:"#fff"}},a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"reason",value:"太不求是"}),a.createElement("div",null,"太不求是")),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"reason",value:"呵呵"}),a.createElement("div",null,"呵呵")),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"reason",value:"被你暴击"}),a.createElement("div",null,"被你暴击"))),a.createElement("div",{className:"row",style:{marginTop:"1rem",justifyContent:"flex-start",marginLeft:"2rem"}},a.createElement("div",{className:"judgeOption",style:{marginRight:"2rem"}},a.createElement("input",{type:"radio",name:"reason",value:"自定义"}),a.createElement("div",null,"自定义")),a.createElement("input",{type:"text",style:{borderRadius:"1rem",backgroundColor:"#8bc9db",border:"solid 1.6px #ffffff",color:"white",paddingLeft:"0.5rem"},value:this.state.reason,onChange:this.reasonInput})),a.createElement("div",{style:{color:"#fff",fontSize:"0.75rem",textAlign:"center",marginTop:"0.1rem"}},this.state.tips)));e="minus1"===this.state.UI?n:t;var r="judge"+this.props.postId;return a.createElement("div",{style:{display:"none"},id:r,className:"judgeManagement"},a.createElement("div",{className:"judgeUI column"},a.createElement("div",{className:"row judgeName"},"评分"),a.createElement("div",{className:"row",style:{fontSize:"0.75rem",color:"#fff"}},"500贴以上的用户可以进行评分（每日一次）"),a.createElement("div",{className:"row judgeOptions",style:{marginTop:"2rem",paddingLeft:"3rem",paddingRight:"3rem",justifyContent:"space-between",boxSizing:"border-box",color:"#fff"}},a.createElement("div",{className:"judgeOption"},a.createElement("input",{type:"radio",name:"option",value:"plus1",onClick:this.showPlus1UI}),a.createElement("div",null,"风评+1")),a.createElement("div",{className:"judgeOption"},a.createElement("input",{type:"radio",name:"option",value:"minus1",onClick:this.showMinus1UI}),a.createElement("div",null,"风评-1")))),e,a.createElement("div",{className:"row",style:{justifyContent:"space-around",padding:"0 3rem"}},a.createElement("button",{style:{border:"none",backgroundColor:"#8bc9db",color:"white",textDecoration:"underline",fontSize:"1.25rem"},onClick:this.confirm,className:"confirmManagement"},"确认"),a.createElement("button",{onClick:this.close,style:{border:"none",backgroundColor:"#8bc9db",color:"white",textDecoration:"underline",fontSize:"1.25rem"},className:"confirmManagement"},"关闭")))},t}(a.Component);t.Judge=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(34),i=function(e){function t(t){var n=e.call(this,t)||this;return n.wealthInput=n.wealthInput.bind(n),n.prestigeInput=n.prestigeInput.bind(n),n.reasonInput=n.reasonInput.bind(n),n.tpdaysInput=n.tpdaysInput.bind(n),n.confirm=n.confirm.bind(n),n.showAwardUI=n.showAwardUI.bind(n),n.showPunishUI=n.showPunishUI.bind(n),n.showDeleteUI=n.showDeleteUI.bind(n),n.showOtherUI=n.showOtherUI.bind(n),n.close=n.close.bind(n),n.state={wealth:1e3,prestige:0,reason:"",tpdays:0,UI:"Award",tips:"",fetchState:"ok"},n}return r.__extends(t,e),t.prototype.showAwardUI=function(){this.setState({UI:"Award",wealth:1e3})},t.prototype.showPunishUI=function(){this.setState({UI:"Punish",wealth:0})},t.prototype.showDeleteUI=function(){this.setState({UI:"Delete"})},t.prototype.showOtherUI=function(){this.setState({UI:"Other"})},t.prototype.confirm=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,i,c,l;return r.__generator(this,function(r){switch(r.label){case 0:switch(e="ok",t="ok",n="ok",this.state.UI){case"Award":return[3,1];case"Punish":return[3,13];case"Delete":return[3,31];case"Other":return[3,35]}return[3,37];case 1:return o("input[name='reason']:checked").val()?"自定义"===o("input[name='reason']:checked").val()?[3,6]:0===this.state.wealth?[3,3]:[4,s.awardWealth(o("input[name='reason']:checked").val(),this.state.wealth,this.props.postId)]:[3,11];case 2:e=r.sent(),r.label=3;case 3:return 0===this.state.prestige?[3,5]:[4,s.addPrestige(this.props.postId,this.state.prestige,o("input[name='reason']:checked").val())];case 4:t=r.sent(),r.label=5;case 5:return[3,10];case 6:return 0===this.state.wealth?[3,8]:[4,s.awardWealth(this.state.reason,this.state.wealth,this.props.postId)];case 7:e=r.sent(),r.label=8;case 8:return 0===this.state.prestige?[3,10]:[4,s.addPrestige(this.props.postId,this.state.prestige,this.state.reason)];case 9:t=r.sent(),r.label=10;case 10:if("ok"===e&&"ok"===t)this.setState({tips:"操作成功"}),a="#manage"+this.props.postId,o(a).css("display","none"),this.props.update();else{switch(e){case"wrong input":this.setState({tips:"输入错误"});case"unauthorized":this.setState({tips:"你没有权限进行此操作"});case"limited":this.setState({tips:"今天发米已经超过限制"})}switch(t){case"wrong input":this.setState({tips:"输入错误"});case"unauthorized":this.setState({tips:"你没有权限进行此操作"})}}return[3,12];case 11:this.setState({tips:"请输入原因！"}),r.label=12;case 12:return[3,37];case 13:return o("input[name='reason']:checked").val()?"自定义"===o("input[name='reason']:checked").val()?[3,20]:0===this.state.wealth?[3,15]:[4,s.deductWealth(o("input[name='reason']:checked").val(),this.state.wealth,this.props.postId)]:[3,29];case 14:e=r.sent(),r.label=15;case 15:return 0===this.state.prestige?[3,17]:[4,s.deductPrestige(this.props.postId,this.state.prestige,o("input[name='reason']:checked").val())];case 16:t=r.sent(),r.label=17;case 17:return 0===this.state.tpdays?[3,19]:[4,s.stopBoardPost(this.props.postId,o("input[name='reason']:checked").val(),this.state.tpdays)];case 18:n=r.sent(),r.label=19;case 19:return[3,28];case 20:return this.state.reason?0===this.state.wealth?[3,22]:[4,s.deductWealth(this.state.reason,this.state.wealth,this.props.postId)]:[3,27];case 21:e=r.sent(),r.label=22;case 22:return 0===this.state.prestige?[3,24]:[4,s.deductPrestige(this.props.postId,this.state.prestige,this.state.reason)];case 23:t=r.sent(),r.label=24;case 24:return 0===this.state.tpdays?[3,26]:[4,s.stopBoardPost(this.props.postId,this.state.reason,this.state.tpdays)];case 25:n=r.sent(),r.label=26;case 26:return[3,28];case 27:this.setState({tips:"请输入原因！"}),r.label=28;case 28:if("ok"===e&&"ok"===t&&"ok"===n)this.setState({tips:"操作成功"}),i="#manage"+this.props.postId,o(i).css("display","none"),this.props.update();else{switch(e){case"wrong input":this.setState({tips:"输入错误"});case"unauthorized":this.setState({tips:"你没有权限进行此操作"})}switch(t){case"wrong input":this.setState({tips:"输入错误"});case"unauthorized":this.setState({tips:"你没有权限进行此操作"})}}return[3,30];case 29:this.setState({tips:"请选一个选项！"}),r.label=30;case 30:return[3,37];case 31:return this.state.reason?[4,s.deletePost(this.props.topicId,this.props.postId,this.state.reason)]:[3,33];case 32:if("ok"===(e=r.sent()))this.setState({tips:"操作成功"}),c="#manage"+this.props.postId,o(c).css("display","none"),this.props.update();else switch(e){case"wrong input":this.setState({tips:"输入错误"});case"unauthorized":this.setState({tips:"你没有权限进行此操作"})}return[3,34];case 33:this.setState({tips:"请输入原因！"}),r.label=34;case 34:return[3,37];case 35:return[4,s.cancelStopBoardPost(this.props.userId,this.props.boardId)];case 36:r.sent(),l="#manage"+this.props.postId,o(l).css("display","none"),this.props.update(),r.label=37;case 37:return[2]}})})},t.prototype.wealthInput=function(e){this.setState({wealth:e.target.value})},t.prototype.prestigeInput=function(e){this.setState({prestige:e.target.value})},t.prototype.reasonInput=function(e){this.setState({reason:e.target.value})},t.prototype.tpdaysInput=function(e){this.setState({tpdays:e.target.value})},t.prototype.close=function(){var e="#manage"+this.props.postId;o(e).css("display","none")},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a;return r.__generator(this,function(r){return"manageOptions-award"+this.props.postId,e="#manageOptions-award"+this.props.postId,"manageOptions-punish"+this.props.postId,t="#manageOptions-punish"+this.props.postId,"manageOptions-delete"+this.props.postId,n="#manageOptions-delete"+this.props.postId,"manageOptions-other"+this.props.postId,a="#manageOptions-other"+this.props.postId,"Award"===this.state.UI&&(o(e).css("background-color","#b9d3ee"),o(t).css("background-color","#fffacd"),o(n).css("background-color","#fffacd"),o(a).css("background-color","#fffacd")),"Punish"===this.state.UI&&(o(e).css("background-color","#fffacd"),o(t).css("background-color","#b9d3ee"),o(n).css("background-color","#fffacd"),o(a).css("background-color","#fffacd")),"Delete"===this.state.UI&&(o(e).css("background-color","#fffacd"),o(t).css("background-color","#fffacd"),o(n).css("background-color","#b9d3ee"),o(a).css("background-color","#fffacd")),"管理员"!==this.props.privilege?o(".managePrestige").css("display","none"):o(".managePrestige").css("display",""),[2]})})},t.prototype.componentDidUpdate=function(){"管理员"!==this.props.privilege?o(".managePrestige").css("display","none"):o(".managePrestige").css("display","")},t.prototype.render=function(){var e,t=0;t=this.props.m_wealth?this.props.m_wealth:"不限";var n=a.createElement("div",{className:"column manageInfo",id:"award"},a.createElement("div",{className:"row manageOperation"},a.createElement("div",{className:"manageObject"},"财富值"),a.createElement("input",{type:"text",value:this.state.wealth,onChange:this.wealthInput})),a.createElement("div",{className:"row",style:{color:"white"}},"您今天在",this.props.boardName,"已经发了",this.props.d_wealth,"财富值，最多可发",t),a.createElement("div",{className:"row manageOperation managePrestige"},a.createElement("div",{className:"manageObject"},"威望"),a.createElement("input",{type:"text",value:this.state.prestige,onChange:this.prestigeInput})),a.createElement("div",{className:"column manageOperation"},a.createElement("div",{className:"row",style:{justifyContent:"flex-start",marginLeft:"3rem",marginTop:"1rem",color:"#fff"}},a.createElement("div",null,"原因"),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"reason",value:"好文章"}),a.createElement("div",null,"好文章")),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"reason",value:"有用资源"}),a.createElement("div",null,"有用资源")),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"reason",value:"热心回复"}),a.createElement("div",null,"热心回复"))),a.createElement("div",{className:"row",style:{justifyContent:"flex-start",marginLeft:"3rem",color:"#fff",marginTop:"1rem"}},a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"reason",value:"自定义"}),a.createElement("div",null,"自定义")),a.createElement("input",{type:"text",value:this.state.reason,onChange:this.reasonInput})),a.createElement("div",null,this.state.tips))),r=a.createElement("div",{className:"column manageInfo",id:"punish"},a.createElement("div",{className:"row manageOperation"},a.createElement("div",{className:"manageObject"},"扣财富值"),a.createElement("input",{type:"text",value:this.state.wealth,onChange:this.wealthInput})),a.createElement("div",{className:"row manageOperation managePrestige"},a.createElement("div",{className:"manageObject"},"扣威望"),a.createElement("input",{type:"text",value:this.state.prestige,onChange:this.prestigeInput})),a.createElement("div",{className:"row manageOperation",style:{display:""}},a.createElement("div",{className:"manageObject"},"禁止发言(天)"),a.createElement("input",{type:"text",value:this.state.tpdays,onChange:this.tpdaysInput})),a.createElement("div",{className:"column manageOperation"},a.createElement("div",{className:"row",style:{justifyContent:"flex-start",marginLeft:"3rem",color:"#fff",marginTop:"1rem"}},a.createElement("div",null,"原因"),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"reason",value:"人身攻击"}),a.createElement("div",null,"人身攻击")),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"reason",value:"恶意灌水"}),a.createElement("div",null,"恶意灌水")),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"reason",value:"违反版规"}),a.createElement("div",null,"违反版规"))),a.createElement("div",{className:"row",style:{justifyContent:"flex-start",marginLeft:"3rem",color:"#fff",marginTop:"1rem"}},a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"reason",value:"自定义"}),a.createElement("div",null,"自定义")),a.createElement("input",{type:"text",value:this.state.reason,onChange:this.reasonInput})),a.createElement("div",null,this.state.tips))),s=a.createElement("div",{className:"row manageOperation"},a.createElement("div",{className:"manageObject"},"删除原因"),a.createElement("input",{type:"text",value:this.state.reason,onChange:this.reasonInput}));1===this.props.floor&&(s=a.createElement("div",null,"删除主题帖请在底部进行操作"));var i=a.createElement("div",{className:"column manageInfo",id:"punish"},s),c=a.createElement("div",{className:"column manageInfo",id:"other"},a.createElement("div",null,"解除此用户版面tp")),l="manage"+this.props.postId;e=n;var u="manageOptions-award"+this.props.postId,d="#manageOptions-award"+this.props.postId,p="manageOptions-punish"+this.props.postId,m="#manageOptions-punish"+this.props.postId,h="manageOptions-delete"+this.props.postId,f="#manageOptions-delete"+this.props.postId,g="manageOptions-other"+this.props.postId,v="#manageOptions-other"+this.props.postId;return"Award"===this.state.UI&&(e=n,o(d).css("background-color","#b9d3ee"),o(m).css("background-color","#fffacd"),o(f).css("background-color","#fffacd"),o(v).css("background-color","#fffacd")),"Punish"===this.state.UI&&(e=r,o(d).css("background-color","#fffacd"),o(m).css("background-color","#b9d3ee"),o(f).css("background-color","#fffacd"),o(v).css("background-color","#fffacd")),"Delete"===this.state.UI&&(e=i,o(d).css("background-color","#fffacd"),o(m).css("background-color","#fffacd"),o(f).css("background-color","#b9d3ee"),o(v).css("background-color","#fffacd")),"Other"===this.state.UI&&(e=c,o(d).css("background-color","#fffacd"),o(m).css("background-color","#fffacd"),o(f).css("background-color","#fffacd"),o(v).css("background-color","#b9d3ee")),a.createElement("div",{style:{display:"none"},id:l,className:"postManagement"},a.createElement("div",{className:"manageUI"},a.createElement("div",{className:"row manageOptions"},a.createElement("div",{className:"manageOptions-icon",id:u,onClick:this.showAwardUI,style:{color:"#FF7F00"}},"奖励"),a.createElement("div",{className:"manageOptions-icon",id:p,onClick:this.showPunishUI,style:{color:"red"}},"惩罚"),a.createElement("div",{className:"manageOptions-icon",id:h,onClick:this.showDeleteUI},"删除"),a.createElement("div",{className:"manageOptions-icon",id:g,onClick:this.showOtherUI},"其他"))),e,a.createElement("div",{className:"row",style:{justifyContent:"space-around"}},a.createElement("button",{onClick:this.confirm,className:"confirmManagement"},"确认"),a.createElement("button",{onClick:this.close,className:"confirmManagement"},"关闭")))},t}(a.Component);t.PostManagement=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(t,n){return e.call(this,t,n)||this}return r.__extends(t,e),t.prototype.render=function(){return a.createElement("div",{className:"good tagSize"},a.createElement("div",{className:"userImage"},a.createElement("img",{src:this.props.portraitUrl})," "),a.createElement("div",{className:"userName"},this.props.userName),a.createElement("div",{className:"grades"},this.props.content),a.createElement("div",{className:"credit"},a.createElement("span",null,this.props.reason)))},t}(a.Component);t.AwardInfo=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(275),i=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.showAll=r.showAll.bind(r),r.hideAll=r.hideAll.bind(r),r.generateAwardInfo=r.generateAwardInfo.bind(r),r.state={info:[],shortInfo:[],count:0,showAll:!1},r}return r.__extends(t,e),t.prototype.hideAll=function(){this.setState({showAll:!1})},t.prototype.showAll=function(){this.setState({showAll:!0})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i,c;return r.__generator(this,function(r){switch(r.label){case 0:for(i in e=[],(t=this.props.awardInfo)||(t=[]),n=[],a=[],t)n[i]=t[i].operatorName;return t.length>0?[4,s.getUsersInfobyNames(n)]:[3,2];case 1:a=r.sent(),r.label=2;case 2:for(i in t)o=s.getThisUserInfobyName(t[i].operatorName,a),t[i].portraitUrl=o.portraitUrl;if(t.length>10)for(i=0;i<10;i++)e[i]=this.generateAwardInfo(t[i]);return c=t.map(this.generateAwardInfo.bind(this)),this.setState({info:c,shortInfo:e,count:t.length}),[2]}})})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,o,i,c,l;return r.__generator(this,function(r){switch(r.label){case 0:for(i in t=[],(n=e.awardInfo)||(n=[]),a=[],o=[],n)a[i]=n[i].operatorName;return[4,s.getUsersInfobyNames(a)];case 1:if(o=r.sent(),n.length>10)for(i=0;i<10;i++)c=s.getThisUserInfobyName(n[i].operatorName,o),n[i].portraitUrl=c.portraitUrl,n[i],t[i]=this.generateAwardInfo(n[i]);return l=n.map(this.generateAwardInfo.bind(this)),this.setState({info:l,shortInfo:t,count:n.length}),[2]}})})},t.prototype.generateAwardInfo=function(e){return a.createElement(o.AwardInfo,{postId:this.props.postId,portraitUrl:e.portraitUrl,content:e.content,reason:e.reason,userName:e.operatorName})},t.prototype.render=function(){var e="#awardInfo"+this.props.postId,t="awardInfo"+this.props.postId;$(e).css("display",""),this.state.info&&0!==this.state.info.length?this.state.info.length<10&&$(e).css("display",""):$(e).css("display","none");var n=a.createElement("button",{style:{border:"#eaeaea solid thin",cursor:"pointer"},onClick:this.state.showAll?this.hideAll:this.showAll},this.state.showAll?"收起":"显示全部");return a.createElement("div",{className:"column awardInfo",id:t},a.createElement("div",{className:"row",style:{width:"25rem",fontSize:"0.8rem",marginBottom:"0.2rem"}},a.createElement("div",{style:{marginLeft:"3.1rem"}},"用户"),a.createElement("div",{style:{marginLeft:"4.7rem"}},"操作"),a.createElement("div",{style:{marginLeft:"8.9rem"}},"理由")),this.state.count>10?this.state.showAll?this.state.info:this.state.shortInfo:this.state.info,this.state.count>10?n:null)},t}(a.Component);t.Award=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(22),i=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.state={postId:r.props.postId},r}return r.__extends(t,e),t.prototype.componentDidUpdate=function(){var e="doc-content"+this.props.postId;editormd.markdownToHTML(e,{htmlDecode:!1,emoji:!0,taskList:!0,tex:!0,flowChart:!0,sequenceDiagram:!0,codeFold:!0})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){return e="doc-content"+this.props.postId,editormd.markdownToHTML(e,{htmlDecode:!1,emoji:!0,taskList:!0,tex:!0,flowChart:!0,sequenceDiagram:!0,codeFold:!0}),this.setState({}),[2]})})},t.prototype.render=function(){var e,t="doc-content"+this.props.postId,n=s.atUserUbbUrl(this.props.content),r=a.createElement(o.UbbContainer,{code:n}),i=s.atUserMdUrl(this.props.content),c=a.createElement("div",{id:t},a.createElement("textarea",{name:"editormd-markdown-doc",style:{display:"none"}},i));return e=r,1===this.props.contentType&&(e=c),a.createElement("div",{className:"reply-content"},a.createElement("div",{className:"substance"},e))},t}(a.Component);t.ReplyContent=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=n(80),i=n(4),c=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.follow=r.follow.bind(r),r.unfollow=r.unfollow.bind(r),r.changeTraceMode=r.changeTraceMode.bind(r),r.state={traceMode:r.props.traceMode,buttonInfo:"关注",buttonIsDisabled:!1,isFollowing:!1,fanCount:r.props.userInfo.fanCount,photoframe:null},r}return r.__extends(t,e),t.prototype.changeTraceMode=function(){this.setState({traceMode:!0!==this.state.traceMode})},t.prototype.unfollow=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.setState({buttonIsDisabled:!0,buttonInfo:"..."}),e=i.getLocalStorage("accessToken"),t=this.props.userInfo.id,n="/me/followee/"+t,(a=new Headers).append("Authorization",e),[4,i.cc98Fetch(n,{method:"DELETE",headers:a})];case 1:return 200!==r.sent().status?[3,3]:[4,i.updateUserInfo(this.props.userInfo.id)];case 2:return r.sent(),this.setState({buttonIsDisabled:!1,buttonInfo:"关注",isFollowing:!1,fanCount:this.props.userInfo.fanCount}),[3,4];case 3:throw{};case 4:return[3,6];case 5:return r.sent(),alert("网络错误"),[3,6];case 6:return[2]}})})},t.prototype.follow=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.setState({buttonIsDisabled:!0,buttonInfo:"..."}),e=i.getLocalStorage("accessToken"),t=this.props.userInfo.id,n="/me/followee/"+t,(a=new Headers).append("Authorization",e),[4,i.cc98Fetch(n,{method:"PUT",headers:a})];case 1:return 200!==r.sent().status?[3,3]:[4,i.updateUserInfo(this.props.userInfo.id)];case 2:return r.sent(),this.setState({buttonIsDisabled:!1,buttonInfo:"取关",isFollowing:!0,fanCount:this.props.userInfo.fanCount+1}),[3,4];case 3:throw{};case 4:return[3,6];case 5:return r.sent(),alert("网络错误"),[3,6];case 6:return[2]}})})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return e=this.props.userInfo.displayTitleId,[4,this.getPhotoFrame(e)];case 1:return t=n.sent(),this.setState({photoframe:t}),[2]}})})},t.prototype.getPhotoFrame=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,s,o,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return t="/user/id/"+this.props.userInfo.id,n=encodeURI(t),1!=this.props.topicInfo.isAnonymous?[3,1]:[2,a.createElement("div",{style:{width:"100%",justifyContent:"center",display:"flex",position:"relative"}},a.createElement("div",{style:{zIndex:100}},a.createElement("img",{className:"userPortrait",src:this.props.userInfo.portraitUrl})))];case 1:return e?[4,fetch("/static/portrait.json")]:[3,4];case 2:return[4,r.sent().json()];case 3:switch(s=r.sent(),o=void 0,i=s.普通.style,e){case 82:i=s.吉祥物.style,o=s.吉祥物.imageUrl;break;case 18:case 22:o=s.版主.imageUrl;break;case 85:case 29:o=s.编辑部.imageUrl;break;case 37:case 23:o=s.技术组.imageUrl;break;case 28:case 16:o=s.贵宾.imageUrl;break;case 84:case 34:o=s.策划部.imageUrl;break;case 96:case 99:o=s.影音部.imageUrl;break;case 32:case 21:o=s.站务组.imageUrl;break;case 86:case 35:o=s.体育部.imageUrl;break;case 94:case 93:o=s.办公室.imageUrl;break;case 91:o=s.认证用户.imageUrl;break;default:o=s.普通.imageUrl}return c={},82===e&&(c={boxShadow:"0 0 0"}),[2,a.createElement("div",{style:{width:"100%",justifyContent:"center",display:"flex",position:"relative"}},a.createElement("div",{style:{zIndex:100}},a.createElement("a",{href:n,style:{display:"block",maxHeight:"5rem"}},a.createElement("img",{className:"userPortrait",src:this.props.userInfo.portraitUrl,style:c}))),a.createElement("div",{className:"photoFrame"},a.createElement("img",{src:o,style:i})))];case 4:return[2,a.createElement("div",{style:{width:"100%",justifyContent:"center",display:"flex",position:"relative"}},a.createElement("div",{style:{zIndex:100}},a.createElement("a",{href:n,style:{display:"block",maxHeight:"7.5rem"}},a.createElement("img",{className:"userPortrait",src:this.props.userInfo.portraitUrl}))))]}})})},t.prototype.render=function(){if(!this.props.topicInfo.isAnonymous){var e="/user/id/"+this.props.userInfo.id,t=encodeURI(e);a.createElement("a",{href:t,style:{display:"block",maxHeight:"7.5rem"}},a.createElement("img",{className:"userPortrait",src:this.props.userInfo.portraitUrl}))}1==this.props.topicInfo.isAnonymous&&a.createElement("div",{style:{display:"block",maxHeight:"7.5rem"}},a.createElement("img",{className:"userPortrait",src:this.props.userInfo.portraitUrl}));this.props.userInfo.id;var n=a.createElement("div",{style:{color:"#fff"},className:"userMessage-userName"},this.props.userInfo.name);if(!this.props.topicInfo.isAnonymous){e="/user/id/"+this.props.userInfo.id,t=encodeURI(e);n=a.createElement(s.Link,{style:{color:"#fff"},className:"userMessage-userName",to:t},this.props.userInfo.name)}"匿名"!=this.props.userInfo.privilege&&"匿名用户"!==this.props.userInfo.privilege||(n=a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%"}},a.createElement("div",{style:{color:"white",fontSize:"1rem",fontWeight:"bold",marginLeft:"1rem",marginTop:"-0.8rem"}},this.props.userInfo.name),a.createElement("div",{className:"userMessageAnonymous"},"别问我是谁")));a.createElement("div",{style:{color:"red",marginLeft:"1rem"}},a.createElement("span",null,"最热回复"),a.createElement("span",null,"(第"),a.createElement("span",null,this.props.topicInfo.floor),a.createElement("span",null,"楼)")),a.createElement("div",{style:{marginLeft:"0.625rem"}},a.createElement("span",null,"第"),a.createElement("span",{style:{color:"red"}},this.props.topicInfo.floor),a.createElement("span",null,"楼"));var r,o=null;if(i.getLocalStorage("userInfo")&&i.getLocalStorage("userInfo").name!==this.props.userInfo.name&&!this.props.topicInfo.isAnonymous){var c="/message/message?id="+this.props.userInfo.id;o=a.createElement("div",{className:"row userMessageBtn"},a.createElement("div",{style:{marginLeft:"0.85rem"}},a.createElement("button",{className:"replierBtn",id:this.state.isFollowing?"":"follow",onClick:this.state.isFollowing?this.unfollow:this.follow,disabled:this.state.buttonIsDisabled,style:{marginBottom:"0.6rem"}},this.state.buttonInfo)),a.createElement("div",{style:{marginLeft:"0.5rem"}}," ",a.createElement(s.Link,{to:c},a.createElement("button",{className:"replierBtn"},"私信"))))}var l=(new Date).getTime(),u=new Date(this.props.userInfo.lastLogOnTime).getTime(),d=parseInt((Math.abs(u-l)/1e3/60/60/24).toString()),p=parseInt((Math.abs(u-l)/1e3/60/60).toString());r=d>365?"一年前":d>30?"一月前":d>7?"一周前":d>1?d+"天前":p>1?p+"小时前":"1小时内";var m=null;this.props.topicInfo.isAnonymous||(m=a.createElement("div",{className:"column",style:{width:"60%",alignItems:"flex-start",paddingLeft:"1.5rem",marginTop:"1rem"}},a.createElement("div",{className:"userMessageOpt"},"帖数 ",this.props.userInfo.postCount),a.createElement("div",{className:"userMessageOpt"},"粉丝 ",this.state.fanCount),a.createElement("div",{className:"userMessageOpt"},"威望 ",this.props.userInfo.prestige),a.createElement("div",{className:"userMessageOpt"},"风评 ",this.props.userInfo.popularity),a.createElement("div",{className:"userMessageOpt"},"最后登录 ",r)));var h=a.createElement("div",{className:"userGender"},0===this.props.userInfo.gender?a.createElement("i",{className:"fa fa-venus",style:{color:"#fff"}}):a.createElement("i",{className:"fa fa-mars",style:{color:"#fff"}}));return 1==this.props.topicInfo.isAnonymous&&(h=null),a.createElement("div",{className:"userMessage"},a.createElement("div",{className:"column userMessage-left"},n,m),a.createElement("div",{className:"column userMessage-right"},h,this.state.photoframe,o))},t}(o.RouteComponent);t.Replier=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=function(e){function t(t){var n=e.call(this,t)||this;return n.confirm=n.confirm.bind(n),n.close=n.close.bind(n),n.showHighlight=n.showHighlight.bind(n),n.showNormal=n.showNormal.bind(n),n.showNoReason=n.showNoReason.bind(n),n.showDays=n.showDays.bind(n),n.showBoard=n.showBoard.bind(n),n.reasonInput=n.reasonInput.bind(n),n.daysInput=n.daysInput.bind(n),n.boardInput=n.boardInput.bind(n),n.state={state:"normal",reason:"",tips:"",days:0,board:null,topicInfo:n.props.topicInfo,fetchState:"ok",color:"#fff"},n}return r.__extends(t,e),t.prototype.showIP=function(){},t.prototype.showNormal=function(){this.setState({state:"normal"})},t.prototype.showNoReason=function(){this.setState({state:"noReason"})},t.prototype.showDays=function(){this.setState({state:"days"})},t.prototype.showHighlight=function(){this.setState({state:"highlight"})},t.prototype.showBoard=function(){this.setState({state:"board"})},t.prototype.confirm=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i;return r.__generator(this,function(r){switch(r.label){case 0:switch(e="ok",this.state.state){case"normal":return[3,1];case"highlight":return[3,23];case"days":return[3,27];case"board":return[3,37]}return[3,40];case 1:if(""===this.state.reason)return[3,21];switch($("input[name='option']:checked").val()){case"取消固顶":return[3,2];case"取消全站固顶":return[3,4];case"删除":return[3,6];case"加精":return[3,8];case"解除精华":return[3,10];case"解锁":return[3,12];case"禁止热门":return[3,14];case"允许热门":return[3,16];case"提升":return[3,18]}return[3,20];case 2:return[4,s.removeBoardTopTopic(this.props.topicInfo.id,this.props.boardId,this.state.reason)];case 3:e=r.sent(),this.setState({fetchState:e}),r.label=4;case 4:return[4,s.removeBoardTopTopic(this.props.topicInfo.id,this.props.boardId,this.state.reason)];case 5:return e=r.sent(),this.setState({fetchState:e}),[3,20];case 6:return[4,s.deleteTopic(this.props.topicInfo.id,this.state.reason)];case 7:return e=r.sent(),this.setState({fetchState:e}),[3,20];case 8:return[4,s.setBestTopic(this.props.topicInfo.id,this.state.reason)];case 9:return e=r.sent(),this.setState({fetchState:e}),[3,20];case 10:return[4,s.cancelBestTopic(this.props.topicInfo.id,this.state.reason)];case 11:return e=r.sent(),this.setState({fetchState:e}),[3,20];case 12:return[4,s.unLockTopic(this.props.topicInfo.id,this.props.boardId,this.state.reason)];case 13:return e=r.sent(),this.setState({fetchState:e}),[3,20];case 14:return[4,s.setDisableHot(this.props.topicInfo.id,this.state.reason)];case 15:return e=r.sent(),this.setState({fetchState:e}),[3,20];case 16:return[4,s.cancelDisableHot(this.props.topicInfo.id,this.state.reason)];case 17:return e=r.sent(),this.setState({fetchState:e}),[3,20];case 18:return[4,s.upTopic(this.props.topicInfo.id,this.props.boardId,this.state.reason)];case 19:return e=r.sent(),this.setState({fetchState:e}),[3,20];case 20:return[3,22];case 21:this.setState({tips:"请输入原因！"}),r.label=22;case 22:return[3,40];case 23:return t=$("#custom").spectrum("get").toHexString($("#custom").spectrum("get")),""===this.state.reason?[3,25]:(n=!!$("input[name='bold']:checked"),a=!!$("input[name='italic']:checked"),[4,s.setHighlight(this.props.topicInfo.id,n,a,t,this.state.days,this.state.reason)]);case 24:return r.sent(),[3,26];case 25:this.setState({tips:"请输入原因！"}),r.label=26;case 26:return[3,40];case 27:if(!this.state.reason)return[3,35];switch($("input[name='option']:checked").val()){case"固顶":return[3,28];case"全站固顶":return[3,30];case"锁定":return[3,32]}return[3,34];case 28:return[4,s.addBoardTopTopic(this.props.topicInfo.id,this.props.boardId,2,this.state.days,this.state.reason)];case 29:return e=r.sent(),this.setState({fetchState:e}),[3,34];case 30:return[4,s.addBoardTopTopic(this.props.topicInfo.id,this.props.boardId,4,this.state.days,this.state.reason)];case 31:return e=r.sent(),this.setState({fetchState:e}),[3,34];case 32:return[4,s.lockTopic(this.props.topicInfo.id,this.props.boardId,this.state.reason,this.state.days)];case 33:return e=r.sent(),this.setState({fetchState:e}),[3,34];case 34:return[3,36];case 35:this.setState({tips:"请输入原因！"}),r.label=36;case 36:return[3,40];case 37:return this.state.reason?[4,s.moveTopic(this.props.topicInfo.id,this.state.board,this.state.reason)]:[3,39];case 38:return"ok"===(e=r.sent())?(this.setState({fetchState:e}),[3,40]):(this.setState({tips:"输入有误！"}),[3,40]);case 39:this.setState({tips:"请输入原因！"}),r.label=40;case 40:return"ok"!==e?[3,42]:(s.noticeMessageShow("operationSuccess"),this.setState({tips:"操作成功"}),o="#manage"+this.props.topicInfo.id,$(o).css("display","none"),[4,s.getTopicInfo(this.props.topicInfo.id)]);case 41:i=r.sent(),this.setState({topicInfo:i}),this.props.update(),r.label=42;case 42:return[2]}})})},t.prototype.close=function(){var e="#manage"+this.props.topicInfo.id;$(e).css("display","none")},t.prototype.reasonInput=function(e){this.setState({reason:e.target.value})},t.prototype.daysInput=function(e){this.setState({days:e.target.value})},t.prototype.boardInput=function(e){this.setState({board:e.target.value})},t.prototype.componentDidUpdate=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return $("#custom").spectrum({color:"#f00"}),[2]})})},t.prototype.render=function(){var e,t=a.createElement("div",{className:"column"},a.createElement("div",{className:"row manageOperation",style:{justifyContent:"space-around",marginTop:"1rem"}},a.createElement("div",null,"原因"),a.createElement("input",{type:"text",value:this.state.reason,onChange:this.reasonInput})),a.createElement("div",null,this.state.tips)),n=a.createElement("div",{className:"column"},a.createElement("div",{className:"row manageOperation",style:{justifyContent:"space-around",marginTop:"1rem"}},a.createElement("div",null,"(下沉)天数"),a.createElement("input",{type:"text",value:this.state.days,onChange:this.daysInput})),a.createElement("div",{className:"row manageOperation",style:{justifyContent:"space-around",marginTop:"1rem"}},a.createElement("div",null,"原因"),a.createElement("input",{type:"text",value:this.state.reason,onChange:this.reasonInput})),a.createElement("div",null,this.state.tips)),r=a.createElement("div",{className:"column"},a.createElement("div",{className:"row manageOperation",style:{justifyContent:"space-around",marginTop:"1rem"}},a.createElement("div",null,"版面"),a.createElement("input",{type:"text",value:this.state.board,onChange:this.boardInput})),a.createElement("div",{className:"row manageOperation",style:{justifyContent:"space-around",marginTop:"1rem"}},a.createElement("div",null,"原因"),a.createElement("input",{type:"text",value:this.state.reason,onChange:this.reasonInput})),a.createElement("div",null,this.state.tips)),s=a.createElement("div",{className:"column"},a.createElement("div",{className:"row manageOperation",style:{justifyContent:"space-around",marginTop:"1rem"}},a.createElement("div",null,"加粗"),a.createElement("input",{type:"radio",value:"加粗",name:"bold"})),a.createElement("div",{className:"row manageOperation",style:{justifyContent:"space-around",marginTop:"1rem"}},a.createElement("div",null,"斜体"),a.createElement("input",{type:"radio",value:"斜体",name:"italic"})),a.createElement("div",{className:"row manageOperation",style:{justifyContent:"space-around",marginTop:"1rem"}},a.createElement("div",null,"颜色"),a.createElement("input",{type:"text",id:"custom"})),a.createElement("div",{className:"row manageOperation",style:{justifyContent:"space-around",marginTop:"1rem"}},a.createElement("div",null,"天数"),a.createElement("input",{type:"text",value:this.state.days,onChange:this.daysInput})),a.createElement("div",{className:"row manageOperation",style:{justifyContent:"space-around",marginTop:"1rem"}},a.createElement("div",null,"原因"),a.createElement("input",{type:"text",value:this.state.reason,onChange:this.reasonInput})),a.createElement("div",null,this.state.tips));switch(this.state.state){case"normal":e=t;break;case"noReason":e=null;break;case"days":e=n;break;case"board":e=r;break;case"highlight":e=s}var o=a.createElement("div",{className:"column manageInfo",id:"award"},a.createElement("div",{className:"column",style:{alignItems:"center"}},a.createElement("div",{className:"row"},a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"option",value:1===this.props.topicInfo.state?"解锁":"锁定",onClick:1===this.props.topicInfo.state?this.showNormal:this.showDays}),a.createElement("div",null,1===this.props.topicInfo.state?"解锁":"锁定")),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"option",value:this.props.topicInfo.disableHot?"允许热门":"禁止热门",onClick:this.showNormal}),a.createElement("div",null,this.props.topicInfo.disableHot?"允许热门":"禁止热门"))),a.createElement("div",{className:"row",style:{marginTop:"1rem"}},a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"option",value:"删除",onClick:this.showNormal}),a.createElement("div",null,"删除")),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"option",value:"移动",onClick:this.showBoard}),a.createElement("div",null,"移动")),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"option",value:"提升",onClick:this.showNormal}),a.createElement("div",null,"提升"))),a.createElement("div",{className:"row",style:{marginTop:"1rem"}},a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"option",value:2===this.props.topicInfo.topState?"取消固顶":"固顶",onClick:2===this.props.topicInfo.topState?this.showNormal:this.showDays}),a.createElement("div",null,2===this.props.topicInfo.topState?"取消固顶":"固顶")),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"option",value:4===this.props.topicInfo.topState?"取消全站固顶":"全站固顶",onClick:4===this.props.topicInfo.topState?this.showNormal:this.showDays}),a.createElement("div",null,4===this.props.topicInfo.topState?"取消全站固顶":"全站固顶")),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"option",value:1===this.props.topicInfo.bestState?"解除精华":"加精",onClick:this.showNormal}),a.createElement("div",null,1===this.props.topicInfo.bestState?"解除精华":"加精")),a.createElement("div",{className:"row"},a.createElement("input",{type:"radio",name:"option",value:"高亮",onClick:this.showHighlight}),a.createElement("div",null,"高亮")))),e),i="manage"+this.props.topicInfo.id;this.props.topicInfo.id;return a.createElement("div",{style:{display:"none"},id:i,className:"topicManagement"},o,a.createElement("div",{className:"row",style:{justifyContent:"space-around",marginTop:"1rem"}},a.createElement("button",{onClick:this.confirm,className:"confirmManagement"},"确认"),a.createElement("button",{onClick:this.close,className:"confirmManagement"},"关闭")))},t}(a.Component);t.TopicManagement=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(t){var n=e.call(this,t)||this;return n.state={loaded:!1},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this,t=new Image;t.onload=function(){e.setState({loaded:!0})},t.src=this.props.src},t.prototype.componentWillReceiveProps=function(e){var t=this;if(e.src!==this.props.src){this.setState({loaded:!1});var n=new Image;n.onload=function(){t.setState({loaded:!0})},n.src=e.src}},t.prototype.render=function(){return this.state.loaded?a.createElement("img",{className:this.props.className,src:this.props.src,onClick:this.props.onClick}):a.createElement("img",{className:this.props.className})},t}(a.Component);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(280),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this,t={animal:["001","002","003","004","005","006","007","008","009","010","011","012","013","014","015","016"].map(function(t){return a.createElement(s.default,{key:"[a:"+t+"]",src:"/static/images/mahjong/animal2017/"+t+".png",onClick:function(){e.props.handleEmojiButtonClick("[a:"+t+"]")}})}),carton:["003.png","018.gif","019.png","046.png","049.gif","059.png","096.gif","134.png","189.png","217.png"].map(function(t){return a.createElement(s.default,{key:"[c:"+t.slice(0,3)+"]",src:"/static/images/mahjong/carton2017/"+t,onClick:function(){e.props.handleEmojiButtonClick("[c:"+t.slice(0,3)+"]")}})}),face:new Array(208).fill(0).map(function(e,t){return t<9?"00"+(t+1):t<99?"0"+(t+1):""+(t+1)}).map(function(e,t){return-1!==[4,9,56,61,62,87,115,120,137,168,169,175,206].indexOf(t+1)?e+".gif":e+".png"}).map(function(t){return a.createElement(s.default,{key:"[f:"+t.slice(0,3)+"]",src:"/static/images/mahjong/face2017/"+t,onClick:function(){e.props.handleEmojiButtonClick("[f:"+t.slice(0,3)+"]")}})})},n={em:new Array(92).fill(0).map(function(e,t){return t<10?"0"+t:t<44||70<t&&t<92?""+t:void 0}).map(function(t){return t?a.createElement(s.default,{key:"[em"+t+"]",src:"/static/images/em/em"+t+".gif",onClick:function(){e.props.handleEmojiButtonClick("[em"+t+"]")}}):null}),ac:new Array(149).fill(0).map(function(e,t){return t<9?"0"+(t+1):t<54?""+(t+1):t<94?""+(t+947):""+(t+1907)}).map(function(t){return a.createElement(s.default,{key:"[ac"+t+"]",src:"/static/images/ac/"+t+".png",onClick:function(){e.props.handleEmojiButtonClick("[ac"+t+"]")}})}),mj:t.animal.concat(t.carton,t.face),tb:new Array(33).fill(0).map(function(e,t){return t<9?"0"+(t+1):""+(t+1)}).map(function(t){return a.createElement(s.default,{key:"[tb"+t+"]",src:"/static/images/tb/tb"+t+".png",onClick:function(){e.props.handleEmojiButtonClick("[tb"+t+"]")}})})},r={ac:a.createElement("p",{className:"ubb-emoji-info"},"该组表情由 ",a.createElement("a",{target:"_blank",href:"//www.acfun.cn"},"AcFun弹幕视频网")," 提供"),mj:a.createElement("p",{className:"ubb-emoji-info"},"该组表情由 ",a.createElement("a",{target:"_blank",href:"//bbs.saraba1st.com/2b/forum.php"},"stage1st论坛")," 提供"),tb:a.createElement("p",{className:"ubb-emoji-info"},"该组表情由 ",a.createElement("a",{target:"_blank",href:"//tieba.baidu.com "},"百度贴吧")," 提供"),em:null},o=this.props,i=(o.height,o.emojiType),c=o.emojiIsShown;return a.createElement("div",{className:"ubb-emoji",style:c?{height:"22rem",borderWidth:"1px"}:{height:"0rem"}},a.createElement("div",{className:"ubb-emoji-buttons"},a.createElement("button",{type:"button",className:"ac"===i?"ubb-emoji-button-active":"ubb-emoji-button",onClick:function(t){t.stopPropagation(),e.props.changeEmojiType("ac")}},"AC娘"),a.createElement("button",{type:"button",className:"mj"===i?"ubb-emoji-button-active":"ubb-emoji-button",onClick:function(t){t.stopPropagation(),e.props.changeEmojiType("mj")}},"麻将脸"),a.createElement("button",{type:"button",className:"tb"===i?"ubb-emoji-button-active":"ubb-emoji-button",onClick:function(t){t.stopPropagation(),e.props.changeEmojiType("tb")}},"贴吧"),a.createElement("button",{type:"button",className:"em"===i?"ubb-emoji-button-active":"ubb-emoji-button",onClick:function(t){t.stopPropagation(),e.props.changeEmojiType("em")}},"经典")),a.createElement("div",{className:"ubb-emoji-content ubb-emoji-content-"+i},r[i],n[i]))},t}(a.Component);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isShown:!1,message:t.message},n}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){var t=this;""!==e.message&&(this.setState({isShown:!0,message:e.message}),setTimeout(function(){t.setState({isShown:!1})},2e3))},t.prototype.render=function(){return a.createElement("div",{className:"ubb-editor-info",style:this.state.isShown?{opacity:1}:{opacity:0}},a.createElement("p",null,this.state.message))},t}(a.Component);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(){this.height=32.5,this.allowUbbTag="all",this.shouldReplaceSelection=["video","audio","img","upload","bili"],this.hasDefaultSelection=["url"],this.shouldNotSelected=["img","video","audio","upload","bili"],this.uploadFileMaxSize=10485760,this.textSize=[0,1,2,3,4,5,6,7],this.shouldEnter=["img","video","audio","upload","bili"],this.videoExtendNames=[],this.audioExtendNames=["wav","mp3","aac","ogg","m4a"],this.imageExtendNames=[]}}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(283),i=n(22),c=n(282),l=n(281),u=function(e){function t(t){var n=e.call(this,t)||this;return n.valueStack=[""],n.redoStack=[],n.state={selectionEnd:0,selectionStart:0,clicked:!1,extendValue:"",extendTagName:"",emojiType:"ac",emojiIsShown:!1,isPreviewing:!1,value:t.value||"",info:"",scrollTop:0,shouldCompassImage:!0},n.option=r.__assign({},new o.default,t.option),n.clearAllShown=n.clearAllShown.bind(n),n.handleExtendValueChange=n.handleExtendValueChange.bind(n),n.handleTextareaChange=n.handleTextareaChange.bind(n),n.handleTextareaBlur=n.handleTextareaBlur.bind(n),n.handleButtonClick=n.handleButtonClick.bind(n),n.handleEmojiButtonClick=n.handleEmojiButtonClick.bind(n),n.changeEmojiType=n.changeEmojiType.bind(n),n}return r.__extends(t,e),t.prototype.handleExtendButtonClick=function(e){this.setState(function(t){return{extendTagName:t.extendTagName!==e?e:"",emojiIsShown:!1}})},t.prototype.handleExtendValueChange=function(e){this.setState({extendValue:e})},t.prototype.handleTextareaChange=function(e){this.valueStack.push(e),this.props.update(e),this.setState({value:e})},t.prototype.handleTextareaBlur=function(e,t){this.setState({selectionStart:e,selectionEnd:t})},t.prototype.handleUpload=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,o,i,c,l,u,d,p=this;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),t=this.state.extendTagName,n=void 0===t?"img":t,a=this.state.shouldCompassImage?"/file":"/file?compressImage=false",[4,s.formAuthorizeHeader()];case 1:for(o=r.sent(),i=new FormData,c=0;c<e.length;c++){if("img"!==n&&e[c].size>this.option.uploadFileMaxSize)throw new Error("文件过大");if("img"===n&&!e[c].type.match("image"))throw new Error("请选择图片文件");i.append("files",e[c])}return i.append("contentType","multipart/form-data"),[4,s.cc98Fetch(a,{method:"POST",headers:o,body:i})];case 2:return[4,(l=r.sent()).json()];case 3:if(u=r.sent(),200!==l.status)throw new Error("上传文件失败");return u.map(function(t,r){var a;switch(n){case"img":case"audio":a=n;break;default:a=p.getTagNameByName(e[r].name.toLocaleLowerCase())||p.getTagNameByType(e[r].type)}p.handleButtonClick(a,t)}),this.uploadInput.value="",[3,5];case 4:return d=r.sent(),this.setState({info:d.message}),this.uploadInput.value="",setTimeout(function(){return p.setState({info:""})},2500),[3,5];case 5:return[2]}})})},t.prototype.getTagNameByName=function(e){var t=e.split(".");if(1===t.length)return null;var n=t.pop();return-1!==this.option.videoExtendNames.indexOf(n)?"video":-1!==this.option.audioExtendNames.indexOf(n)?"audio":-1!==this.option.imageExtendNames.indexOf(n)?"img":null},t.prototype.getTagNameByType=function(e){try{switch(e.match(/\w+/)[0]){case"image":return"img";case"video":return"video";case"audio":return"audio";default:return"upload"}}catch(e){return"upload"}},t.prototype.handleUndo=function(){var e=this;this.setState(function(t){if(1===e.valueStack.length)return{value:""};var n=e.valueStack.pop();return e.redoStack.push(n),n=e.valueStack[e.valueStack.length-1],e.props.update(n),{value:n}})},t.prototype.handleRedo=function(){var e=this;this.setState(function(t){var n=e.redoStack.pop();if(n)return e.valueStack.push(n),e.props.update(n),{value:n}})},t.prototype.handleButtonClick=function(e,t){var n=this;void 0===t&&(t="");var r=-1!==this.option.shouldReplaceSelection.indexOf(e),a=-1!==this.option.hasDefaultSelection.indexOf(e),s=-1!==this.option.shouldNotSelected.indexOf(e),o=-1!==this.option.shouldEnter.indexOf(e);this.setState(function(i){var c=n.state.value.slice(0,i.selectionStart),l=n.state.value.slice(i.selectionStart,i.selectionEnd),u=n.state.value.slice(i.selectionEnd,n.state.value.length);return l=r?"["+e+"]"+t+"[/"+e+"]":a?"["+e+(t?"="+t:"")+"]"+(l||t)+"[/"+e+"]":"["+e+(t?"="+t:"")+"]"+l+"[/"+e+"]",o&&(l+="\n"),n.props.update(c+l+u),n.valueStack.push(c+l+u),{selectionStart:s?c.length+l.length:c.length,selectionEnd:c.length+l.length,clicked:!0,value:c+l+u}})},t.prototype.handleEmojiButtonClick=function(e){var t=this;this.setState(function(n){var r=t.state.value.slice(0,n.selectionStart),a=e,s=t.state.value.slice(n.selectionEnd,t.state.value.length);return t.props.update(r+a+s),t.valueStack.push(r+a+s),{selectionStart:r.length+a.length,selectionEnd:r.length+a.length,clicked:!0,value:r+a+s}})},t.prototype.clearAllShown=function(){this.setState({emojiIsShown:!1,extendTagName:"",extendValue:""})},t.prototype.changeEmojiType=function(e){this.setState({emojiType:e})},t.prototype.componentWillReceiveProps=function(e){this.valueStack[this.valueStack.length-1]!==e.value&&(this.valueStack.push(e.value),this.redoStack=[],this.setState({value:e.value,selectionStart:e.value.length,selectionEnd:e.value.length,clicked:!0}))},t.prototype.componentDidUpdate=function(){this.state.clicked&&!this.state.isPreviewing&&(this.content.focus(),this.content.setSelectionRange(this.state.selectionStart,this.state.selectionEnd),this.content.scrollTop=this.state.scrollTop,this.setState({clicked:!1}))},t.prototype.componentDidMount=function(){var e=this;window.addEventListener("click",this.clearAllShown),$("#color").spectrum({color:"#000",change:function(t){e.handleButtonClick("color",t.toHexString()),$("#color").spectrum("set","#000000")},showPalette:!0,palette:[["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"],["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"]],replacerClassName:"ubb-color-picker",hideAfterPaletteSelect:!0})},t.prototype.componentWillUnmount=function(){window.removeEventListener("click",this.clearAllShown)},t.prototype.render=function(){var e,t,n=this,r=this.option,s=r.height,o=r.textSize,u=r.submit;switch(this.state.extendTagName){case"img":e="image/*";break;case"audio":e="audio/*";break;default:e="*"}switch(this.state.extendTagName){case"img":t="在此输入图片文件地址";break;case"video":t="在此输入视频文件地址";break;case"audio":t="在此输入音频文件地址";break;case"bili":t="在此输入bilibili网站视频AV号（数字）"}return a.createElement("div",{className:"ubb-editor",style:{maxHeight:s+6.125+"rem"}},a.createElement(c.default,{message:this.state.info}),a.createElement("div",{className:"editor-buttons"},a.createElement("div",{style:{height:"2rem",display:"flex",transitionDuration:".5s",overflow:"hidden",maxWidth:this.state.isPreviewing?"0rem":"50rem"}},a.createElement("div",{className:"editor-buttons-styles"},a.createElement("button",{className:"fa-bold",type:"button",title:"加粗",onClick:function(){n.handleButtonClick("b")}}),a.createElement("button",{className:"fa-italic",type:"button",title:"斜体",onClick:function(){n.handleButtonClick("i")}}),a.createElement("button",{className:"fa-underline",type:"button",title:"下划线",onClick:function(){n.handleButtonClick("u")}}),a.createElement("button",{className:"fa-strikethrough",type:"button",title:"删除线",onClick:function(){n.handleButtonClick("del")}}),a.createElement("button",{className:"fa-align-left",type:"button",title:"左对齐",onClick:function(){n.handleButtonClick("align","left")}}),a.createElement("button",{className:"fa-align-center",type:"button",title:"居中",onClick:function(){n.handleButtonClick("align","center")}}),a.createElement("button",{className:"fa-align-right",type:"button",title:"右对齐",onClick:function(){n.handleButtonClick("align","right")}}),a.createElement("button",{className:"fa-eye-slash",type:"button",title:"回复后可见",onClick:function(){n.handleButtonClick("replyview")}})),a.createElement("div",{className:"editor-buttons-selects"},a.createElement("p",{className:"fa-text-height"}),a.createElement("select",{onChange:function(e){n.handleButtonClick("size",e.target.value),e.target.value=0},onClick:function(){n.clearAllShown()},value:0},o.map(function(e,t){return a.createElement("option",{key:t,value:t,disabled:0===t},e)})),a.createElement("p",{className:"fa-eyedropper"}),a.createElement("input",{id:"color"})),a.createElement("div",{className:"editor-buttons-extends"},a.createElement("button",{className:"fa-smile-o",type:"button",title:"插入表情",onClick:function(e){e.stopPropagation(),n.setState(function(e){return{emojiIsShown:!e.emojiIsShown,extendTagName:"",extendValue:""}})}}),a.createElement("button",{className:"fa-link",type:"button",title:"插入url",onClick:function(e){e.stopPropagation(),n.handleExtendButtonClick("url")}}),a.createElement("button",{className:"fa-picture-o",type:"button",title:"插入图片",onClick:function(e){e.stopPropagation(),n.handleExtendButtonClick("img")}}),a.createElement("button",{className:"fa-film",type:"button",title:"插入视频",onClick:function(e){e.stopPropagation(),n.handleExtendButtonClick("video")}}),a.createElement("button",{className:"ubb-editor-bili-button",type:"button",title:"插入Bilibili视频",onClick:function(e){e.stopPropagation(),n.handleExtendButtonClick("bili")}},"Bili"),a.createElement("button",{className:"fa-music",type:"button",title:"插入音频",onClick:function(e){e.stopPropagation(),n.handleExtendButtonClick("audio")}}),a.createElement("label",{className:"fa-file",htmlFor:"upload",title:"上传文件",onClick:function(e){return e.stopPropagation(),n.handleExtendButtonClick("upload"),!1}}))),a.createElement("div",{style:{flexGrow:1}}),a.createElement("button",{className:"fa-undo",type:"button",title:"撤销",onClick:function(){n.handleUndo()}}),a.createElement("button",{className:"fa-repeat",type:"button",title:"重做",onClick:function(){n.handleRedo()}}),a.createElement("button",{type:"button",title:"切换预览",onClick:function(){n.setState(function(e){return{isPreviewing:!e.isPreviewing,clicked:!0}})},className:"fa-window-maximize"})),a.createElement("div",{className:"ubb-extend",style:{height:this.state.extendTagName&&"upload"!==this.state.extendTagName?"2rem":"0rem"}},a.createElement("input",{type:"text",placeholder:t,value:this.state.extendValue,onChange:function(e){n.handleExtendValueChange(e.target.value)},onClick:function(e){e.stopPropagation()},ref:function(e){n.input=e}}),"img"===this.state.extendTagName||"audio"===this.state.extendTagName?a.createElement("label",{onClick:function(e){e.stopPropagation()},className:"fa-upload",htmlFor:"upload",title:"上传本地文件"}):null,a.createElement("button",{className:"fa-check",type:"button",onClick:function(e){e.stopPropagation(),n.handleButtonClick(n.state.extendTagName,n.state.extendValue)}}),a.createElement("button",{className:"fa-remove",type:"button",onClick:function(){n.setState({clicked:!0})}}),"img"===this.state.extendTagName?a.createElement("p",{style:{color:"gray",fontSize:"0.75rem",flexGrow:1,textAlign:"center"}},"也可以直接将图片文件拖曳到下面的文本区进行上传"):null,"img"===this.state.extendTagName?a.createElement("p",{style:{color:"gray",fontSize:"0.75rem",flexGrow:1,textAlign:"center",display:"flex",alignItems:"center"}},a.createElement("input",{style:{width:"auto",height:"auto",margin:0},type:"checkbox",checked:!this.state.shouldCompassImage,onChange:function(e){e.stopPropagation(),n.setState(function(e){return{shouldCompassImage:!e.shouldCompassImage}})}}),"图片不压缩上传"):null,a.createElement("input",{type:"file",id:"upload",accept:e,style:{display:"none"},onClick:function(e){return e.stopPropagation()},onChange:function(e){return n.handleUpload(e.target.files)},ref:function(e){return n.uploadInput=e},multiple:!0})),a.createElement("div",{className:"ubb-content"},this.state.isPreviewing?a.createElement("div",{className:"ubb-editor-preview",style:{height:s+2+"rem"}},a.createElement(i.UbbContainer,{code:this.props.value})):a.createElement("textarea",{value:this.state.value,onChange:function(e){return n.handleTextareaChange(e.target.value)},onInput:function(e){return n.redoStack=[]},onFocus:function(){n.clearAllShown()},onBlur:function(e){var t=e.target;n.handleTextareaBlur(t.selectionStart,t.selectionEnd)},onDrop:function(e){e.preventDefault(),n.handleUpload(e.dataTransfer.files)},onScroll:function(e){n.setState({scrollTop:e.target.scrollTop})},onKeyDown:function(e){e.ctrlKey&&"z"===e.key?(e.preventDefault(),n.handleUndo()):e.ctrlKey&&"y"===e.key?(e.preventDefault(),n.handleRedo()):e.ctrlKey&&"Enter"===e.key&&(e.preventDefault(),u&&u())},ref:function(e){n.content=e},style:{height:this.state.extendTagName&&"upload"!==this.state.extendTagName?s+"rem":s+2+"rem"},spellCheck:!1})),a.createElement(l.default,{handleEmojiButtonClick:this.handleEmojiButtonClick,height:this.props.option.height,emojiIsShown:this.state.emojiIsShown,emojiType:this.state.emojiType,changeEmojiType:this.changeEmojiType}))},t}(a.Component);t.UbbEditor=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(4),o=n(34),i=n(6),c=n(80),l=n(152),u=n(151),d=n(59),p=n(150),m=n(71),h=n(149),f=n(105),g=n(16),v=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.update=r.update.bind(r),r.handleChange=r.handleChange.bind(r),r.quote=r.quote.bind(r),r.state={page:1,shouldRender:!0,topicid:r.match.params.topicid,totalPage:1,userName:null,boardId:7,topicInfo:{replyCount:0},boardInfo:{masters:[],id:7},fetchState:"ok",quote:"",isFav:!1,IPData:[]},r}return r.__extends(t,e),t.prototype.quote=function(e,t,n,r,a){o("#sendTopicInfo").offset().top;var s=this.state.page;this.state.page||(s=1);var i="/topic/"+this.state.topicid+"/"+s+"#sendTopicInfo";this.props.history.push(i),this.setState({quote:{content:e,userName:t,replyTime:n,floor:r,postId:a}})},t.prototype.update=function(){this.setState({})},t.prototype.handleChange=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return e=this.match.params.page?parseInt(this.match.params.page):1,[4,s.getTopicInfo(this.match.params.topicid)];case 1:return t=r.sent(),n=(t.replyCount+1)%10==0?(t.replyCount+1)/10:(t.replyCount+1-(t.replyCount+1)%10)/10+1,[4,this.getTotalPage(t.replyCount)];case 2:return r.sent(),this.match.params.userName,a=(t.replyCount+1)%10,o=s.getLocalStorage("noticeSetting"),e!=n?o&&"是"===o.post||n==e+1&&1==a?(e=n,c="/topic/"+t.id+"/"+e+"#"+a,this.setState({quote:{userName:"",content:"",replyTime:"",floor:""}}),this.props.history.push(c)):(c="/topic/"+t.id+"/"+e,this.state.quote&&this.state.quote.floor&&(i=this.state.quote.floor%10,c="/topic/"+t.id+"/"+e+"#"+i,this.setState({quote:{userName:"",content:"",replyTime:"",floor:""}}),this.props.history.push(c))):(e=n,c="/topic/"+t.id+"/"+e+"#"+a,this.setState({quote:{userName:"",content:"",replyTime:"",floor:""}}),this.props.history.push(c)),s.noticeMessageShow("replyMessage"),s.refreshHoverUnReadCount(),[2]}})})},t.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,o,i,c,l,u,d;return r.__generator(this,function(r){switch(r.label){case 0:return t=e.match.params.page?parseInt(e.match.params.page):1,n=e.match.params.userName,[4,s.getTopicInfo(e.match.params.topicid)];case 1:return a=r.sent(),o=a.boardId,[4,s.getBoardInfo(o)];case 2:return i=r.sent(),c=this.getTotalPage(a.replyCount),l=(a.replyCount+1)%10,t>c&&(t=c,u="/topic/"+a.id+"/"+t+"#"+l,this.props.history.push(u)),[4,s.getFavState(e.match.params.topicid)];case 3:return d=r.sent(),this.setState({page:t,topicid:e.match.params.topicid,totalPage:c,userName:n,boardId:o,topicInfo:a,boardInfo:i,isFav:d}),s.refreshHoverUnReadCount(),[2]}})})},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i,c,l,u,d;return r.__generator(this,function(r){switch(r.label){case 0:return e=this.match.params.page?parseInt(this.match.params.page):1,t=this.match.params.userName,[4,s.getTopicInfo(this.match.params.topicid)];case 1:return n=r.sent(),a=n.boardId,[4,s.getBoardInfo(a)];case 2:return o=r.sent(),i=this.getTotalPage(n.replyCount),c=(n.replyCount+1)%10,e>i&&(e=i,l="/topic/"+n.id+"/"+e+"#"+c,this.props.history.push(l)),[4,s.getFavState(this.match.params.topicid)];case 3:return u=r.sent(),d=[],this.setState({isFav:u,page:e,topicid:this.match.params.topicid,totalPage:i,userName:t,boardId:a,topicInfo:n,boardInfo:o,fetchState:n,IPData:d}),s.refreshHoverUnReadCount(),[2]}})})},t.prototype.getTotalPage=function(e){return s.getTotalPageof10(e)},t.prototype.render=function(){switch(this.state.fetchState){case"ok":return a.createElement("div",null);case"not found":return a.createElement(m.NotFoundTopic,null);case"unauthorized":return a.createElement(m.UnauthorizedTopic,null);case"server error":return a.createElement(m.ServerError,null)}var e;e=a.createElement(h.TopicInfo,{topicInfo:this.state.topicInfo,tag1:this.state.topicInfo.tag1,tag2:this.state.topicInfo.tag2,boardInfo:this.state.boardInfo,isFav:this.state.isFav}),1!==parseInt(this.match.params.page)&&this.match.params.page||a.createElement(p.Reply,{topicInfo:this.state.topicInfo,page:this.match.params.page,boardInfo:this.state.boardInfo,quote:this.quote,isTrace:!1,isHot:!0,postId:null,topicId:this.match.params.topicid});var t="/topic/"+this.state.topicid+"/",n=null;n=s.getLocalStorage("userInfo")?a.createElement(l.SendTopic,{onChange:this.handleChange,boardInfo:this.state.boardInfo,content:this.state.quote,topicInfo:this.state.topicInfo}):a.createElement("div",null,"您还未登录，无法发言，请先登录。"),s.getLocalStorage("userInfo")&&!s.getLocalStorage("userInfo").isVerified&&(n=a.createElement("div",null,"您的帐号未认证，无法发言，请先前往 ",a.createElement("a",{href:"https://account.cc98.org"},"https://account.cc98.org")," 认证激活。")),s.getLocalStorage("userInfo")&&0!==s.getLocalStorage("userInfo").lockState&&(n=a.createElement("div",null,"您的帐号被全站禁言。"));var r=null;return this.state.topicInfo&&1===this.state.topicInfo.state&&(r=a.createElement("div",{style:{color:"red",margin:"0.5rem"}},"该帖已被锁定")),a.createElement("div",{className:"center"},a.createElement(g.default,{title:(this.state.topicInfo.title||"帖子")+" - CC98论坛"}),a.createElement("div",{className:"column",style:{width:"100%"}},a.createElement("div",{className:"row",style:{width:"100%",justifyContent:"space-between",alignItems:"center"}},a.createElement(u.Category,{topicInfo:this.state.topicInfo,boardInfo:this.state.boardInfo,topicId:this.match.params.topicid}),a.createElement(d.Pager,{page:this.state.page,url:t,totalPage:this.state.totalPage})),r),e,a.createElement(p.Reply,{topicInfo:this.state.topicInfo,page:this.state.page,boardInfo:this.state.boardInfo,quote:this.quote,isHot:!1,isTrace:!1,postId:null,topicId:this.match.params.topicid}),a.createElement("div",{className:"column",style:{width:"100%"}},a.createElement("div",{className:"row",style:{width:"100%",justifyContent:"space-between",marginTop:"2rem"}},a.createElement(u.Category,{topicInfo:this.state.topicInfo,boardInfo:this.state.boardInfo,topicId:this.match.params.topicid}),a.createElement(d.Pager,{page:this.state.page,url:t,totalPage:this.state.totalPage}))),n,a.createElement(f.NoticeMessage,{text:"回复成功",id:"replyMessage",top:"24%",left:"46%"}))},t}(c.RouteComponent);t.Post=v,t.ShowTopic=i.withRouter(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=n(145),i=n(74),c=n(285),l=n(157),u=n(271),d=n(270),p=n(269),m=n(243),h=n(230),f=n(229),g=n(226),v=n(225),y=n(108),E=n(224),b=n(215),_=n(71),w=n(214),C=n(212),I=n(211),N=n(210),S=n(207),T=n(206),x=n(205),k=n(204),P=n(203),U=n(15),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=a.createElement(s.Switch,null,a.createElement(s.Route,{exact:!0,path:"/",component:y.MainPage}),a.createElement(s.Route,{exact:!0,path:"/topic/hot-monthly",component:T.MonthlyHotTopic}),a.createElement(s.Route,{exact:!0,path:"/topic/hot-weekly",component:x.WeeklyHotTopic}),a.createElement(s.Route,{exact:!0,path:"/topic/hot-history",component:k.HistoryHotTopic}),a.createElement(s.Route,{exact:!0,path:"/topic/:topicid/:page?",component:c.ShowTopic}),a.createElement(s.Route,{exact:!0,path:"/topic/:topicId/postid/:postId/:page?",component:u.CurUserPost}),a.createElement(s.Route,{path:"/list/:boardId/:type?/:page?",component:l.List}),a.createElement(s.Route,{exact:!0,path:"/boardlist",component:d.BoardList}),a.createElement(s.Route,{path:"/usercenter",component:p.default}),a.createElement(s.Route,{path:"/message",component:m.Message}),a.createElement(s.Route,{path:"/focus",component:f.Focus}),a.createElement(s.Route,{path:"/newtopics",component:h.AllNewTopic}),a.createElement(s.Route,{path:"/user/:method/:id",component:E.default}),a.createElement(s.Route,{path:"/logon",exact:!0,component:b.default}),a.createElement(s.Route,{path:"/search",component:w.Search}),a.createElement(s.Route,{path:"/searchBoard",component:C.SearchBoard}),a.createElement(s.Route,{path:"/signin",component:I.Signin}),a.createElement(s.Route,{path:"/sitemanage",component:N.SiteManage}),a.createElement(s.Route,{path:"/editor/:mode/:id?",component:S.ShowEdit}),a.createElement(s.Route,{component:_.PageNotFound}));return a.createElement("div",{style:{width:"100%"}},a.createElement(o.ConnectedRouter,{history:i.history},a.createElement("div",{style:{backGroundColor:"#F5FAFD",justifyContent:"center",display:"flex",flexDirection:"column",alignItems:"center",width:"100%",minWidth:"1140px",backgroundColor:"#e6e7ec"}},a.createElement(g.Header,null),a.createElement(s.Route,{component:P.default}),this.props.isError?a.createElement(s.Route,{component:_[this.props.errorMessage]}):e,a.createElement(v.Footer,null))))},t}(a.Component);t.default=U.connect(function(e){return{isError:e.error.isError,errorMessage:e.error.errorMessage}})(M)},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boardInfo=[{id:0,name:"未知版面"},{id:182,name:"心灵之约"},{id:758,name:"似水流年"},{id:68,name:"学习天地"},{id:102,name:"留学交流"},{id:105,name:"编程技术"},{id:263,name:"考研一族"},{id:304,name:"外语学习"},{id:329,name:"编程答疑"},{id:749,name:"社科学术"},{id:100,name:"校园信息"},{id:198,name:"新生宝典"},{id:235,name:"求职广场"},{id:357,name:"信息资讯"},{id:459,name:"实习兼职"},{id:515,name:"住房信息"},{id:581,name:"研究生"},{id:16,name:"自由贴图"},{id:25,name:"天籁之音"},{id:26,name:"读书时光"},{id:30,name:"动漫讨论"},{id:91,name:"游戏广场"},{id:115,name:"休闲娱乐"},{id:164,name:"影视综艺"},{id:180,name:"数码世界"},{id:226,name:"电脑医院"},{id:312,name:"怪力乱神"},{id:744,name:"NexusHD高清社区"},{id:759,name:"曲苑杂坛"},{id:760,name:"文学交流"},{id:80,name:"生活点滴"},{id:562,name:"数码交易"},{id:563,name:"服饰美肤"},{id:569,name:"代理专区"},{id:81,name:"感性空间"},{id:114,name:"郁闷小屋"},{id:135,name:"开怀一笑"},{id:144,name:"一路走来"},{id:152,name:"缘分天空"},{id:15,name:"体育运动"},{id:101,name:"个性生活"},{id:147,name:"行者无疆"},{id:173,name:"光影留痕"},{id:229,name:"美食健康"},{id:258,name:"宠物情缘"},{id:315,name:"98网事"},{id:353,name:"真我风采"},{id:551,name:"绿色心情"},{id:7,name:"王何宇老师答疑"},{id:20,name:"冯晓霞老师答疑"},{id:21,name:"何善蒙老师答疑"},{id:23,name:"肖少拥老师答疑"},{id:36,name:"王云武老师答疑"},{id:41,name:"楼学庆老师答疑"},{id:42,name:"杨起帆老师答疑"},{id:47,name:"陈越老师答疑"},{id:49,name:"方红光老师答疑"},{id:50,name:"徐镜春老师答疑"},{id:52,name:"陆汉权老师答疑"},{id:83,name:"魏宝刚老师答疑"},{id:140,name:"古红英老师答疑"},{id:149,name:"李岩老师答疑"},{id:151,name:"孙建伶老师答疑"},{id:183,name:"陆魁军老师答疑"},{id:204,name:"冯雁老师答疑"},{id:205,name:"张引老师的答疑版"},{id:207,name:"郑扣根老师答疑"},{id:208,name:"翁恺老师答疑"},{id:224,name:"钱抱清老师答疑"},{id:292,name:"高晴老师答疑"},{id:311,name:"杨义群老师答疑"},{id:323,name:"白洪欢老师答疑"},{id:325,name:"贾厚玉老师答疑"},{id:375,name:"张重辉老师答疑"},{id:383,name:"张彤彧老师答疑"},{id:408,name:"陈建海老师答疑"},{id:412,name:"精品课程C语言答疑中心"},{id:423,name:"方宁老师答疑版"},{id:427,name:"季江民老师答疑版块"},{id:432,name:"陈平老师答疑"},{id:440,name:"丁展平老师答疑"},{id:442,name:"谈艺论戏"},{id:446,name:"桥牌天地"},{id:448,name:"张军老师答疑"},{id:451,name:"胡兰青老师答疑"},{id:452,name:"胡兰青老师答疑"},{id:454,name:"董亚波老师答疑"},{id:457,name:"史治国老师答疑"},{id:494,name:"方富民老师答疑"},{id:501,name:"朱晔老师答疑"},{id:513,name:"邢卫老师答疑"},{id:514,name:"周波老师答疑"},{id:535,name:"面向对象程序设计答疑中心"},{id:540,name:"陆维敏老师答疑"},{id:546,name:"苏振华老师答疑"},{id:548,name:"姜晓红老师答疑"},{id:559,name:"吴江琴老师答疑"},{id:568,name:"杨万喜老师答疑"},{id:574,name:"胡敏老师答疑"},{id:575,name:"顾宗华老师答疑版"},{id:578,name:"蒋文华老师答疑"},{id:579,name:"陈华钧老师答疑"},{id:588,name:"吕萍老师答疑"},{id:589,name:"黄正谦老师答疑"},{id:590,name:"王强老师答疑"},{id:595,name:"陈志坚老师答疑"},{id:599,name:"彭笑刚老师答疑"},{id:600,name:"楼辉老师答疑"},{id:601,name:"沈钦仙老师答疑"},{id:602,name:"孙凌云老师答疑"},{id:603,name:"孟涛老师答疑"},{id:615,name:"孟炳泉老师答疑"},{id:624,name:"计算机通识答疑"},{id:626,name:"杨颖老师答疑"},{id:629,name:"陈实老师答疑"},{id:631,name:"管理学课程交流"},{id:632,name:"陈纯老师答疑"},{id:633,name:"近现代中国的人物研究答疑版"},{id:634,name:"董平老师答疑"},{id:635,name:"戴俊飞老师答疑版"},{id:640,name:"刘海风老师答疑"},{id:710,name:"沈语冰老师答疑"},{id:714,name:"王跃明老师答疑"},{id:723,name:"李浩然老师答疑"},{id:724,name:"胡吉明老师答疑"},{id:726,name:"董玮老师答疑"},{id:727,name:"王毅老师答疑"},{id:728,name:"陈文智老师答疑"},{id:733,name:"陈奇老师答疑版"},{id:745,name:"刘新国老师答疑"},{id:751,name:"李啸风物理化学答疑"},{id:752,name:"雷勇老师答疑"},{id:761,name:"高在峰老师课程交流"},{id:57,name:"数学之韵"},{id:58,name:"信电ISEE"},{id:67,name:"管理学院"},{id:145,name:"传媒与国际文化学院"},{id:158,name:"E电园"},{id:193,name:"生仪大家庭"},{id:214,name:"不败光电"},{id:217,name:"材化演绎"},{id:241,name:"医学院"},{id:246,name:"外语学院"},{id:247,name:"动力机能"},{id:248,name:"计算机科学与技术学院"},{id:255,name:"物理系版"},{id:284,name:"建工学院"},{id:285,name:"碧水青禾"},{id:294,name:"竺可桢学院"},{id:307,name:"人文学院"},{id:319,name:"光华法学院"},{id:320,name:"生命科学学院"},{id:321,name:"生工食品学院"},{id:341,name:"药学院"},{id:344,name:"环资经纬"},{id:351,name:"天下为公"},{id:352,name:"经济学院"},{id:362,name:"教育杏坛"},{id:371,name:"控制天下"},{id:374,name:"理学院"},{id:377,name:"动科天地CAS"},{id:469,name:"航空航天学院"},{id:583,name:"蓝田学园"},{id:584,name:"云峰学园"},{id:585,name:"丹青学园"},{id:623,name:"海洋学院"},{id:754,name:"我是工程师"},{id:60,name:"MSTC"},{id:129,name:"杭高毕业生专版"},{id:165,name:"绿之源协会"},{id:176,name:"Fantasy动漫社"},{id:187,name:"科技探索者协会"},{id:190,name:"学军中学"},{id:194,name:"梵音剧社"},{id:195,name:"法学研究会"},{id:206,name:"DFM街舞社"},{id:213,name:"墨语茗音"},{id:216,name:"梦想天堂"},{id:222,name:"慈中家园"},{id:254,name:"学生旅游协会 "},{id:264,name:"浙大广电"},{id:287,name:"SCDA"},{id:303,name:"国防协会"},{id:310,name:"心理学会"},{id:330,name:"学生社团联合会"},{id:334,name:"红十字会学生分会"},{id:347,name:"学生三农协会"},{id:355,name:"辩论队与求是辩论社"},{id:361,name:"学生无极棋社"},{id:369,name:"学生空手道协会 "},{id:393,name:"爱心社"},{id:431,name:"学生校友联络协会"},{id:434,name:"亦心·民韵舞社"},{id:436,name:"杨式太极拳协会"},{id:437,name:"社团百花园"},{id:519,name:"机器人协会"},{id:520,name:"心系西部协会"},{id:576,name:"黑白剧社"},{id:587,name:"HPA保健协会"},{id:618,name:"成长互助训练营GCC"},{id:628,name:"E志者协会"},{id:713,name:"未企俱乐部"},{id:736,name:"研创CIE"},{id:262,name:"天下一家"},{id:461,name:"在浙之滨"},{id:467,name:"三湘四水"},{id:468,name:"津门故里"},{id:471,name:"齐鲁青未了"},{id:472,name:"蓉汇贯川"},{id:475,name:"三秦大地"},{id:480,name:"八闽来风"},{id:481,name:"江南西道"},{id:482,name:"一皖情深"},{id:483,name:"燕赵飞歌"},{id:484,name:"吴韵汉风"},{id:485,name:"辽地永宁"},{id:486,name:"新上海滩"},{id:489,name:"黑土风情"},{id:491,name:"白山松水"},{id:492,name:"巴渝人家"},{id:493,name:"天山南北"},{id:498,name:"晋善晋美"},{id:502,name:"塞上风光"},{id:503,name:"彩云之南"},{id:504,name:"荆楚纵横"},{id:505,name:"邦锦梅朵"},{id:506,name:"粤来客栈"},{id:507,name:"鼎豫中原"},{id:511,name:"丝路花雨"},{id:550,name:"皇城根儿"},{id:596,name:"八桂飘香"},{id:625,name:"黔山秀水"},{id:642,name:"椰风海韵"},{id:245,name:"技术组工作室"},{id:249,name:"编辑部工作室"},{id:286,name:"坛庆策划"},{id:605,name:"策划部工作室"},{id:606,name:"体育部工作室"},{id:607,name:"部长联席会议"},{id:610,name:"意见与建议"},{id:611,name:"通知通告"},{id:613,name:"招贤纳士"},{id:620,name:"赞助合作"},{id:747,name:"Banner申请"},{id:753,name:"CC98协会"},{id:17,name:"论坛事务"},{id:38,name:"站规修订"},{id:40,name:"站务讨论"},{id:136,name:"98博物馆"},{id:184,name:"论坛帮助"},{id:221,name:"版主会议厅"},{id:326,name:"集思广益"},{id:404,name:"98足迹"},{id:433,name:"网络安全"},{id:614,name:"莫失莫忘"}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(t){var n=e.call(this,t)||this;return n.state={now:new Date},n.tick=n.tick.bind(n),n}return r.__extends(t,e),t.prototype.tick=function(){this.setState({now:new Date})},t.prototype.componentDidMount=function(){this.timer=setInterval(this.tick,1e3)},t.prototype.componentWillUnmount=function(){clearInterval(this.timer)},t.prototype.render=function(){var e=function(e,t){var n=t-e;if(n<0)return null;var r=Math.floor(n/864e5),a=Math.floor(n%864e5/36e5),s=Math.floor(n%36e5/6e4),o=Math.floor(n%6e4/1e3);return{days:r,hours:a,minutes:s,seconds:o}}(this.state.now,this.props.endDate);if(e){var t={display:"inline-flex",justifyContent:"flex-end",alignItems:"flex-end",width:"4rem"},n={color:"rgb(255, 20, 147)",fontSize:"1.5rem",fontFamily:"Monaco",display:"inline-flex",justifyContent:"center",width:"100%"};return a.createElement("p",{style:{margin:0}},"距离",a.createElement("span",{style:r.__assign({},n,{marginLeft:".5rem",marginRight:".5rem",width:"auto"})},"半夏音乐节"),"还有",e.days>0?a.createElement("span",{style:t},a.createElement("span",{style:n},e.days),"天"):null,e.hours<0?null:a.createElement("span",{style:t},a.createElement("span",{style:n},e.hours),"时"),e.minutes<0?null:a.createElement("span",{style:t},a.createElement("span",{style:n},e.minutes),"分"),e.seconds<0?null:a.createElement("span",{style:t},a.createElement("span",{style:n},e.seconds),"秒"))}return clearInterval(this.timer),null},t}(a.PureComponent);t.CountDown=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(6),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.text,n=e.url,r=e.active;return a.createElement("li",{className:"page-item"},a.createElement(s.Link,{className:"page-link"+(r?" active":""),to:n},t))},t}(a.Component);t.PageModel=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._pattern=/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]\.(com|org|cn|net|cc|xyz|top|club|shop|xin|wang|vip|ink|link|tv|work|me|info|mobi|online|site|tech|ren|pro|ltd|fun|kim|red|group|store|biz|name|wiki|game|help|co|so|hk|tel|asia|lol|studio|design|live|lawyer|software|band|press|space|website|date|trade|party|win|video|news|pw|photo|pub|click|loan|bid|moe)/i,t}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedContent",{get:function(){return this._pattern},enumerable:!0,configurable:!0}),t.prototype.exec=function(e,t){var n=e[0];return t.options.autoDetectUrl?a.createElement("a",{href:"http://"+n,target:"_blank",className:"urlStyle"},n):n},t}(n(7).UbbTextHandler);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._pattern=/(https?|ftp|file):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/i,t}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedContent",{get:function(){return this._pattern},enumerable:!0,configurable:!0}),t.prototype.exec=function(e,t){var n=e[0];return t.options.autoDetectUrl?a.createElement("a",{href:n,target:"_blank",className:"urlStyle"},n):n},t}(n(7).UbbTextHandler);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(7),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return/tb\d{2}/i},enumerable:!0,configurable:!0}),t.prototype.getTagMode=function(e){return s.UbbTagMode.Empty},t.prototype.execCore=function(e,t,n){var r="/static/images/tb/tb"+t.tagName.match(/\d{2}/).toString()+".png";return a.createElement("div",{style:{display:"inline"}},a.createElement("img",{src:r,alt:""}),e)},t}(s.RecursiveTagHandler);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(7),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return/[acf]:/i},enumerable:!0,configurable:!0}),t.prototype.getTagMode=function(e){return s.UbbTagMode.Empty},t.prototype.getAnimalUrl=function(e){return"/static/images/mahjong/animal2017/"+e+".png"},t.prototype.getCartoonUrl=function(e){switch(e){case"018":case"049":case"096":return"/static/images/mahjong/carton2017/"+e+".gif";default:return"/static/images/mahjong/carton2017/"+e+".png"}},t.prototype.getFaceUrl=function(e){switch(e){case"004":case"009":case"056":case"061":case"062":case"087":case"115":case"120":case"137":case"168":case"169":case"175":case"206":return"/static/images/mahjong/face2017/"+e+".gif";default:return"/static/images/mahjong/face2017/"+e+".png"}},t.prototype.execCore=function(e,t,n){var r=t.tagName,s=r.match(/[acf]/g)[0],o=r.replace(s+":",""),i="";switch(s){case"a":i=this.getAnimalUrl(o);break;case"c":i=this.getCartoonUrl(o);break;case"f":i=this.getFaceUrl(o)}return a.createElement("div",{style:{display:"inline"}},a.createElement("img",{src:i,alt:""}),e)},t}(s.RecursiveTagHandler);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(7),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return/ac\d{2}/i},enumerable:!0,configurable:!0}),t.prototype.getTagMode=function(e){return s.UbbTagMode.Empty},t.prototype.execCore=function(e,t,n){var r="/static/images/ac/"+t.tagName.replace(/ac/g,"")+".png";return n.options.allowEmotion?a.createElement("div",{style:{display:"inline"}},a.createElement("img",{src:r,alt:""}),e):a.createElement("div",{style:{display:"inline"}},e)},t}(s.RecursiveTagHandler);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(7),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return/em\d{2}/i},enumerable:!0,configurable:!0}),t.prototype.getTagMode=function(e){return s.UbbTagMode.Empty},t.prototype.execCore=function(e,t,n){var r="/static/images/em/em"+t.tagName.match(/\d{2}/).toString()+".gif";return n.options.allowEmotion?a.createElement("div",{style:{display:"inline"}},a.createElement("img",{src:r,alt:""}),e):a.createElement("div",{style:{display:"inline"}},e)},t}(s.RecursiveTagHandler);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(7),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"line"},enumerable:!0,configurable:!0}),t.prototype.getTagMode=function(e){return s.UbbTagMode.Empty},t.prototype.execCore=function(e,t,n){return a.createElement("hr",null)},t}(s.RecursiveTagHandler);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"sandbox"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"supportSandBox",{get:function(){return"sandbox"in document.createElement("iframe")},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,n,r){if(!t.supportSandBox)return e;var s=n.value("url"),o=n.value("width"),i=n.value("height");return a.createElement("iframe",{sandbox:"allow-scripts allow-forms allow-same-origin",src:s,style:{border:"none",width:o,height:i}},e)},t}(n(7).RecursiveTagHandler);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"bili"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){if(!1===n.options.allowMediaContent)return e;var s=parseInt(t.value("bili"))||1;return a.createElement("div",null,a.createElement("iframe",r.__assign({},{border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true"},{src:"https://player.bilibili.com/player.html?aid="+e+"&page="+s,allowfullscreen:"allowfullscreen",style:{border:"none"},width:"640",height:"480",scrolling:"no"})))},t}(n(7).TextTagHandler);t.BiliTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(7),o=n(6),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"pm"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var r="/message/message?name="+t.value(0);return a.createElement(o.Link,{to:r},e)},t}(s.RecursiveTagHandler);t.PmTagHandler=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"md"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var r=e;return a.createElement(o,{content:r})},t}(n(7).TextTagHandler);t.MdTagHandler=s;var o=function(e){function t(t,n){var r=e.call(this,t,n)||this,a=Math.floor(1e6*Math.random());return r.state={divid:"Markdown"+a},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){editormd.markdownToHTML(this.state.divid,{htmlDecode:"style,script,iframe",emoji:!0,taskList:!0,tex:!0,flowChart:!0,sequenceDiagram:!0,codeFold:!0})},t.prototype.render=function(){return a.createElement("div",{id:this.state.divid,style:{maxWidth:"80%"}},a.createElement("textarea",{name:"editormd-markdown-doc",style:{display:"none"}},this.props.content))},t}(a.Component);t.MarkdownParser=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(7),o=n(6),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"topic"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var r,s=e;t.value(0);1===t.parameterCount&&(r=parseInt(t.value(0))),2===t.parameterCount&&(r=parseInt(t.value(1)));var i="/topic/"+r;return a.createElement(o.Link,{to:i},s)},t}(s.RecursiveTagHandler);t.TopicTagHandler=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"tr"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return a.createElement("tr",null,e)},t}(n(7).RecursiveTagHandler);t.TrTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"th"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var r=1,s=1;return 2===t.parameterCount&&(r=parseInt(t.value(0)),s=parseInt(t.value(1))),a.createElement("th",{rowSpan:r,colSpan:s},e)},t}(n(7).RecursiveTagHandler);t.ThTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"td"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var r=1,s=1;return 2===t.parameterCount&&(r=parseInt(t.value(0)),s=parseInt(t.value(1))),a.createElement("td",{rowSpan:r,colSpan:s},e)},t}(n(7).RecursiveTagHandler);t.TdTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"table"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return a.createElement("table",{className:"UBBTableTag"},e)},t}(n(7).RecursiveTagHandler);t.TableTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"right"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return a.createElement("span",{style:{textAlign:"right"}},a.createElement("div",null,e))},t}(n(7).RecursiveTagHandler);t.RightTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"center"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return a.createElement("span",{style:{textAlign:"center"}},a.createElement("div",null,e))},t}(n(7).RecursiveTagHandler);t.CenterTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"left"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return a.createElement("span",{style:{textAlign:"left"}},a.createElement("div",null,e))},t}(n(7).RecursiveTagHandler);t.LeftTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(7),o=n(156),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"upload"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var r,i=e,c=t.value(0);switch(1===t.parameterCount&&(r=0),2===t.parameterCount&&(r=parseInt(t.value(1))),c){case"jpg":case"jpeg":case"png":case"gif":case"bmp":case"webp":return n.options.allowImage?n.options.compatibility===s.UbbCompatiblityMode.EnforceMorden?1===r?a.createElement(o.Image,{imageUri:i,title:"upload图片",isShowed:!1}):a.createElement("figure",null,a.createElement(o.Image,{imageUri:i,title:"upload图片",isShowed:!0}),a.createElement("figcaption",null,"upload图片")):1===r?a.createElement(o.Image,{imageUri:i,title:"upload图片",isShowed:!1}):a.createElement(o.Image,{imageUri:i,title:"upload图片",isShowed:!0}):a.createElement(o.Image,{imageUri:i,title:"upload图片",isShowed:!1});default:return a.createElement("a",{className:"hiddenImage",href:i},"点击下载文件")}},t}(s.TextTagHandler);t.UploadTagHandler=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"align"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var r={textAlign:t.value("align")};return a.createElement("span",{style:r},a.createElement("div",null,e))},t}(n(7).RecursiveTagHandler);t.AlignTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"font"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var r={fontFamily:t.value("font")};return a.createElement("span",{style:r},e)},t}(n(7).RecursiveTagHandler);t.FontTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"code"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){for(var r=e.split("\n");!r[0]&&r.length>0;)r.shift();for(;!r[r.length-1]&&r.length>0;)r.pop();var s=r.map(function(e,t){return a.createElement("li",null,e)});return a.createElement("div",{className:"ubb-code"},a.createElement("ol",null,s))},t}(n(7).TextTagHandler);t.CodeTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"user"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var r=e;return a.createElement("a",{href:"/user/name"+encodeURI(r),style:{cursor:"pointer"}},r)},t}(n(7).TextTagHandler);t.UserTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"english"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return a.createElement("span",{style:{fontFamily:"Arial"}},e)},t}(n(7).RecursiveTagHandler);t.EnglishTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"cursor"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var r={cursor:t.value("cursor")};return a.createElement("span",{style:r},e)},t}(n(7).RecursiveTagHandler);t.CursorTagHandler=s},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(7),o=n(318),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"video"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return!1===n.options.allowMediaContent?e:a.createElement(c,{src:e})},t}(s.TextTagHandler);t.VideoTagHandler=i;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={height:"28.8984375rem"},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.dp=new o({element:this.div,autoplay:!1,preload:"metadata",video:{url:encodeURI(this.props.src)}}),this.dp.on("abort",function(e){return null}),this.dp.on("fullscreen",function(t){return e.setState({height:"auto"})}),this.dp.on("fullscreen_cancel",function(t){return e.setState({height:"28.8984375rem"})}),this.div.getElementsByClassName("dplayer-menu")[0].innerHTML='<div class="dplayer-menu-item"><a target="_blank" href="https://github.com/MoePlayer/DPlayer">关于 DPlayer 播放器</a></div>'},t.prototype.componentWillUnmount=function(){this.dp.destroy(),this.div.innerHTML=""},t.prototype.render=function(){var e=this;return a.createElement("div",{style:{display:"flex"}},a.createElement("div",{className:"aplayer",style:{whiteSpace:"normal",height:this.state.height},ref:function(t){return e.div=t}}))},t}(a.Component)},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(7),o=n(321),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return["mp3","audio"]},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return!1===n.options.allowMediaContent?e:a.createElement(c,{src:e})},t}(s.TextTagHandler);t.AudioTagHandler=i;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.ap=new o({element:this.div,autoplay:!1,preload:"metadata",music:{url:encodeURI(this.props.src),title:encodeURI(this.props.src),author:"",pic:"/static/images/audio_cover.png"}}),this.div.getElementsByClassName("aplayer-author")[0].innerHTML=""},t.prototype.componentWillUnmount=function(){this.ap.destroy()},t.prototype.render=function(){var e=this;return a.createElement("div",{className:"aplayer",style:{whiteSpace:"normal",width:"30rem"},ref:function(t){return e.div=t}})},t}(a.Component)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"del"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return a.createElement("span",{style:{textDecoration:"line-through"}},e)},t}(n(7).RecursiveTagHandler);t.DelTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(7),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"u"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return n.options.compatibility===s.UbbCompatiblityMode.EnforceMorden?a.createElement("span",{style:{textDecoration:"underline"}},e):a.createElement("u",null,e)},t}(s.RecursiveTagHandler);t.UTagHandler=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"url"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var r=t.value("url");return r||(r=e),!1===n.options.allowExternalUrl&&0===r.indexOf("http")&&r.split("/").length>1&&"www.cc98.org"!==r.split("/")[2]?e:a.createElement("a",{href:r,target:"_blank",className:"urlStyle"},e)},t}(n(7).RecursiveTagHandler);t.UrlTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"color"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var r={color:t.value("color")};return a.createElement("span",{style:r},e)},t}(n(7).RecursiveTagHandler);t.ColorTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(7),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return["quote","quotex"]},enumerable:!0,configurable:!0}),t.prototype.exec=function(t,n){var r=this;if(n.data.isInQuote)return e.prototype.exec.call(this,t,n);n.data.isInQuote=!0;var o,c,l=function(e){if(e.type===s.UbbSegmentType.Tag){var t=e.tagData.tagName;return-1!==r.supportedTagNames.indexOf(t)}return!1},u=[t],d=t;do{o=!1;for(var p=d.subSegments,m=0,h=p;m<h.length;m++){var f=h[m];if(l(f))d=p.splice(p.indexOf(f),1)[0],u.push(d),o=!0}}while(o);if(u.length>1){u.reverse(),u[0].subSegments.splice(1,0,new s.UbbTextSegment("\n",u[0]));for(var g=1;g<u.length;g++)if((c=u[g].subSegments)[0].type===s.UbbSegmentType.Tag&&c[0].subSegments[0]&&c[0].subSegments[0].type===s.UbbSegmentType.Text&&0===c[0].subSegments[0].text.indexOf("以下是引用")&&c.slice(1,c.length).every(function(e){return e.type===s.UbbSegmentType.Text&&!e.text.match(/\S/)})){var v=u[g].subSegments.shift().clone(u[g-1]);u[g-1].subSegments.unshift(v),u[g-1].subSegments.splice(1,0,new s.UbbTextSegment("\n",u[g-1])),u.splice(g,1),g--}}var y=u.map(function(e,t){return t===u.length-1?n.data.islastQuote=!0:n.data.islastQuote=!1,n.engine.execSegment(e,n)});return n.data.isInQuote=!1,a.createElement(i,{quoteItems:y})},t.prototype.execCore=function(e,t,n){var r={boxSizing:"border-box",width:"100%",padding:"10px 0 10px 0",borderBottom:"1px solid rgb(204,204,204)",overflowY:"hidden"};return n.data.islastQuote&&(r.borderBottom=null),a.createElement("div",{style:r},e)},t}(s.RecursiveTagHandler);t.QuoteTagHandler=o;var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isShowed:t.props.quoteItems.length<=2},t}return r.__extends(t,e),t.prototype.showButtonClick=function(){this.setState({isShowed:!0})},t.prototype.render=function(){var e=a.createElement("div",{style:{display:"flex",justifyContent:"center",padding:"14px 0",borderBottom:"1px solid rgb(204,204,204)"}},a.createElement("button",{style:{width:"auto",marginTop:0,alignSelf:"center"},className:"hiddenImage",type:"button",onClick:this.showButtonClick.bind(this)},"展开剩余引用")),t=this.state.isShowed,n=this.props.quoteItems,r=t?n:n.slice(n.length-2);return a.createElement("div",{style:{backgroundColor:"#F5FAFF",border:"1px solid rgb(204,204,204)",padding:"0 17px 0 17px",maxHeight:"800px",overflowY:"auto"}},!t&&e,r)},t}(a.PureComponent)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"size"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var r=parseInt(t.value("size"));if(isNaN(r)||r<=0)return e;r=r>7?3.5:r/2;var s={fontSize:(r/=1.5)+"rem"};return a.createElement("span",{style:s},e)},t}(n(7).RecursiveTagHandler);t.SizeTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"i"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return a.createElement("i",null,e)},t}(n(7).RecursiveTagHandler);t.ITagHandler=s},,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"b"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return a.createElement("span",{style:{fontWeight:"bold"}},e)},t}(n(7).RecursiveTagHandler);t.BTagHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),s=n(7),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"noubb"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return n.options.compatibility!==s.UbbCompatiblityMode.Transitional?a.createElement("code",null,e):a.createElement("span",null,e)},t}(s.TextTagHandler);t.NoUbbTagHandler=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(73),s=n(4),o=n(107),i=function(){return function(){this.isLogOn=s.isLogOn(),this.isLoading=!1,this.currentUserInfo=s.getLocalStorage("userInfo")||new o.UserInfo,this.currentVisitingUserPage="exact",this.currentVisitingUserId=0,this.currentVisitingUserIsExisted=!0,this.recentPosts=[],this.isError=!1,this.errorMessage="",this.currentUserFavoriteBoards=[],this.hasTotal=new c,this.totalPage=new l,this.currentUserFansInfo=[],this.currentUserFollowingInfo=[],this.currentUserFavoritePosts=[],this.currentUserCenterPage="profile",this.transferSuccessUsers=[],this.totalPage.myfollowings=Math.ceil(this.currentUserInfo.followCount/10),this.totalPage.myfans=Math.ceil(this.currentUserInfo.fanCount/10)}}();t.UserInfoStore=i;var c=function(){return function(){this.profile=!1,this.myposts=!1,this.myfavoriteposts=!1,this.myfollowings=!0,this.myfans=!0}}(),l=function(){return function(){this.profile=1,this.myposts=1,this.myfavoriteposts=1}}();t.default=function(e,t){switch(void 0===e&&(e=new i),t.type){case a.USER_LOG_ON:return r.__assign({},e,{isLogOn:!0},new i);case a.USER_LOG_OFF:return r.__assign({},e,{isLogOn:!1});case a.CHANGE_USERINFO:return s.setLocalStorage("userInfo",t.payload.newInfo,2592e3),s.setLocalStorage("userId_"+t.payload.newInfo.id,t.payload.newInfo,3600),s.setLocalStorage("userName_"+t.payload.newInfo.name,t.payload.newInfo.id),r.__assign({},e,{currentUserInfo:t.payload.newInfo});case a.CHANGE_VISITING_USER:return r.__assign({},e,{currentVisitingUserPage:t.payload.page,currentVisitingUserId:t.payload.id});case a.USER_NOT_FOUND:return r.__assign({},e,{currentVisitingUserIsExisted:!1});case a.USER_CENTER_LOADING:return r.__assign({},e,{isLoading:!0,isError:!1});case a.USER_CENTER_LOADED:return r.__assign({},e,{isLoading:!1});case a.USER_CENTER_FETCH_ERROR:return r.__assign({},e,{isError:!0,errorMessage:t.payload.message});case a.CHANGE_USER_FAVORITE_BOARDS:return r.__assign({},e,{currentUserFavoriteBoards:t.payload.boardsInfo});case a.CHANGE_USER_RECENT_POSTS:return r.__assign({},e,{recentPosts:t.payload.posts});case a.USER_CENTER_PAGE_LOAD_FINISH:switch(e.currentUserCenterPage){case"profile":case"myposts":return r.__assign({},e,{hasTotal:r.__assign({},e.hasTotal,{profile:!0,myposts:!0}),totalPage:r.__assign({},e.totalPage,{profile:t.payload.totalPage,myposts:t.payload.totalPage})});default:return r.__assign({},e,{hasTotal:r.__assign({},e.hasTotal,(c={},c[e.currentUserCenterPage]=!0,c)),totalPage:r.__assign({},e.totalPage,(l={},l[e.currentUserCenterPage]=t.payload.totalPage,l))})}case a.USER_CENTER_PAGE_LOAD_UNFINISH:switch(e.currentUserCenterPage){case"profile":case"myposts":return r.__assign({},e,{hasTotal:r.__assign({},e.hasTotal,{profile:!1,myposts:!1})});default:return r.__assign({},e,{hasTotal:r.__assign({},e.hasTotal,(u={},u[e.currentUserCenterPage]=!1,u))})}case a.CHANGE_USER_FANS_INFO:return r.__assign({},e,{currentUserFansInfo:t.payload.fansInfo});case a.CHANGE_USER_FOLLOWINGS_INFO:return r.__assign({},e,{currentUserFollowingInfo:t.payload.followingsInfo});case a.CHANGE_USER_FAVORITE_POSTS:return r.__assign({},e,{currentUserFavoritePosts:t.payload.posts});case a.CHNAGE_USER_CENTER_PAGE:return r.__assign({},e,{currentUserCenterPage:t.payload.page});case a.USER_CENTER_FOLLOW_USER:var n=e.currentUserFollowingInfo.map(function(e){return e.id===t.payload.userId?r.__assign({},e,{isFollowing:!0}):e}),o=e.currentUserFansInfo.map(function(e){return e.id===t.payload.userId?r.__assign({},e,{isFollowing:!0}):e});return r.__assign({},e,{currentUserFollowingInfo:n,currentUserFansInfo:o});case a.USER_CENTER_UNFOLLOW_USER:n=e.currentUserFollowingInfo.map(function(e){return e.id===t.payload.userId?r.__assign({},e,{isFollowing:!1}):e}),o=e.currentUserFansInfo.map(function(e){return e.id===t.payload.userId?r.__assign({},e,{isFollowing:!1}):e});return r.__assign({},e,{currentUserFollowingInfo:n,currentUserFansInfo:o});case a.USER_CENTER_SOLVE_ERROR:return r.__assign({},e,{errorMessage:"",isError:!1});case a.USER_CENTER_TRANSFER_WEALTH_SUCCESS:return r.__assign({},e,{transferSuccessUsers:t.payload.userNames});default:return e}var c,l,u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(73),s=function(){return function(){}}();t.TopicState=s;t.default=function(e,t){return void 0===e&&(e=new s),r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(n){switch(t.type){case a.ADD_AWARD:return[2,{post:e.post,postTopic:e.postTopic,user:e.user,award:{updateTime:Date.now()}}];default:return[2,e]}return[2]})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(73),s=function(){return function(){this.isError=!1,this.errorMessage=""}}();t.ErrorStore=s,t.default=function(e,t){switch(void 0===e&&(e=new s),t.type){case a.THROW_ERROR:return r.__assign({},e,{isError:!0,errorMessage:t.payload.message});case a.SOLVE_ERROR:return r.__assign({},e,{isError:!1});default:return e}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);n(558),n(555);var a=n(0),s=n(160),o=n(74),i=n(15);n(288),n(287);var c=n(70),l=n(286),u=n(153);!function(){r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,c.Constants.loadConfig()];case 1:return e.sent(),window.indexedDB?[4,u.IndexedDB.start()]:[3,3];case 2:e.sent(),e.label=3;case 3:return console.info("%c       ","font-size: 100px; background: url(http://cdn.nyanit.com/nyan2.gif) no-repeat;"),console.info("%cCC98 Durian","font-size: 80px; fontFamily: Big"),s.render(a.createElement(i.Provider,{store:o.default},a.createElement(l.default,null)),document.getElementById("root")),[2]}})})}()}]);
